{
  "header" : {
    "dataModelVersion" : "3"
  },
  "content" : {
    "flowSnapshot" : {
      "externalControllerServices" : { },
      "flowContents" : {
        "comments" : "(C) Copyright IBM Corp. 2020, 2020\nSPDX-License-Identifier: Apache-2.0",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "id" : "3f4a9f47-38bb-306f-a1c9-191380b381cb",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "bab0e448-1daf-3391-87d6-3c5b6df09b4d",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "comments" : "",
            "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "id" : "c9cb8abf-b552-3031-9e88-8956e555541e",
            "name" : "Enriched FHIR resource",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "df2bf961-ba94-3117-880f-b681af37a74d",
            "name" : "Aborted",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "d3a242e4-e8c8-3f4c-89b9-17e2cf59e0c1",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Abort" ],
          "source" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "id" : "8d3b2d53-ef57-34ff-bacf-011c864cb6b6",
            "name" : "Input Data",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "d487faa6-2f78-37b9-8698-192cdca889f3",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "56dd183e-d24d-317a-9075-37d69bb21be4",
            "name" : "Consume From Kafka Topic",
            "type" : "PROCESSOR"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "b921d722-5941-31a9-8a23-427a5fbf9090",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "id" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
            "name" : "Invalid FHIR Data",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "id" : "fef3ad4b-53db-3879-b4e8-c32a75c336c3",
            "name" : "FHIR resource",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "c02a4656-eb6e-321e-9d94-6cfe0b5f84bd",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "id" : "c653b104-41af-36c2-a583-56bdacb80c47",
            "name" : "Valid FHIR Data",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "71a28556-726a-31dd-8f70-c6ec4a225938",
            "name" : "Warning",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "852ca42c-1355-39ac-8944-106ff9321ba2",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Warning" ],
          "source" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "31696a75-2651-3b81-86e7-cd47ee9c2669",
            "name" : "Success",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "c54e1917-0f48-356b-8eb5-119162361038",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Success" ],
          "source" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "bb8daef2-d471-3654-a856-5543fb8d128c",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "comments" : "",
            "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "id" : "f6eaf83b-0427-33d7-b7a7-517e5135e93f",
            "name" : "Output",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ {
            "x" : 3240.0,
            "y" : 3688.0
          } ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "9a027b18-e55d-31b8-84f0-030a53710c1f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "53903135-9fb2-35d0-ba95-1bad50195e04",
            "id" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ {
            "x" : 3240.0,
            "y" : 2320.0
          } ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "8d1da334-6964-3fe5-9e63-1344f2e1fdbd",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "id" : "7caf4375-541a-36a3-94de-de5b965b4141",
            "name" : "Failure",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "id" : "8e799afc-f30f-37c2-8d60-b2a3b347e410",
            "name" : "FHIR Resource",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "f7362393-7222-3599-b2e0-264d5db92aa1",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "id" : "bcca42dd-fc38-3451-8149-36f63778fa40",
            "name" : "Clean FHIR Resource",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "id" : "cee78597-5464-390c-9871-d205fc6d342f",
            "name" : "FHIR Resource",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "74e94678-0b44-39a1-8d73-4b9f7b1c7c81",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "id" : "e9e15aa5-51ac-3fd8-9150-b40e7b7e944f",
            "name" : "FHIR Data",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "7b0f4ce4-26ad-3c4c-b999-cf47ae424523",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "id" : "59f220e8-5232-3976-b5df-2816ea6da8a2",
            "name" : "Failure",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "2313b44f-03b6-3094-9a06-98c43b644e2b",
          "labelIndex" : 1,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "id" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
            "name" : "Failure",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 0
        } ],
        "controllerServices" : [ {
          "bundle" : {
            "artifact" : "nifi-distributed-cache-services-nar",
            "group" : "org.apache.nifi",
            "version" : "1.12.1"
          },
          "comments" : "",
          "componentType" : "CONTROLLER_SERVICE",
          "controllerServiceApis" : [ {
            "bundle" : {
              "artifact" : "nifi-standard-services-api-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "type" : "org.apache.nifi.distributed.cache.client.DistributedMapCacheClient"
          }, {
            "bundle" : {
              "artifact" : "nifi-standard-services-api-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "type" : "org.apache.nifi.distributed.cache.client.AtomicDistributedMapCacheClient"
          } ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "d4dd9b8b-0820-3e54-a43a-17feacad5331",
          "name" : "ASCVD DistributedMapCacheClientService",
          "properties" : {
            "Server Port" : "4557",
            "Server Hostname" : "localhost",
            "Communications Timeout" : "30 secs"
          },
          "propertyDescriptors" : {
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Server Port" : {
              "displayName" : "Server Port",
              "identifiesControllerService" : false,
              "name" : "Server Port",
              "sensitive" : false
            },
            "Server Hostname" : {
              "displayName" : "Server Hostname",
              "identifiesControllerService" : false,
              "name" : "Server Hostname",
              "sensitive" : false
            },
            "Communications Timeout" : {
              "displayName" : "Communications Timeout",
              "identifiesControllerService" : false,
              "name" : "Communications Timeout",
              "sensitive" : false
            }
          },
          "type" : "org.apache.nifi.distributed.cache.client.DistributedMapCacheClientService"
        }, {
          "bundle" : {
            "artifact" : "nifi-distributed-cache-services-nar",
            "group" : "org.apache.nifi",
            "version" : "1.12.1"
          },
          "comments" : "",
          "componentType" : "CONTROLLER_SERVICE",
          "controllerServiceApis" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "ce834908-67be-35cb-bec3-adf30c523e54",
          "name" : "Clinical Ingestion DistributedMapCacheServer",
          "properties" : {
            "Eviction Strategy" : "Least Frequently Used",
            "Port" : "4557",
            "Maximum Cache Entries" : "10000"
          },
          "propertyDescriptors" : {
            "Eviction Strategy" : {
              "displayName" : "Eviction Strategy",
              "identifiesControllerService" : false,
              "name" : "Eviction Strategy",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Persistence Directory" : {
              "displayName" : "Persistence Directory",
              "identifiesControllerService" : false,
              "name" : "Persistence Directory",
              "sensitive" : false
            },
            "Port" : {
              "displayName" : "Port",
              "identifiesControllerService" : false,
              "name" : "Port",
              "sensitive" : false
            },
            "Maximum Cache Entries" : {
              "displayName" : "Maximum Cache Entries",
              "identifiesControllerService" : false,
              "name" : "Maximum Cache Entries",
              "sensitive" : false
            }
          },
          "type" : "org.apache.nifi.distributed.cache.server.map.DistributedMapCacheServer"
        }, {
          "bundle" : {
            "artifact" : "nifi-distributed-cache-services-nar",
            "group" : "org.apache.nifi",
            "version" : "1.12.1"
          },
          "comments" : "",
          "componentType" : "CONTROLLER_SERVICE",
          "controllerServiceApis" : [ {
            "bundle" : {
              "artifact" : "nifi-standard-services-api-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "type" : "org.apache.nifi.distributed.cache.client.DistributedMapCacheClient"
          }, {
            "bundle" : {
              "artifact" : "nifi-standard-services-api-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "type" : "org.apache.nifi.distributed.cache.client.AtomicDistributedMapCacheClient"
          } ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
          "name" : "Send To FHIR DistributedMapCacheClientService",
          "properties" : {
            "Server Port" : "4557",
            "Server Hostname" : "localhost",
            "Communications Timeout" : "30 secs"
          },
          "propertyDescriptors" : {
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Server Port" : {
              "displayName" : "Server Port",
              "identifiesControllerService" : false,
              "name" : "Server Port",
              "sensitive" : false
            },
            "Server Hostname" : {
              "displayName" : "Server Hostname",
              "identifiesControllerService" : false,
              "name" : "Server Hostname",
              "sensitive" : false
            },
            "Communications Timeout" : {
              "displayName" : "Communications Timeout",
              "identifiesControllerService" : false,
              "name" : "Communications Timeout",
              "sensitive" : false
            }
          },
          "type" : "org.apache.nifi.distributed.cache.client.DistributedMapCacheClientService"
        } ],
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "identifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
        "inputPorts" : [ ],
        "labels" : [ ],
        "name" : "Clinical Ingestion",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "71a28556-726a-31dd-8f70-c6ec4a225938",
          "name" : "Warning",
          "position" : {
            "x" : 2856.0,
            "y" : 3880.0
          },
          "type" : "OUTPUT_PORT"
        }, {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "df2bf961-ba94-3117-880f-b681af37a74d",
          "name" : "Aborted",
          "position" : {
            "x" : 2072.0,
            "y" : 3880.0
          },
          "type" : "OUTPUT_PORT"
        }, {
          "allowRemoteAccess" : false,
          "comments" : "",
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "31696a75-2651-3b81-86e7-cd47ee9c2669",
          "name" : "Success",
          "position" : {
            "x" : 2464.0,
            "y" : 3880.0
          },
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "cms_adapter_parameters",
        "position" : {
          "x" : 880.0,
          "y" : 232.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "99f16e3f-8e97-35db-886e-5e8bf9df91d0",
              "name" : "Branch on resourceId",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a3fdc0e1-6109-3f1e-a51e-93a0dd0525dd",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "matched", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "f658750c-3101-355d-a96f-2e77d5bd1d11",
              "name" : "Extract resourceId from JSON to Attribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3272.0,
              "y" : 3032.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "4625b360-fcce-351c-9eb1-d8c04c9b0096",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "a64a0cc4-afdf-355e-a250-6cdc882d8ef2",
              "name" : "Update resourceId Attribute with current value",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "e4047c97-d2ff-3d13-a4cf-35582a5f8dd5",
              "name" : "Update Content-Type",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "2cf2c8f6-9a25-3cb5-9c1a-f3a00a911870",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Found Content-Type" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "79db015f-e7f7-340c-8abf-8611bf54d5ef",
              "name" : "If Content-Type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 2306.346923828125,
              "y" : 3778.33837890625
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a1c05f08-9411-3256-addb-0d262c4bbcfc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "57ca9a14-8121-3252-96ae-1c11533485f6",
              "name" : "Replace UUID() with generated UUID",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3272.0,
              "y" : 2752.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "bca79b15-813d-3ccd-95aa-d95df99f88d3",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "95a73765-c48a-3bc1-a82c-1b20b1b15292",
              "name" : "Generate and Add resourceId to Json",
              "type" : "PROCESSOR"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "fd50d731-a632-395b-a281-41939d92390d",
              "name" : "Update Mime.Type",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "695f861b-6781-3efd-8dac-1fd0f282202d",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Found Mime.Type" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "64c1f2f1-d585-3236-ab41-faba15cebd7b",
              "name" : "if Mime.Type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "bcca42dd-fc38-3451-8149-36f63778fa40",
              "name" : "Clean FHIR Resource",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a47238b9-1028-30b5-bc8f-329a52b4acc6",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "02fb1cb3-eec7-389d-9515-f35861091d5d",
              "name" : "Add Batch IDs",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "f658750c-3101-355d-a96f-2e77d5bd1d11",
              "name" : "Extract resourceId from JSON to Attribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "cea67bb6-00c7-3f92-bce1-7371eb8da4bb",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "6509c387-6fc3-3983-a979-17f972d43eb7",
              "name" : "Always Set mime.type ",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3272.0,
              "y" : 2288.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "2d8f689c-9e2b-3531-b992-6e648274e9a2",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "f658750c-3101-355d-a96f-2e77d5bd1d11",
              "name" : "Extract resourceId from JSON to Attribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "64c1f2f1-d585-3236-ab41-faba15cebd7b",
              "name" : "if Mime.Type Exists",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a9168462-a8e3-3756-a724-4aedb7cb3adf",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "80659eed-9757-3131-8a19-2a1dcf95ed3b",
              "name" : "Update content-type",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "7177550b-6077-33cf-9591-f17f4dae3061",
              "name" : "if content-type Exists",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "01d27264-90cf-36a2-8af3-b879cbeb7d42",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "79db015f-e7f7-340c-8abf-8611bf54d5ef",
              "name" : "If Content-Type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "80659eed-9757-3131-8a19-2a1dcf95ed3b",
              "name" : "Update content-type",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "d0c9e965-3c2b-367c-a916-65874bf10e19",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Found content-type" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "7177550b-6077-33cf-9591-f17f4dae3061",
              "name" : "if content-type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "57ca9a14-8121-3252-96ae-1c11533485f6",
              "name" : "Replace UUID() with generated UUID",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "f3e1c6e8-9c00-3ed8-a176-4c07c9a20e5c",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "99f16e3f-8e97-35db-886e-5e8bf9df91d0",
              "name" : "Branch on resourceId",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "a64a0cc4-afdf-355e-a250-6cdc882d8ef2",
              "name" : "Update resourceId Attribute with current value",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "2529e755-788e-3c12-ad8a-4992c5ca2898",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "95a73765-c48a-3bc1-a82c-1b20b1b15292",
              "name" : "Generate and Add resourceId to Json",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "a64a0cc4-afdf-355e-a250-6cdc882d8ef2",
              "name" : "Update resourceId Attribute with current value",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "322f6ca0-2f70-3e03-9019-af580e425175",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "57ca9a14-8121-3252-96ae-1c11533485f6",
              "name" : "Replace UUID() with generated UUID",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "95a73765-c48a-3bc1-a82c-1b20b1b15292",
              "name" : "Generate and Add resourceId to Json",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "4e25ed77-fe93-3720-b12f-25f67700b906",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "resourceIdNotSet" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "99f16e3f-8e97-35db-886e-5e8bf9df91d0",
              "name" : "Branch on resourceId",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "02fb1cb3-eec7-389d-9515-f35861091d5d",
              "name" : "Add Batch IDs",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "def8262f-2427-3bbd-b36b-fddeed3e267a",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "8d6d649e-8005-3ee6-9621-4301a0f40f22",
              "name" : "Add Common Attributes",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "7177550b-6077-33cf-9591-f17f4dae3061",
              "name" : "if content-type Exists",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "07ed5cb6-cab8-3fe4-a8ff-9f10510573f4",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "e4047c97-d2ff-3d13-a4cf-35582a5f8dd5",
              "name" : "Update Content-Type",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "79db015f-e7f7-340c-8abf-8611bf54d5ef",
              "name" : "If Content-Type Exists",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "3083e4e6-82ef-3020-b5c0-54fe0bb7767f",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "cee78597-5464-390c-9871-d205fc6d342f",
              "name" : "FHIR Resource",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "8d6d649e-8005-3ee6-9621-4301a0f40f22",
              "name" : "Add Common Attributes",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "826a974c-02bd-3775-8ab7-2bcc81d61d04",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "matched", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "a64a0cc4-afdf-355e-a250-6cdc882d8ef2",
              "name" : "Update resourceId Attribute with current value",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "64c1f2f1-d585-3236-ab41-faba15cebd7b",
              "name" : "if Mime.Type Exists",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a1c5123e-d4e5-3464-b95a-38b5d254cb0b",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "7177550b-6077-33cf-9591-f17f4dae3061",
              "name" : "if content-type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "6509c387-6fc3-3983-a979-17f972d43eb7",
              "name" : "Always Set mime.type ",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "24b1b030-58d3-3333-9575-a72bbddc1318",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "64c1f2f1-d585-3236-ab41-faba15cebd7b",
              "name" : "if Mime.Type Exists",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "6509c387-6fc3-3983-a979-17f972d43eb7",
              "name" : "Always Set mime.type ",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "53771549-e6b6-3205-85d1-b87d56fac104",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
              "id" : "fd50d731-a632-395b-a281-41939d92390d",
              "name" : "Update Mime.Type",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "cee78597-5464-390c-9871-d205fc6d342f",
            "name" : "FHIR Resource",
            "position" : {
              "x" : 2184.0,
              "y" : 1008.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ {
            "componentType" : "LABEL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "height" : 880.0,
            "identifier" : "cca725a3-96cd-3b1b-8164-4b9990619e45",
            "label" : "Four different \"type\" values might be set: Content-Type, content-type, Mime.Type, and mime.type. If any are set, update them \nto \"application/json\".  Always set \"mime.type\" so Nifi can properly format the FHIR json for the rest of the flow.",
            "position" : {
              "x" : 2088.0,
              "y" : 1192.0
            },
            "style" : {
              "font-size" : "18px"
            },
            "width" : 1040.0
          }, {
            "componentType" : "LABEL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "height" : 944.0,
            "identifier" : "7d482a8f-215c-32a5-b685-334324151f2f",
            "label" : "Make sure resource id value is set for FHIR resource",
            "position" : {
              "x" : 2088.0,
              "y" : 2192.0
            },
            "style" : {
              "font-size" : "18px"
            },
            "width" : 1032.0
          } ],
          "name" : "Clean up Input Data",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "28b8bf7e-dcb1-3549-a6be-2bbb305709b6",
            "name" : "Failure",
            "position" : {
              "x" : 3152.0,
              "y" : 3752.0
            },
            "type" : "OUTPUT_PORT"
          }, {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "bcca42dd-fc38-3451-8149-36f63778fa40",
            "name" : "Clean FHIR Resource",
            "position" : {
              "x" : 2464.0,
              "y" : 3680.0
            },
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "cms_adapter_parameters",
          "position" : {
            "x" : 2384.0,
            "y" : 2520.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "e4047c97-d2ff-3d13-a4cf-35582a5f8dd5",
            "name" : "Update Content-Type",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2752.0,
              "y" : 1264.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "Content-Type" : "application/json"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "Content-Type" : {
                "displayName" : "Content-Type",
                "identifiesControllerService" : false,
                "name" : "Content-Type",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "fd50d731-a632-395b-a281-41939d92390d",
            "name" : "Update Mime.Type",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2752.0,
              "y" : 1688.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "Mime.Type" : "application/json"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Mime.Type" : {
                "displayName" : "Mime.Type",
                "identifiesControllerService" : false,
                "name" : "Mime.Type",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "80659eed-9757-3131-8a19-2a1dcf95ed3b",
            "name" : "Update content-type",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2752.0,
              "y" : 1480.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "content-type" : "application/json"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "content-type" : {
                "displayName" : "content-type",
                "identifiesControllerService" : false,
                "name" : "content-type",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "6509c387-6fc3-3983-a979-17f972d43eb7",
            "name" : "Always Set mime.type ",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 1928.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "mime.type" : "application/json"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "mime.type" : {
                "displayName" : "mime.type",
                "identifiesControllerService" : false,
                "name" : "mime.type",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "8d6d649e-8005-3ee6-9621-4301a0f40f22",
            "name" : "Add Common Attributes",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 3256.0
            },
            "properties" : {
              "batchName" : "batch_${random():mod(89999):plus(10000)}",
              "ResolveTerminology" : "${ResolveTerminology:replaceEmpty(${resolveterminology})}",
              "RequestId" : "${RequestId:replaceEmpty(${requestid})}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "FHIRPreferSetting" : "minimal",
              "DeidentifyData" : "${DeidentifyData:replaceEmpty(${deidentifydata})}",
              "failureTopic" : "#{kafka.topic.in}.error",
              "Delete Attributes Expression" : "deidentifydata|resolveterminology|requestid|runascvd",
              "kafka.topic" : "#{kafka.topic.in}",
              "RunASCVD" : "${RunASCVD:replaceEmpty(${runascvd})}",
              "tenant" : "default",
              "startDate" : "${now():format(\"yyyy-MM-dd'T'HH:mm:ss'Z'\")} \n"
            },
            "propertyDescriptors" : {
              "batchName" : {
                "displayName" : "batchName",
                "identifiesControllerService" : false,
                "name" : "batchName",
                "sensitive" : false
              },
              "ResolveTerminology" : {
                "displayName" : "ResolveTerminology",
                "identifiesControllerService" : false,
                "name" : "ResolveTerminology",
                "sensitive" : false
              },
              "RequestId" : {
                "displayName" : "RequestId",
                "identifiesControllerService" : false,
                "name" : "RequestId",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "FHIRPreferSetting" : {
                "displayName" : "FHIRPreferSetting",
                "identifiesControllerService" : false,
                "name" : "FHIRPreferSetting",
                "sensitive" : false
              },
              "DeidentifyData" : {
                "displayName" : "DeidentifyData",
                "identifiesControllerService" : false,
                "name" : "DeidentifyData",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "failureTopic" : {
                "displayName" : "failureTopic",
                "identifiesControllerService" : false,
                "name" : "failureTopic",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "kafka.topic" : {
                "displayName" : "kafka.topic",
                "identifiesControllerService" : false,
                "name" : "kafka.topic",
                "sensitive" : false
              },
              "RunASCVD" : {
                "displayName" : "RunASCVD",
                "identifiesControllerService" : false,
                "name" : "RunASCVD",
                "sensitive" : false
              },
              "tenant" : {
                "displayName" : "tenant",
                "identifiesControllerService" : false,
                "name" : "tenant",
                "sensitive" : false
              },
              "startDate" : {
                "displayName" : "startDate",
                "identifiesControllerService" : false,
                "name" : "startDate",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "99f16e3f-8e97-35db-886e-5e8bf9df91d0",
            "name" : "Branch on resourceId",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 2472.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "resourceIdNotSet" : "${resourceId:isNull():or(${resourceId:isEmpty()})}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "resourceIdNotSet" : {
                "displayName" : "resourceIdNotSet",
                "identifiesControllerService" : false,
                "name" : "resourceIdNotSet",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "95a73765-c48a-3bc1-a82c-1b20b1b15292",
            "name" : "Generate and Add resourceId to Json",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2752.0,
              "y" : 2680.0
            },
            "properties" : {
              "jolt-spec" : "[{\n  \"operation\": \"default\",\n  \"spec\": {\n    \"id\": \"${UUID()}\"\n  }\n}, {\n  \"operation\": \"shift\",\n  \"spec\": {\n    \"*\": \"&\"\n  }\n}]",
              "jolt-transform" : "jolt-transform-chain",
              "pretty_print" : "false",
              "Transform Cache Size" : "1"
            },
            "propertyDescriptors" : {
              "jolt-spec" : {
                "displayName" : "Jolt Specification",
                "identifiesControllerService" : false,
                "name" : "jolt-spec",
                "sensitive" : false
              },
              "jolt-transform" : {
                "displayName" : "Jolt Transformation DSL",
                "identifiesControllerService" : false,
                "name" : "jolt-transform",
                "sensitive" : false
              },
              "jolt-custom-class" : {
                "displayName" : "Custom Transformation Class Name",
                "identifiesControllerService" : false,
                "name" : "jolt-custom-class",
                "sensitive" : false
              },
              "jolt-custom-modules" : {
                "displayName" : "Custom Module Directory",
                "identifiesControllerService" : false,
                "name" : "jolt-custom-modules",
                "sensitive" : false
              },
              "pretty_print" : {
                "displayName" : "Pretty Print",
                "identifiesControllerService" : false,
                "name" : "pretty_print",
                "sensitive" : false
              },
              "Transform Cache Size" : {
                "displayName" : "Transform Cache Size",
                "identifiesControllerService" : false,
                "name" : "Transform Cache Size",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.JoltTransformJSON",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "7177550b-6077-33cf-9591-f17f4dae3061",
            "name" : "if content-type Exists",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2128.0,
              "y" : 1480.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "Found content-type" : "${content-type:notNull()}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "Found content-type" : {
                "displayName" : "Found content-type",
                "identifiesControllerService" : false,
                "name" : "Found content-type",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "79db015f-e7f7-340c-8abf-8611bf54d5ef",
            "name" : "If Content-Type Exists",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2128.0,
              "y" : 1264.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "Found Content-Type" : "${Content-Type:notNull()}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "Found Content-Type" : {
                "displayName" : "Found Content-Type",
                "identifiesControllerService" : false,
                "name" : "Found Content-Type",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "64c1f2f1-d585-3236-ab41-faba15cebd7b",
            "name" : "if Mime.Type Exists",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2128.0,
              "y" : 1688.0
            },
            "properties" : {
              "Found Mime.Type" : "${Mime.Type:notNull()}",
              "Routing Strategy" : "Route to Property name"
            },
            "propertyDescriptors" : {
              "Found Mime.Type" : {
                "displayName" : "Found Mime.Type",
                "identifiesControllerService" : false,
                "name" : "Found Mime.Type",
                "sensitive" : false
              },
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "57ca9a14-8121-3252-96ae-1c11533485f6",
            "name" : "Replace UUID() with generated UUID",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2128.0,
              "y" : 2680.0
            },
            "properties" : {
              "Regular Expression" : "\\$\\{UUID\\(\\)\\}",
              "Replacement Value" : "${UUID()}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "50 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "02fb1cb3-eec7-389d-9515-f35861091d5d",
            "name" : "Add Batch IDs",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 3472.0
            },
            "properties" : {
              "messageBatchId" : "message_${batchName}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "sourceBatchId" : "source_${batchName}"
            },
            "propertyDescriptors" : {
              "messageBatchId" : {
                "displayName" : "messageBatchId",
                "identifiesControllerService" : false,
                "name" : "messageBatchId",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "sourceBatchId" : {
                "displayName" : "sourceBatchId",
                "identifiesControllerService" : false,
                "name" : "sourceBatchId",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "f658750c-3101-355d-a96f-2e77d5bd1d11",
            "name" : "Extract resourceId from JSON to Attribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 2224.0
            },
            "properties" : {
              "Destination" : "flowfile-attribute",
              "resourceId" : "$.id",
              "Return Type" : "auto-detect",
              "Null Value Representation" : "empty string",
              "Path Not Found Behavior" : "ignore"
            },
            "propertyDescriptors" : {
              "Destination" : {
                "displayName" : "Destination",
                "identifiesControllerService" : false,
                "name" : "Destination",
                "sensitive" : false
              },
              "resourceId" : {
                "displayName" : "resourceId",
                "identifiesControllerService" : false,
                "name" : "resourceId",
                "sensitive" : false
              },
              "Return Type" : {
                "displayName" : "Return Type",
                "identifiesControllerService" : false,
                "name" : "Return Type",
                "sensitive" : false
              },
              "Null Value Representation" : {
                "displayName" : "Null Value Representation",
                "identifiesControllerService" : false,
                "name" : "Null Value Representation",
                "sensitive" : false
              },
              "Path Not Found Behavior" : {
                "displayName" : "Path Not Found Behavior",
                "identifiesControllerService" : false,
                "name" : "Path Not Found Behavior",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "301739c7-05f0-30a8-804b-7c3dd85ce82d",
            "identifier" : "a64a0cc4-afdf-355e-a250-6cdc882d8ef2",
            "name" : "Update resourceId Attribute with current value",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 2408.0,
              "y" : 2960.0
            },
            "properties" : {
              "Destination" : "flowfile-attribute",
              "resourceId" : "$.id",
              "Return Type" : "auto-detect",
              "Null Value Representation" : "empty string",
              "Path Not Found Behavior" : "ignore"
            },
            "propertyDescriptors" : {
              "Destination" : {
                "displayName" : "Destination",
                "identifiesControllerService" : false,
                "name" : "Destination",
                "sensitive" : false
              },
              "resourceId" : {
                "displayName" : "resourceId",
                "identifiesControllerService" : false,
                "name" : "resourceId",
                "sensitive" : false
              },
              "Return Type" : {
                "displayName" : "Return Type",
                "identifiesControllerService" : false,
                "name" : "Return Type",
                "sensitive" : false
              },
              "Null Value Representation" : {
                "displayName" : "Null Value Representation",
                "identifiesControllerService" : false,
                "name" : "Null Value Representation",
                "sensitive" : false
              },
              "Path Not Found Behavior" : {
                "displayName" : "Path Not Found Behavior",
                "identifiesControllerService" : false,
                "name" : "Path Not Found Behavior",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "1a436a0f-0515-3701-944b-18a90ba44180",
              "name" : "Check For Abort",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "b27f4d00-6818-35e8-9723-8989221007a3",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "3f4a9f47-38bb-306f-a1c9-191380b381cb",
              "name" : "input",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 592.0,
              "y" : 1032.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "a1c483f2-3a06-3f5a-9049-4d23e9afd539",
              "name" : "Set To Aborted",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "4d365c9b-31f0-3a1f-8f7c-5fddd44eedf5",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "1a436a0f-0515-3701-944b-18a90ba44180",
              "name" : "Check For Abort",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "a540cf51-0e1b-386a-b1c6-1a5a765b66fa",
              "name" : "Set To Aborted",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "15e9064f-3944-326c-b41d-6fec0f6cb792",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "id" : "060c7afa-913f-3e05-9ad9-fe90177c35a9",
              "name" : "Aborted",
              "type" : "OUTPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 2060.2279052734375,
              "y" : 1987.6890869140625
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "c53afa98-a466-3a72-acb0-73c9ea773a3f",
              "name" : "Set To Failed",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "37c6657d-5f19-315f-bdad-83741b41d01c",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "id" : "8163d4ad-47bd-309f-97aa-8b33a83e8a7a",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "f6eaf83b-0427-33d7-b7a7-517e5135e93f",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "21144e79-75e7-349d-a860-48f992e6c380",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "a1c483f2-3a06-3f5a-9049-4d23e9afd539",
              "name" : "Set To Aborted",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "id" : "31c5e395-d024-3a33-bf3a-da87e1cf8d24",
              "name" : "FHIR Resource",
              "type" : "INPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "dcd0a66a-2d38-33aa-a9cd-435adb5cacdd",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "not-found", "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "1a436a0f-0515-3701-944b-18a90ba44180",
              "name" : "Check For Abort",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "f6eaf83b-0427-33d7-b7a7-517e5135e93f",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "85cc02f3-bbc6-3f18-8b7e-db7aeee97671",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "id" : "2ec0b632-1547-3792-9b05-7a6d1089b37f",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "f6eaf83b-0427-33d7-b7a7-517e5135e93f",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "12ed3600-bf80-3957-92c8-cdc7d7f5e9fc",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "c53afa98-a466-3a72-acb0-73c9ea773a3f",
              "name" : "Set To Failed",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 864.0,
              "y" : 1992.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "id" : "8099028e-aedc-3a68-8713-23f0988f35f3",
              "name" : "Input",
              "type" : "INPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "7272158f-b2bb-3210-837f-02e109ac9e20",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
              "id" : "a540cf51-0e1b-386a-b1c6-1a5a765b66fa",
              "name" : "Set To Aborted",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "id" : "d8caca6b-f49d-3e14-ac87-33007a69b2db",
              "name" : "Input",
              "type" : "INPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "b0aa88a7-5cad-3b16-b7f0-6aa4e6716bf8",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "id" : "f59cb438-fed1-37e7-b47c-5060c1bd0a2f",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "id" : "8099028e-aedc-3a68-8713-23f0988f35f3",
              "name" : "Input",
              "type" : "INPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "8ae1f3d8-1e2e-3664-bcb9-f409a717259a",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "id" : "0646899c-6749-3333-b6b1-11a3d43a1ad1",
              "name" : "Output",
              "type" : "OUTPUT_PORT"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "comments" : "",
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "3f4a9f47-38bb-306f-a1c9-191380b381cb",
            "name" : "input",
            "position" : {
              "x" : 1320.0,
              "y" : 784.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ {
            "componentType" : "LABEL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "height" : 112.0,
            "identifier" : "48d7adde-dad9-3049-b688-b1d094aca167",
            "label" : "On Output, two attributes will be set on the flowfiles to determine success:\n\n\nhri.ingest.record.progress [SUCCESS, WARNING, ERROR, ABORT]\nresourceSavedStatus [success, warning, failure, aborted]",
            "position" : {
              "x" : 1936.0,
              "y" : 560.0
            },
            "style" : {
              "font-size" : "12px"
            },
            "width" : 464.0
          }, {
            "componentType" : "LABEL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "height" : 216.0,
            "identifier" : "1ff0518d-f014-358b-a796-62f7a66b1fb7",
            "label" : "Expects the following attributes to be set on input:\n- tenant\n- FHIRResourceTag\n- failureTopic\n- sourceBatchId\n- batchName\n- dataType\n- messageBatchId\n- startDate\n- kafka.topic\n- autoBuildBundles (set to 'True' to enable auto bundling of single resources)\n- FHIRPreferSetting (set to 'OperationOutcome' to return warnings from FHIR. 'minimal' for errors only)\n",
            "position" : {
              "x" : 1264.0,
              "y" : 544.0
            },
            "style" : {
              "font-size" : "12px"
            },
            "width" : 608.0
          } ],
          "name" : "Send to FHIR and Post Errors V49",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "comments" : "",
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "f6eaf83b-0427-33d7-b7a7-517e5135e93f",
            "name" : "Output",
            "position" : {
              "x" : 1320.0,
              "y" : 2296.0
            },
            "type" : "OUTPUT_PORT"
          } ],
          "position" : {
            "x" : 2384.0,
            "y" : 3352.0
          },
          "processGroups" : [ {
            "comments" : "",
            "componentType" : "PROCESS_GROUP",
            "connections" : [ {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "655a8361-71ee-31f3-80da-f4cb762a87a3",
                "name" : "Build Error Message",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "6b3b7769-8f5b-3d0a-86f8-d04931b5cddd",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "unmatched" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "227660fd-6d3d-3d95-ad93-ef75ec4a71b1",
                "name" : "ContentEmpty and not Failure?",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "227660fd-6d3d-3d95-ad93-ef75ec4a71b1",
                "name" : "ContentEmpty and not Failure?",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "34d7bd75-3041-304f-bb35-d2f32f3c07d6",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure", "success" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "2a420eec-49c4-339c-b29d-46e1980f10a7",
                "name" : "Strip Information Messages",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "0646899c-6749-3333-b6b1-11a3d43a1ad1",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "b668013f-6de4-3ba1-85d5-391c72414638",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "id" : "c5186250-d696-3fb7-8d50-2b4852baf9a7",
                "name" : "Published Data",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "id" : "3c710103-d4aa-355b-a46a-b9470dae4a2c",
                "name" : "Error/Warning",
                "type" : "INPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "1f3f33d4-36c1-35b2-bfca-ef72c6f3abe6",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "success" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "655a8361-71ee-31f3-80da-f4cb762a87a3",
                "name" : "Build Error Message",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "0646899c-6749-3333-b6b1-11a3d43a1ad1",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "d80d2d19-8a17-3c90-b2b5-a215f20cc914",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "contentEmpty" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "227660fd-6d3d-3d95-ad93-ef75ec4a71b1",
                "name" : "ContentEmpty and not Failure?",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "0646899c-6749-3333-b6b1-11a3d43a1ad1",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "25782f6c-18ac-3e6e-9cd7-700e1aa473cc",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "655a8361-71ee-31f3-80da-f4cb762a87a3",
                "name" : "Build Error Message",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "2a420eec-49c4-339c-b29d-46e1980f10a7",
                "name" : "Strip Information Messages",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "bd77f8c5-667d-31ef-9d00-ea3cbf6f60e9",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
                "id" : "d8caca6b-f49d-3e14-ac87-33007a69b2db",
                "name" : "Input",
                "type" : "INPUT_PORT"
              },
              "zIndex" : 0
            } ],
            "controllerServices" : [ ],
            "flowFileConcurrency" : "UNBOUNDED",
            "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
            "funnels" : [ ],
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
            "inputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "INPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "d8caca6b-f49d-3e14-ac87-33007a69b2db",
              "name" : "Input",
              "position" : {
                "x" : -24.0,
                "y" : 1032.0
              },
              "type" : "INPUT_PORT"
            } ],
            "labels" : [ {
              "componentType" : "LABEL",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "height" : 72.0,
              "identifier" : "e2597023-a0d5-3402-ab2e-4dea306df7e6",
              "label" : "Expects the attribute resourceSavedStatus to be set to any of:\n- failure\n- success\n- warning",
              "position" : {
                "x" : 248.0,
                "y" : 1016.0
              },
              "style" : {
                "font-size" : "12px"
              },
              "width" : 400.0
            }, {
              "componentType" : "LABEL",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "height" : 80.0,
              "identifier" : "d29bc41c-a4d5-38dc-920d-7ce59b88ebb6",
              "label" : "1. Generates the json to post to the HRI error topic that includes details of the batch resource and error/warning messages.\n2. Sets the batchId attribute from messageBatchId (messageBatchId must be set)\n\nIf required attributes not set or there is an error, errors are logged and the flowfile is sent to the failure relationship.",
              "position" : {
                "x" : 704.0,
                "y" : 1408.0
              },
              "style" : {
                "font-size" : "12px"
              },
              "width" : 688.0
            } ],
            "name" : "Build and Post Error Messages",
            "outputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "OUTPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "0646899c-6749-3333-b6b1-11a3d43a1ad1",
              "name" : "Output",
              "position" : {
                "x" : -32.0,
                "y" : 2016.0
              },
              "type" : "OUTPUT_PORT"
            } ],
            "parameterContextName" : "cms_adapter_parameters",
            "position" : {
              "x" : 1248.0,
              "y" : 1536.0
            },
            "processGroups" : [ {
              "comments" : "",
              "componentType" : "PROCESS_GROUP",
              "connections" : [ {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 5680.0,
                  "y" : 1608.0
                }, {
                  "x" : 5680.0,
                  "y" : 1944.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c5186250-d696-3fb7-8d50-2b4852baf9a7",
                  "name" : "Published Data",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "09f47609-c0f0-398e-975d-ff280d105b1c",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "single page",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "unmatched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "80149fd4-9d6f-3d33-9689-9a972dab9d14",
                  "name" : "Record was split into multiple pages?",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "7b2f5ee0-079a-3ddb-93a9-1efe3f73f33b",
                  "name" : "Log Kafka Publish Failed",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "166ea11b-f1d8-38b9-8838-865ac694fe1e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "fdbb7df4-e57d-3011-9376-d6f15f65e68e",
                  "name" : "Publish Error/Warning to Kafka",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "bfe757d6-1518-3605-bc09-84488df705b4",
                  "name" : "Log Merge of pages failed",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "1cc22203-22ed-3d58-bc6e-dc7f0c4d4394",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c9bb8217-81db-3d31-9533-7f4e9ef274f3",
                  "name" : "Merge pages together",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 6664.0,
                  "y" : 1464.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "80149fd4-9d6f-3d33-9689-9a972dab9d14",
                  "name" : "Record was split into multiple pages?",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "9df84671-ff53-3fb0-9581-8089f32cd496",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "7b2f5ee0-079a-3ddb-93a9-1efe3f73f33b",
                  "name" : "Log Kafka Publish Failed",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 6640.0,
                  "y" : 1848.0
                }, {
                  "x" : 6296.0,
                  "y" : 1976.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c5186250-d696-3fb7-8d50-2b4852baf9a7",
                  "name" : "Published Data",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "0944c7ed-202d-3ce9-aa9e-e275c5fe19f2",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "bfe757d6-1518-3605-bc09-84488df705b4",
                  "name" : "Log Merge of pages failed",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 6672.0,
                  "y" : 608.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "7b2f5ee0-079a-3ddb-93a9-1efe3f73f33b",
                  "name" : "Log Kafka Publish Failed",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "bb6b0220-79d5-3418-936e-e9dc28c691eb",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "oversized" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "2a9103d5-a75d-3d50-a9ce-3c2d8e911635",
                  "name" : "Is size limit still exceeded?",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c5186250-d696-3fb7-8d50-2b4852baf9a7",
                  "name" : "Published Data",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "87be14b0-30b3-3b57-a1e4-8f3aa14fccd8",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "merged" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c9bb8217-81db-3d31-9533-7f4e9ef274f3",
                  "name" : "Merge pages together",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "d437c050-8f5f-3003-b512-925bdeff0f7f",
                  "name" : "Break up error message if too large",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "85302f76-7b10-34fd-b79b-34474ebd3bc4",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "3c710103-d4aa-355b-a46a-b9470dae4a2c",
                  "name" : "Error/Warning",
                  "type" : "INPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "2a9103d5-a75d-3d50-a9ce-3c2d8e911635",
                  "name" : "Is size limit still exceeded?",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "e07f60ab-56b2-3fbd-b6a5-05564a1f2b7f",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "d437c050-8f5f-3003-b512-925bdeff0f7f",
                  "name" : "Break up error message if too large",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "c9bb8217-81db-3d31-9533-7f4e9ef274f3",
                  "name" : "Merge pages together",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "7cd7ab27-ae04-399e-b9b9-4047917b7793",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "multi-page" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "80149fd4-9d6f-3d33-9689-9a972dab9d14",
                  "name" : "Record was split into multiple pages?",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "fdbb7df4-e57d-3011-9376-d6f15f65e68e",
                  "name" : "Publish Error/Warning to Kafka",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "3c22b353-b745-3dce-a3ac-b2a40f983e80",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "size ok",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "unmatched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "2a9103d5-a75d-3d50-a9ce-3c2d8e911635",
                  "name" : "Is size limit still exceeded?",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "80149fd4-9d6f-3d33-9689-9a972dab9d14",
                  "name" : "Record was split into multiple pages?",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "46240485-b972-367c-821d-91160605858e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                  "id" : "fdbb7df4-e57d-3011-9376-d6f15f65e68e",
                  "name" : "Publish Error/Warning to Kafka",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              } ],
              "controllerServices" : [ ],
              "flowFileConcurrency" : "UNBOUNDED",
              "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
              "funnels" : [ ],
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
              "inputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "INPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "3c710103-d4aa-355b-a46a-b9470dae4a2c",
                "name" : "Error/Warning",
                "position" : {
                  "x" : 5880.0,
                  "y" : 128.0
                },
                "type" : "INPUT_PORT"
              } ],
              "labels" : [ {
                "componentType" : "LABEL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "height" : 296.0,
                "identifier" : "393d4d47-951f-384a-9746-16a8170f55f7",
                "label" : "1) If necessary and possiible, splits flow file content that is bigger than what kafka allows for a message size..\n\n2) Publishes to kafka.\n\n3) If a split was preformed, merges the pages that were split back together.\n\n----\nKafka has a configurable limit of a 1MB message size, however that size includes the key (if there is one), headers (if there are any), \nand metada (such as the offset and timestamp).\n\nChanging the configuration to increase the max size would require modifying the producer, broker, and consumer, which is non practical.\n\nThis process splits up json documents that contain a list at json path ['errorDetails', 'entry'] so\nthat the list is not large enough to exceed a 950KB limit.\n\nDocuments that do not contain that path or are not valid json are not split.\n\nAfter publishing,  files that were split are merged back into a single file, in order to \nensure a \"one file in = one file out\" flow. The merge uses a flow file stream strategy, which should be faster.\n",
                "position" : {
                  "x" : 5120.0,
                  "y" : -8.0
                },
                "style" : {
                  "font-size" : "14px"
                },
                "width" : 1200.0
              } ],
              "name" : "Publish Error or Warning to Kafka Topic",
              "outputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "c5186250-d696-3fb7-8d50-2b4852baf9a7",
                "name" : "Published Data",
                "position" : {
                  "x" : 5880.0,
                  "y" : 2152.0
                },
                "type" : "OUTPUT_PORT"
              } ],
              "parameterContextName" : "cms_adapter_parameters",
              "position" : {
                "x" : 520.0,
                "y" : 1952.0
              },
              "processGroups" : [ ],
              "processors" : [ {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "d437c050-8f5f-3003-b512-925bdeff0f7f",
                "name" : "Break up error message if too large",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 5824.0,
                  "y" : 320.0
                },
                "properties" : {
                  "max.request.size" : "900 KB",
                  "max flow files" : "100",
                  "Script Engine" : "Groovy",
                  "Script Body" : "// *****************************************************************\n//\n// IBM Confidential\n// OCO Source Materials\n//\n// (C) Copyright IBM Corp. 2021\n//\n// The source code for this program is not published or otherwise\n// divested of its trade secrets, irrespective of what has been\n// deposited with the U.S. Copyright Office.\n//\n// *****************************************************************\n\n/*************************************************************************\n * Intended to be used with the NiFi ExecuteScript processor\n * \n * This will break up an incomming flow file that contains json\n * with a list of objects at path ['errorDetails', 'entry']. In other words \n * Error or Warning responses for a bundle.\n * \n * Each output flow file will contain a subset of the list that\n * when serialized is less than the max allowed size.\n * \n * The json will have additional properties that describe the page information:\n {\n \"pageInfo\" : {\n \"currentPage\" : 0,\n \"numPages\" : 3\n }\n \"errorDetails\" : {\n \"entry\" : [\n {}, {}, {}    <----- Subset of original list\n ]\n }\n }\n * Input flow files that are not large enough to warrent splitting, do not have the required\n * json path, or are not valid json will not be modified by this processor.\n * \n * In the case of a split, the following output attributes are set:\n * fragment.identifier        - used to merge flow files back into a single file\n * fragment.index             - which fragment is this flow file\n * fragment.count             - the number of flow files the original flow file was split into \n * segment.original.filename  - the originalFileName\n * multipage                  - the indicator that this is a split response \n * \n */\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport groovy.json.JsonParserType\nimport org.apache.nifi.processor.DataUnit\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.components.PropertyValue\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.logging.ComponentLog\n\nimport static org.apache.nifi.expression.ExpressionLanguageScope.VARIABLE_REGISTRY\n\nimport org.apache.nifi.components.PropertyDescriptor\n\nclass SplitBundleErrorDetailsProcessor extends AbstractProcessor {\n\tfinal Relationship REL_SUCCESS = new Relationship.Builder() //\n\t.name(\"success\") //\n\t.description(\"\") //\n\t.build();\n\n\tfinal static PropertyDescriptor MAX_INPUT_FLOW_FILES_PROP =\n\tnew PropertyDescriptor.Builder() //\n\t.name(\"max flow files\") //\n\t.displayName(\"Max input flow files\") //\n\t.description(\n\t\"Specifies the max number of flow files to process prior to a commit.\") //\n\t.addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR) //\n\t.expressionLanguageSupported(VARIABLE_REGISTRY)\n\t.required(true)\n\t.defaultValue(\"100\")\n\t.build();\n\n\tfinal static PropertyDescriptor MAX_SIZE_PROP =\n\tnew PropertyDescriptor.Builder().name(\"max.request.size\") //\n\t.displayName(\"Max size\") //\n\t.description(\n\t\"Max size before splitting a flow file.\") //\n\t.addValidator(StandardValidators.DATA_SIZE_VALIDATOR) //\n\t.expressionLanguageSupported(VARIABLE_REGISTRY)\n\t.required(true)\n\t.defaultValue(\"900 KB\")\n\t.build();\n\n\tfinal def pathToSplit = ['errorDetails', 'entry']\n\n\tSet<Relationship> getRelationships() {\n\t\treturn [REL_SUCCESS] as Set\n\t}\n\n\t@Override\n\tList<PropertyDescriptor> getSupportedPropertyDescriptors() {\n\t\treturn [\n\t\t\tMAX_SIZE_PROP,\n\t\t\tMAX_INPUT_FLOW_FILES_PROP\n\t\t]\n\t}\n\n\tdef jsonPath(def jObj, def  pathToList) {\n\t\tdef item\n\t\tdef container = jObj\n\n\t\tpathToList.eachWithIndex { term, index ->\n\t\t\tif (index < pathToList.size() - 1) {\n\t\t\t\tcontainer = container ? container[term] : null\n\t\t\t} else {\n\t\t\t\titem = container ? container[term] : null\n\t\t\t}\n\t\t}\n\t\treturn ['container' : container, 'item' : item]\n\t}\n\n\tdef collateBasedOnSize(list, long maxSize) {\n\t\tdef result = []\n\t\tdef (curList, curListSize) = [\n\t\t\t[],\n\t\t\t2] // size 2 for '[' and ']'\n\t\tlist.each  { item ->\n\t\t\tdef itemSize = JsonOutput.toJson(item).size()\n\t\t\tif (curListSize + itemSize  >= maxSize) { // split\n\t\t\t\tresult.add(curList)\n\t\t\t\t(curList, curListSize) = [\n\t\t\t\t\t[],\n\t\t\t\t\t2] // size 2 for '[' and ']'\n\t\t\t}\n\t\t\tcurListSize += itemSize + 1 // +1 for possible comma\n\t\t\tcurList += item\n\t\t}\n\t\tif (curList) {\n\t\t\tresult.add(curList)\n\t\t}\n\t\treturn result\n\t}\n\n\tdef splitIntoPages(def Map jObj, def List<String> splitPath, def long maxSize) {\n\t\tdef path = jsonPath(jObj, splitPath)\n\t\tdef jsonSlurper = new JsonSlurper().setType(JsonParserType.CHAR_BUFFER)\n\t\tdef objects = []\n\t\tdef maxListSize = maxSize - (JsonOutput.toJson(jObj).size() - JsonOutput.toJson(path['item']).size())\n\n\t\tcollateBasedOnSize(path['item'], maxListSize).each { pageData ->\n\t\t\tdef newObject = jsonSlurper.parseText(JsonOutput.toJson(jObj)) // deep copy the object\n\t\t\tjsonPath(newObject, splitPath)['container'][splitPath.last()] = pageData\n\t\t\tobjects +=  newObject\n\t\t}\n\n\t\tobjects.eachWithIndex {object, index ->\n\t\t\tobject['pageInfo'] = [\"currentPage\" : index, \"numPages\" : objects.size()]\n\t\t}\n\n\t\treturn objects\n\t}\n\n\tdef parseContent(String jsonString, ComponentLog log) {\n\t\ttry {\n\t\t\tdef jsonSlurper = new JsonSlurper() //\n\t\t\t\t\t.setType(JsonParserType.INDEX_OVERLAY)//\n\t\t\t\t\t.setCheckDates(false)\n\t\t\tjsonSlurper.parseText(jsonString)\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"input was not valid json\", e)\n\t\t\t[:]\n\t\t}\n\t}\n\n\tdef shouldNotTryToSplit(def flowFileJsonObj, def pathToSplit, def MAX_SIZE)  {\n\t\t// check for invalid json or path to split on doesn't exist in document\n\t\t(!flowFileJsonObj || !(jsonPath(flowFileJsonObj, pathToSplit)['item']))\n\t}\n\n\t@Override\n\tvoid onTrigger(ProcessContext context, ProcessSession session) {\n\t\tfinal long MAX_SIZE = context.getProperty(MAX_SIZE_PROP) //\n\t\t\t\t.evaluateAttributeExpressions() //\n\t\t\t\t.asDataSize(DataUnit.B)\n\t\tfinal int MAX_INPUT_FLOW_FILES = context.getProperty(MAX_INPUT_FLOW_FILES_PROP) //\n\t\t\t\t.evaluateAttributeExpressions() //\n\t\t\t\t.asInteger()\n\n\t\tList<FlowFile> flowFiles = session.get(MAX_INPUT_FLOW_FILES);\n\n\t\tif (!flowFiles) {\n\t\t\tcontext.yield()\n\t\t\treturn\n\t\t}\n\n\t\tfor (FlowFile flowFile in flowFiles) {\t\n\n\t\t\tif (flowFile.getSize() < MAX_SIZE) {\n\t\t\t\tsession.transfer(flowFile, REL_SUCCESS)\n\t\t\t} else {\n\n\t\t\t\tdef originalFileName = flowFile.getAttribute('filename') ?: 'unknown'\n\n\t\t\t\tdef String flowFileContent = session.read(flowFile).getText()\n\t\t\t\tdef flowFileJsonObj = parseContent(flowFileContent, getLogger())\n\t\n\t\t\t\tif (shouldNotTryToSplit(flowFileJsonObj, pathToSplit, MAX_SIZE)) {\n\t\t\t\t\tsession.transfer(flowFile, REL_SUCCESS)\n\t\t\t\t} else {\t\t\t\t\t\n\t\t\t\t\tdef newContentList = splitIntoPages(flowFileJsonObj, pathToSplit, MAX_SIZE).collect({obj -> JsonOutput.toJson(obj)})\n\n\t\t\t\t\tgetLogger().info(\"The size of Flow File is ${flowFileContent.size()}, the flow file is being split into \" +\n\t\t\t\t\t\t\t\"${newContentList.size()}  pages\" )\n\n\t\t\t\t\tdef fragmentId = context.getProperty('fragment.identifier') //\n\t\t\t\t\t\t\t.evaluateAttributeExpressions(flowFile) //\n\t\t\t\t\t\t\t.getValue() //\n\t\t\t\t\t\t\t?: UUID.randomUUID().toString()\n\n\t\t\t\t\tnewContentList.eachWithIndex { content, index ->\n\t\t\t\t\t\tFlowFile newFF = session.create(flowFile)\n\t\t\t\t\t\tnewFF = session.write(newFF, {out -> out.setBytes(content.getBytes())} as OutputStreamCallback )\n\t\t\t\t\t\tnewFF = session.putAllAttributes(newFF,\n\t\t\t\t\t\t\t\t[   'fragment.identifier'       : fragmentId,\n\t\t\t\t\t\t\t\t\t'fragment.index'            : \"\" + index,\n\t\t\t\t\t\t\t\t\t'fragment.count'            : \"\" + newContentList.size(),\n\t\t\t\t\t\t\t\t\t'segment.original.filename' : originalFileName,\n\t\t\t\t\t\t\t\t\t'multipage'                   : 'true'\n\t\t\t\t\t\t\t\t]\n\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\tsession.transfer(newFF, REL_SUCCESS)\n\t\t\t\t\t}\n\t\t\t\t\tsession.remove(flowFile)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nprocessor = new SplitBundleErrorDetailsProcessor()\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "max.request.size" : {
                    "displayName" : "Max size",
                    "identifiesControllerService" : false,
                    "name" : "max.request.size",
                    "sensitive" : false
                  },
                  "max flow files" : {
                    "displayName" : "Max input flow files",
                    "identifiesControllerService" : false,
                    "name" : "max flow files",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "bfe757d6-1518-3605-bc09-84488df705b4",
                "name" : "Log Merge of pages failed",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 6464.0,
                  "y" : 1688.0
                },
                "properties" : {
                  "Log prefix" : "Interop FHIR Adapter - Merging of split Error/Warning messages failed",
                  "character-set" : "UTF-8",
                  "Log Level" : "error",
                  "attributes-to-log-regex" : ".*",
                  "Log Payload" : "false"
                },
                "propertyDescriptors" : {
                  "Log prefix" : {
                    "displayName" : "Log prefix",
                    "identifiesControllerService" : false,
                    "name" : "Log prefix",
                    "sensitive" : false
                  },
                  "character-set" : {
                    "displayName" : "Character Set",
                    "identifiesControllerService" : false,
                    "name" : "character-set",
                    "sensitive" : false
                  },
                  "Log Level" : {
                    "displayName" : "Log Level",
                    "identifiesControllerService" : false,
                    "name" : "Log Level",
                    "sensitive" : false
                  },
                  "attributes-to-ignore-regex" : {
                    "displayName" : "Attributes to Ignore by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-ignore-regex",
                    "sensitive" : false
                  },
                  "Attributes to Ignore" : {
                    "displayName" : "Attributes to Ignore",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Ignore",
                    "sensitive" : false
                  },
                  "Attributes to Log" : {
                    "displayName" : "Attributes to Log",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Log",
                    "sensitive" : false
                  },
                  "attributes-to-log-regex" : {
                    "displayName" : "Attributes to Log by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-log-regex",
                    "sensitive" : false
                  },
                  "Log Payload" : {
                    "displayName" : "Log Payload",
                    "identifiesControllerService" : false,
                    "name" : "Log Payload",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.LogAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 3,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "2a9103d5-a75d-3d50-a9ce-3c2d8e911635",
                "name" : "Is size limit still exceeded?",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 5824.0,
                  "y" : 544.0
                },
                "properties" : {
                  "Routing Strategy" : "Route to Property name",
                  "oversized" : "${fileSize:gt(972800)}"
                },
                "propertyDescriptors" : {
                  "Routing Strategy" : {
                    "displayName" : "Routing Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Routing Strategy",
                    "sensitive" : false
                  },
                  "oversized" : {
                    "displayName" : "oversized",
                    "identifiesControllerService" : false,
                    "name" : "oversized",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "7b2f5ee0-079a-3ddb-93a9-1efe3f73f33b",
                "name" : "Log Kafka Publish Failed",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 6496.0,
                  "y" : 984.0
                },
                "properties" : {
                  "Log prefix" : "Interop FHIR Adapter - Kafa published failed for error message",
                  "character-set" : "UTF-8",
                  "Log Level" : "error",
                  "attributes-to-log-regex" : ".*",
                  "Log Payload" : "false"
                },
                "propertyDescriptors" : {
                  "Log prefix" : {
                    "displayName" : "Log prefix",
                    "identifiesControllerService" : false,
                    "name" : "Log prefix",
                    "sensitive" : false
                  },
                  "character-set" : {
                    "displayName" : "Character Set",
                    "identifiesControllerService" : false,
                    "name" : "character-set",
                    "sensitive" : false
                  },
                  "Log Level" : {
                    "displayName" : "Log Level",
                    "identifiesControllerService" : false,
                    "name" : "Log Level",
                    "sensitive" : false
                  },
                  "attributes-to-ignore-regex" : {
                    "displayName" : "Attributes to Ignore by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-ignore-regex",
                    "sensitive" : false
                  },
                  "Attributes to Ignore" : {
                    "displayName" : "Attributes to Ignore",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Ignore",
                    "sensitive" : false
                  },
                  "Attributes to Log" : {
                    "displayName" : "Attributes to Log",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Log",
                    "sensitive" : false
                  },
                  "attributes-to-log-regex" : {
                    "displayName" : "Attributes to Log by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-log-regex",
                    "sensitive" : false
                  },
                  "Log Payload" : {
                    "displayName" : "Log Payload",
                    "identifiesControllerService" : false,
                    "name" : "Log Payload",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.LogAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 3,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "80149fd4-9d6f-3d33-9689-9a972dab9d14",
                "name" : "Record was split into multiple pages?",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 5824.0,
                  "y" : 1400.0
                },
                "properties" : {
                  "Routing Strategy" : "Route to Property name",
                  "multi-page" : "${multipage:equals('true')}"
                },
                "propertyDescriptors" : {
                  "Routing Strategy" : {
                    "displayName" : "Routing Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Routing Strategy",
                    "sensitive" : false
                  },
                  "multi-page" : {
                    "displayName" : "multi-page",
                    "identifiesControllerService" : false,
                    "name" : "multi-page",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "original" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "c9bb8217-81db-3d31-9533-7f4e9ef274f3",
                "name" : "Merge pages together",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 5824.0,
                  "y" : 1688.0
                },
                "properties" : {
                  "Keep Path" : "false",
                  "Merge Strategy" : "Defragment",
                  "Attribute Strategy" : "Keep Only Common Attributes",
                  "Compression Level" : "1",
                  "Maximum Number of Entries" : "1000",
                  "Minimum Group Size" : "0 B",
                  "Maximum number of Bins" : "10000",
                  "Tar Modified Time" : "${file.lastModifiedTime}",
                  "Delimiter Strategy" : "Filename",
                  "Merge Format" : "FlowFile Stream, v3",
                  "Max Bin Age" : "10 minutes",
                  "Correlation Attribute Name" : "${fragment.identifier}",
                  "mergecontent-metadata-strategy" : "Do Not Merge Uncommon Metadata",
                  "Minimum Number of Entries" : "1"
                },
                "propertyDescriptors" : {
                  "Keep Path" : {
                    "displayName" : "Keep Path",
                    "identifiesControllerService" : false,
                    "name" : "Keep Path",
                    "sensitive" : false
                  },
                  "Maximum Group Size" : {
                    "displayName" : "Maximum Group Size",
                    "identifiesControllerService" : false,
                    "name" : "Maximum Group Size",
                    "sensitive" : false
                  },
                  "Merge Strategy" : {
                    "displayName" : "Merge Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Merge Strategy",
                    "sensitive" : false
                  },
                  "Attribute Strategy" : {
                    "displayName" : "Attribute Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Attribute Strategy",
                    "sensitive" : false
                  },
                  "Compression Level" : {
                    "displayName" : "Compression Level",
                    "identifiesControllerService" : false,
                    "name" : "Compression Level",
                    "sensitive" : false
                  },
                  "Maximum Number of Entries" : {
                    "displayName" : "Maximum Number of Entries",
                    "identifiesControllerService" : false,
                    "name" : "Maximum Number of Entries",
                    "sensitive" : false
                  },
                  "Minimum Group Size" : {
                    "displayName" : "Minimum Group Size",
                    "identifiesControllerService" : false,
                    "name" : "Minimum Group Size",
                    "sensitive" : false
                  },
                  "Maximum number of Bins" : {
                    "displayName" : "Maximum number of Bins",
                    "identifiesControllerService" : false,
                    "name" : "Maximum number of Bins",
                    "sensitive" : false
                  },
                  "Tar Modified Time" : {
                    "displayName" : "Tar Modified Time",
                    "identifiesControllerService" : false,
                    "name" : "Tar Modified Time",
                    "sensitive" : false
                  },
                  "Delimiter Strategy" : {
                    "displayName" : "Delimiter Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Delimiter Strategy",
                    "sensitive" : false
                  },
                  "Merge Format" : {
                    "displayName" : "Merge Format",
                    "identifiesControllerService" : false,
                    "name" : "Merge Format",
                    "sensitive" : false
                  },
                  "Footer File" : {
                    "displayName" : "Footer",
                    "identifiesControllerService" : false,
                    "name" : "Footer File",
                    "sensitive" : false
                  },
                  "Max Bin Age" : {
                    "displayName" : "Max Bin Age",
                    "identifiesControllerService" : false,
                    "name" : "Max Bin Age",
                    "sensitive" : false
                  },
                  "Demarcator File" : {
                    "displayName" : "Demarcator",
                    "identifiesControllerService" : false,
                    "name" : "Demarcator File",
                    "sensitive" : false
                  },
                  "Correlation Attribute Name" : {
                    "displayName" : "Correlation Attribute Name",
                    "identifiesControllerService" : false,
                    "name" : "Correlation Attribute Name",
                    "sensitive" : false
                  },
                  "Header File" : {
                    "displayName" : "Header",
                    "identifiesControllerService" : false,
                    "name" : "Header File",
                    "sensitive" : false
                  },
                  "mergecontent-metadata-strategy" : {
                    "displayName" : "Metadata Strategy",
                    "identifiesControllerService" : false,
                    "name" : "mergecontent-metadata-strategy",
                    "sensitive" : false
                  },
                  "Minimum Number of Entries" : {
                    "displayName" : "Minimum Number of Entries",
                    "identifiesControllerService" : false,
                    "name" : "Minimum Number of Entries",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.MergeContent",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-kafka-2-6-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 3,
                "executionNode" : "ALL",
                "groupIdentifier" : "eee82cb1-4814-3c9c-9d73-9e14c97c5ed9",
                "identifier" : "fdbb7df4-e57d-3011-9376-d6f15f65e68e",
                "name" : "Publish Error/Warning to Kafka",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 5824.0,
                  "y" : 1008.0
                },
                "properties" : {
                  "compression.type" : "none",
                  "attribute-name-regex" : "batchId",
                  "bootstrap.servers" : "#{kafka.brokers}",
                  "kafka-key" : "${messageBatchId}",
                  "sasl.mechanism" : "PLAIN",
                  "max.block.ms" : "5 sec",
                  "message-header-encoding" : "UTF-8",
                  "ack.wait.time" : "5 secs",
                  "sasl.username" : "#{kafka.auth.user}",
                  "use-transactions" : "true",
                  "acks" : "all",
                  "security.protocol" : "PLAINTEXT",
                  "max.request.size" : "1 MB",
                  "sasl.token.auth" : "false",
                  "partitioner.class" : "org.apache.kafka.clients.producer.internals.DefaultPartitioner",
                  "topic" : "${failureTopic}",
                  "sasl.password" : "#{kafka.auth.password}",
                  "key-attribute-encoding" : "utf-8"
                },
                "propertyDescriptors" : {
                  "compression.type" : {
                    "displayName" : "Compression Type",
                    "identifiesControllerService" : false,
                    "name" : "compression.type",
                    "sensitive" : false
                  },
                  "attribute-name-regex" : {
                    "displayName" : "Attributes to Send as Headers (Regex)",
                    "identifiesControllerService" : false,
                    "name" : "attribute-name-regex",
                    "sensitive" : false
                  },
                  "bootstrap.servers" : {
                    "displayName" : "Kafka Brokers",
                    "identifiesControllerService" : false,
                    "name" : "bootstrap.servers",
                    "sensitive" : false
                  },
                  "sasl.kerberos.principal" : {
                    "displayName" : "Kerberos Principal",
                    "identifiesControllerService" : false,
                    "name" : "sasl.kerberos.principal",
                    "sensitive" : false
                  },
                  "sasl.kerberos.service.name" : {
                    "displayName" : "Kerberos Service Name",
                    "identifiesControllerService" : false,
                    "name" : "sasl.kerberos.service.name",
                    "sensitive" : false
                  },
                  "kerberos-credentials-service" : {
                    "displayName" : "Kerberos Credentials Service",
                    "identifiesControllerService" : true,
                    "name" : "kerberos-credentials-service",
                    "sensitive" : false
                  },
                  "kafka-key" : {
                    "displayName" : "Kafka Key",
                    "identifiesControllerService" : false,
                    "name" : "kafka-key",
                    "sensitive" : false
                  },
                  "partition" : {
                    "displayName" : "Partition",
                    "identifiesControllerService" : false,
                    "name" : "partition",
                    "sensitive" : false
                  },
                  "sasl.mechanism" : {
                    "displayName" : "SASL Mechanism",
                    "identifiesControllerService" : false,
                    "name" : "sasl.mechanism",
                    "sensitive" : false
                  },
                  "max.block.ms" : {
                    "displayName" : "Max Metadata Wait Time",
                    "identifiesControllerService" : false,
                    "name" : "max.block.ms",
                    "sensitive" : false
                  },
                  "message-header-encoding" : {
                    "displayName" : "Message Header Encoding",
                    "identifiesControllerService" : false,
                    "name" : "message-header-encoding",
                    "sensitive" : false
                  },
                  "message-demarcator" : {
                    "displayName" : "Message Demarcator",
                    "identifiesControllerService" : false,
                    "name" : "message-demarcator",
                    "sensitive" : false
                  },
                  "transactional-id-prefix" : {
                    "displayName" : "Transactional Id Prefix",
                    "identifiesControllerService" : false,
                    "name" : "transactional-id-prefix",
                    "sensitive" : false
                  },
                  "ack.wait.time" : {
                    "displayName" : "Acknowledgment Wait Time",
                    "identifiesControllerService" : false,
                    "name" : "ack.wait.time",
                    "sensitive" : false
                  },
                  "sasl.username" : {
                    "displayName" : "Username",
                    "identifiesControllerService" : false,
                    "name" : "sasl.username",
                    "sensitive" : false
                  },
                  "use-transactions" : {
                    "displayName" : "Use Transactions",
                    "identifiesControllerService" : false,
                    "name" : "use-transactions",
                    "sensitive" : false
                  },
                  "acks" : {
                    "displayName" : "Delivery Guarantee",
                    "identifiesControllerService" : false,
                    "name" : "acks",
                    "sensitive" : false
                  },
                  "security.protocol" : {
                    "displayName" : "Security Protocol",
                    "identifiesControllerService" : false,
                    "name" : "security.protocol",
                    "sensitive" : false
                  },
                  "ssl.context.service" : {
                    "displayName" : "SSL Context Service",
                    "identifiesControllerService" : true,
                    "name" : "ssl.context.service",
                    "sensitive" : false
                  },
                  "max.request.size" : {
                    "displayName" : "Max Request Size",
                    "identifiesControllerService" : false,
                    "name" : "max.request.size",
                    "sensitive" : false
                  },
                  "sasl.token.auth" : {
                    "displayName" : "Token Auth",
                    "identifiesControllerService" : false,
                    "name" : "sasl.token.auth",
                    "sensitive" : false
                  },
                  "partitioner.class" : {
                    "displayName" : "Partitioner class",
                    "identifiesControllerService" : false,
                    "name" : "partitioner.class",
                    "sensitive" : false
                  },
                  "sasl.kerberos.keytab" : {
                    "displayName" : "Kerberos Keytab",
                    "identifiesControllerService" : false,
                    "name" : "sasl.kerberos.keytab",
                    "sensitive" : false
                  },
                  "topic" : {
                    "displayName" : "Topic Name",
                    "identifiesControllerService" : false,
                    "name" : "topic",
                    "sensitive" : false
                  },
                  "sasl.password" : {
                    "displayName" : "Password",
                    "identifiesControllerService" : false,
                    "name" : "sasl.password",
                    "sensitive" : true
                  },
                  "key-attribute-encoding" : {
                    "displayName" : "Key Attribute Encoding",
                    "identifiesControllerService" : false,
                    "name" : "key-attribute-encoding",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.kafka.pubsub.PublishKafka_2_6",
                "yieldDuration" : "1 sec"
              } ],
              "remoteProcessGroups" : [ ],
              "variables" : { }
            } ],
            "processors" : [ {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-scripting-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "2a420eec-49c4-339c-b29d-46e1980f10a7",
              "name" : "Strip Information Messages",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : -80.0,
                "y" : 1240.0
              },
              "properties" : {
                "Script Engine" : "Groovy",
                "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Strip Information Messages\" processor in \"Send to FHIR and Post Errors\" >> \"Build and Post Error Messages\"\n *\n * Removes any informational messages that are returned from the FHIR server for this FHIR resource.\n * If there are no other messages remaining, the flow file is cleared out so no message is posted on the error topic.\n */\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null)\n    return\n\nfor (FlowFile aFlowFile : flowFiles) {\n    try {\n        aFlowFile = session.write(aFlowFile, new StreamCallback() {\n            @Override\n            void process(InputStream instream,  OutputStream outstream) throws IOException {\n                String inputText = instream.getText()\n\n                if (inputText != null && !inputText.isEmpty()) {\n                    def jsonSlurper = new JsonSlurper()\n                    Map inputJson = jsonSlurper.parseText(inputText)\n\n                    boolean clear = false\n\n                    String resourceType = inputJson.getAt(\"resourceType\")\n\n                    if (resourceType != null) {\n                        if (resourceType.equals(\"OperationOutcome\")) {\n                            // OO resource handling\n                            // Keep only issues that are not informational\n                            ArrayList issues = inputJson.getAt(\"issue\")\n                            if (issues != null) {\n                                def newIssues = []\n                                for (Map anIssue : issues) {\n                                    String severity = anIssue.getAt(\"severity\")\n                                    if (severity != null && !severity.equals(\"information\")) {\n                                       newIssues.add(anIssue)\n                                    }\n                                }\n\n                                // If there are no messages left, set to flag to clear everything.\n                                if (newIssues.isEmpty())\n                                    clear = true\n                                else\n                                    inputJson.putAt(\"issue\", newIssues)\n                            } // If it is an OO, we will always expect an issues array (required in FHIR)\n                        } else if (resourceType.equals(\"Bundle\")) {\n                            // Bundle handling\n                            ArrayList entries = inputJson.getAt(\"entry\")\n\n                            if (entries != null) {\n                                ArrayList newEntries = []\n                                for (Map anEntry : entries) {\n                                    boolean keepEntry = true\n                                    Map resource = anEntry.getAt(\"resource\")\n\n                                    // Check if the resource has any informational messages\n                                    if (resource != null) {\n                                        String entryResourceType = resource.getAt(\"resourceType\")\n                                        if (entryResourceType != null && entryResourceType.equals(\"OperationOutcome\")) {\n                                            ArrayList issues = resource.getAt(\"issue\")\n\n                                            if (issues != null) {\n                                                ArrayList newIssues = []\n                                                for (Map anIssue : issues) {\n                                                    String severity = anIssue.getAt(\"severity\")\n                                                    if (severity != null && !severity.equals(\"information\"))\n                                                        newIssues.add(anIssue)\n                                                }\n                                            \n                                                // If there are issues left set to flag to keep the entry, otherwise remove the resource\n                                                if (!newIssues.isEmpty()) {\n                                                    resource.putAt(\"issue\", newIssues)\n                                                    keepEntry = true\n                                                } else {\n                                                    keepEntry = false\n                                                    anEntry.remove(\"resource\")\n                                                }\n                                             } // If it is an OO, we will always expect an issues array (required in FHIR)\n                                        }\n                                    } else {\n                                        // If there is no resource, allow the entry to be deleted if response only has info messages\n                                        keepEntry = false\n                                    }\n                                    \n                                    // check the response for OO\n                                    Map response = anEntry.getAt(\"response\")\n                                    if (response != null) {\n                                        Map outcome = response.getAt(\"outcome\")\n                                        if (outcome != null) {\n                                            String entryResourceType = outcome.getAt(\"resourceType\")\n                                                if (entryResourceType != null && entryResourceType.equals(\"OperationOutcome\")) {\n                                                    ArrayList issues = outcome.getAt(\"issue\")\n\n                                                    if (issues != null) {\n                                                        ArrayList newIssues = []\n                                                        for (Map anIssue : issues) {\n                                                            String severity = anIssue.getAt(\"severity\")\n                                                        if (severity != null && !severity.equals(\"information\"))\n                                                            newIssues.add(anIssue)\n                                                    }\n\n                                                    // If there are issues left set to flag to keep entry.\n                                                    if (!newIssues.isEmpty()) {\n                                                        outcome.putAt(\"issue\", newIssues)\n                                                        keepEntry = true\n                                                    } else {\n                                                        // Leave the flag alone since the resource will determine whether to keep at this point.\n                                                        // Remove the outcome\n                                                        response.remove(\"outcome\")\n                                                    }\n                                                } // If it is an OO, we will always expect an issues array (required in FHIR)\n                                            }\n                                        }\n                                    }\n\n                                    if (keepEntry)\n                                        newEntries.add(anEntry)\n                                } // end loop of entries\n\n                                if (newEntries.isEmpty())\n                                    clear = true\n                                else\n                                    inputJson.putAt(\"entry\", newEntries)\n                            } // end if entries != null\n                        } // end if bundle\n                    } // end if resource type != null\n\n                    // Write out the flowfile contents.\n                    if (clear) {\n                        outstream.write(\"\".getBytes(StandardCharsets.UTF_8))\n                    } else {\n                        outstream.write( JsonOutput.toJson(inputJson).getBytes(StandardCharsets.UTF_8))\n                    }\n                }\n            }\n        })\n\n        aFlowFile = session.putAttribute(aFlowFile, \"Content-Length\", \"\" + aFlowFile.getSize())\n        session.transfer(aFlowFile, REL_SUCCESS)\n    } catch (Exception e) {\n        log.error('Exception stripping informational messages in flowfile with UUID {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n        session.transfer(aFlowFile, REL_FAILURE)\n    }\n}\n"
              },
              "propertyDescriptors" : {
                "Script File" : {
                  "displayName" : "Script File",
                  "identifiesControllerService" : false,
                  "name" : "Script File",
                  "sensitive" : false
                },
                "Script Engine" : {
                  "displayName" : "Script Engine",
                  "identifiesControllerService" : false,
                  "name" : "Script Engine",
                  "sensitive" : false
                },
                "Script Body" : {
                  "displayName" : "Script Body",
                  "identifiesControllerService" : false,
                  "name" : "Script Body",
                  "sensitive" : false
                },
                "Module Directory" : {
                  "displayName" : "Module Directory",
                  "identifiesControllerService" : false,
                  "name" : "Module Directory",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.script.ExecuteScript",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-standard-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 3,
              "executionNode" : "ALL",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "227660fd-6d3d-3d95-ad93-ef75ec4a71b1",
              "name" : "ContentEmpty and not Failure?",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : -84.09903875036514,
                "y" : 1473.144754828182
              },
              "properties" : {
                "Routing Strategy" : "Route to Property name",
                "contentEmpty" : "${Content-Length:equals(0):and(\n    ${resourceSavedStatus:equals(\"failure\"):not()}\n)}"
              },
              "propertyDescriptors" : {
                "Routing Strategy" : {
                  "displayName" : "Routing Strategy",
                  "identifiesControllerService" : false,
                  "name" : "Routing Strategy",
                  "sensitive" : false
                },
                "contentEmpty" : {
                  "displayName" : "contentEmpty",
                  "identifiesControllerService" : false,
                  "name" : "contentEmpty",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-scripting-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "bbeb0c67-74f3-3035-8dda-5adb0db657d4",
              "identifier" : "655a8361-71ee-31f3-80da-f4cb762a87a3",
              "name" : "Build Error Message",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 536.0,
                "y" : 1496.0
              },
              "properties" : {
                "Script Engine" : "Groovy",
                "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Build Error Message\" processor in \"Send to FHIR and Post Errors\" >> \"Build and Post Error Messages\"\n *\n * 1. Generates the json to post to the HRI error topic that includes details of the batch resource and error/warning messages.\n * 2. Sets the batchId attribute from messageBatchId (messageBatchId must be set)\n * \n */\n\n/**\n * Class that handles generating the error message payload\n */\nclass GroovyStreamCallback implements StreamCallback {\n    private FlowFile theFlowFile = null;\n\n    public GroovyStreamCallback(FlowFile theFlowFile) {\n        super();\n        this.theFlowFile = theFlowFile;\n    }\n\n    @Override\n    void process(InputStream instream, OutputStream outstream) throws IOException {\n        def outputErrorMessage = [:]\n\n        // Source Batch Id\n        def sourceBatchId = this.theFlowFile.getAttribute(\"sourceBatchId\")\n        if (sourceBatchId)\n            outputErrorMessage.putAt(\"sourceBatchId\", sourceBatchId)\n\n        // Notification Batch Id\n        def notificationBatchId = this.theFlowFile.getAttribute(\"messageBatchId\")\n        if (notificationBatchId)\n            outputErrorMessage.putAt(\"notificationBatchId\", notificationBatchId)\n\n        // Batch Name\n        def batchName = this.theFlowFile.getAttribute(\"batchName\")\n        if (batchName)\n            outputErrorMessage.putAt(\"name\", batchName)\n\n        // DataType\n        def dataType = this.theFlowFile.getAttribute(\"dataType\")\n        if (dataType)\n            outputErrorMessage.putAt(\"dataType\", dataType)\n\n        // FHIR Resource id\n        def fhirResourceId = this.theFlowFile.getAttribute(\"resourceId\")\n        if (fhirResourceId)\n            outputErrorMessage.putAt(\"fhirResourceId\", fhirResourceId)\n\n        // FHIR Resource Type\n        def fhirResourceType = this.theFlowFile.getAttribute(\"resourceType\")\n        if (fhirResourceType)\n            outputErrorMessage.putAt(\"fhirResourceType\", fhirResourceType)\n\n        // Bundle Resource id\n        def bundleResourceId = this.theFlowFile.getAttribute(\"bundleId\")\n        if (bundleResourceId)\n            outputErrorMessage.putAt(\"bundleResourceId\", bundleResourceId)\n\n        // Bundle Entry Index\n        def bundleEntryIndex = this.theFlowFile.getAttribute(\"bundleEntryIndex\")\n        if (bundleEntryIndex)\n            outputErrorMessage.putAt(\"bundleEntryIndex\", bundleEntryIndex)\n\n        // Adapter name\n        outputErrorMessage.putAt(\"adapterName\", \"Interop FHIR Adapter\")\n\n        // FHIR Resource Tag\n        def fhirResourceTag = this.theFlowFile.getAttribute(\"FHIRResourceTag\")\n        if (fhirResourceTag)\n            outputErrorMessage.putAt(\"fhirResourceTag\", fhirResourceTag)\n\n        // Status Code\n        def statusCode = this.theFlowFile.getAttribute(\"invokehttp.status.code\")\n        if (statusCode)\n            outputErrorMessage.putAt(\"statusCode\", statusCode)\n\n        // Status Message\n        def statusMessage = this.theFlowFile.getAttribute(\"invokehttp.status.message\")\n        if (statusMessage)\n            outputErrorMessage.putAt(\"statusMessage\", statusMessage)\n\n        // Add the Error details if any\n        def inputText = instream.getText()\n        if (inputText) {\n            def jsonSlurper = new JsonSlurper()\n            def inputJson = jsonSlurper.parseText(inputText)\n\n            outputErrorMessage.putAt(\"errorDetails\", inputJson)\n        }\n\n        outstream.write( JsonOutput.toJson(outputErrorMessage).getBytes(StandardCharsets.UTF_8))\n    }\n}\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null) {\n    return\n}\n\nfor (FlowFile aFlowFile : flowFiles) {\n    try {\n        // Validate required attributes are set\n        String messageBatchId = aFlowFile.getAttribute(\"messageBatchId\")\n        if (!messageBatchId) {\n            log.error('Interop FHIR Adapter - messageBatchId attribute not set on flowfile: ResourceType: {}, ResourceId: {}',\n                              [aFlowFile.getAttribute(\"resourceType\"), aFlowFile.getAttribute(\"resourceId\")] as Object[])\n            log.error('Interop FHIR Adapter - missing attribute flowfile details: {}', [JsonOutput.prettyPrint(JsonOutput.toJson(aFlowFile.getAttributes()))] as Object[])\n            session.transfer(aFlowFile, REL_FAILURE)\n            continue\n        }\n        \n        aFlowFile = session.write(aFlowFile, new GroovyStreamCallback(aFlowFile))\n        aFlowFile = session.putAttribute(aFlowFile, \"mime.type\", \"application/json\")\n        \n        // Set the batchId attribute from the messageBatchId\n        aFlowFile = session.putAttribute(aFlowFile, \"batchId\", messageBatchId)\n        \n        session.transfer(aFlowFile, REL_SUCCESS)\n    } catch (Exception e) {\n        log.error('Interop FHIR Adapter - Exception generating error topic message for ResourceType: {}, ResourceId: {}', \n                  [aFlowFile.getAttribute(\"resourceType\"), aFlowFile.getAttribute(\"resourceId\")] as Object[],\n                  e)\n        log.error('Interop FHIR Adapter - Error Flowfile details: {}', [JsonOutput.prettyPrint(JsonOutput.toJson(aFlowFile.getAttributes()))] as Object[])\n        session.transfer(aFlowFile, REL_FAILURE)\n    }\n}\n"
              },
              "propertyDescriptors" : {
                "Script File" : {
                  "displayName" : "Script File",
                  "identifiesControllerService" : false,
                  "name" : "Script File",
                  "sensitive" : false
                },
                "Script Engine" : {
                  "displayName" : "Script Engine",
                  "identifiesControllerService" : false,
                  "name" : "Script Engine",
                  "sensitive" : false
                },
                "Script Body" : {
                  "displayName" : "Script Body",
                  "identifiesControllerService" : false,
                  "name" : "Script Body",
                  "sensitive" : false
                },
                "Module Directory" : {
                  "displayName" : "Module Directory",
                  "identifiesControllerService" : false,
                  "name" : "Module Directory",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.script.ExecuteScript",
              "yieldDuration" : "1 sec"
            } ],
            "remoteProcessGroups" : [ ],
            "variables" : { }
          }, {
            "comments" : "",
            "componentType" : "PROCESS_GROUP",
            "connections" : [ {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "2ec0b632-1547-3792-9b05-7a6d1089b37f",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "cbc78561-a29b-3351-ab7b-16cfe7304e94",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "success" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "b38bc6e1-0fa0-38cd-8124-a3e07043a238",
                "name" : "Determine Overall Status",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "2ec0b632-1547-3792-9b05-7a6d1089b37f",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "4c71ba14-58b4-3f5a-9cc6-755077e10c8f",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "unmatched" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "10ce4154-3304-329e-987c-8678f0737ec8",
                "name" : "If from split bundle",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "2ec0b632-1547-3792-9b05-7a6d1089b37f",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "c6b22c05-8fb0-3ade-8bbd-420af5900641",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "5c2ccebf-efac-38f4-a841-1b1464f4b623",
                "name" : "Merge the bundle entries attributes",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "8163d4ad-47bd-309f-97aa-8b33a83e8a7a",
                "name" : "Failure",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "4feff021-5dca-3cc3-b702-b69c0c3314cc",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "b38bc6e1-0fa0-38cd-8124-a3e07043a238",
                "name" : "Determine Overall Status",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "b38bc6e1-0fa0-38cd-8124-a3e07043a238",
                "name" : "Determine Overall Status",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "71254635-6e64-3147-a2cf-67168469ed4d",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "merged" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "5c2ccebf-efac-38f4-a841-1b1464f4b623",
                "name" : "Merge the bundle entries attributes",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "10ce4154-3304-329e-987c-8678f0737ec8",
                "name" : "If from split bundle",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "7ee5ffeb-dfa1-3a76-baff-724577df8239",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "8099028e-aedc-3a68-8713-23f0988f35f3",
                "name" : "Input",
                "type" : "INPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "5c2ccebf-efac-38f4-a841-1b1464f4b623",
                "name" : "Merge the bundle entries attributes",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "29c47e28-6d59-37de-aaed-7aa57da88a57",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "PARTITION_BY_ATTRIBUTE",
              "name" : "",
              "partitioningAttribute" : "fragment.identifier",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure", "success" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "f7409771-4ea3-34b1-aa8f-6c3190be6c0c",
                "name" : "Put All Attributes in Content",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "f7409771-4ea3-34b1-aa8f-6c3190be6c0c",
                "name" : "Put All Attributes in Content",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "11deb9ac-0639-3326-9034-fac90fab4f17",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "bundleWasSplit" ],
              "source" : {
                "comments" : "",
                "groupId" : "924fd4bf-f6d1-385b-8195-274a693ae866",
                "id" : "10ce4154-3304-329e-987c-8678f0737ec8",
                "name" : "If from split bundle",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            } ],
            "controllerServices" : [ ],
            "flowFileConcurrency" : "UNBOUNDED",
            "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
            "funnels" : [ ],
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
            "inputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "INPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "8099028e-aedc-3a68-8713-23f0988f35f3",
              "name" : "Input",
              "position" : {
                "x" : 1448.0,
                "y" : 1032.0
              },
              "type" : "INPUT_PORT"
            } ],
            "labels" : [ ],
            "name" : "Merge if split from bundle",
            "outputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "OUTPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "2ec0b632-1547-3792-9b05-7a6d1089b37f",
              "name" : "Output",
              "position" : {
                "x" : 2184.0,
                "y" : 1800.0
              },
              "type" : "OUTPUT_PORT"
            }, {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "OUTPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "8163d4ad-47bd-309f-97aa-8b33a83e8a7a",
              "name" : "Failure",
              "position" : {
                "x" : 2160.0,
                "y" : 2304.0
              },
              "type" : "OUTPUT_PORT"
            } ],
            "position" : {
              "x" : 1248.0,
              "y" : 1904.0
            },
            "processGroups" : [ ],
            "processors" : [ {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-scripting-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "b38bc6e1-0fa0-38cd-8124-a3e07043a238",
              "name" : "Determine Overall Status",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 1392.0,
                "y" : 2264.0
              },
              "properties" : {
                "Script Engine" : "Groovy",
                "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.logging.ComponentLog\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.InputStreamCallback\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Determine Overall Status\" processor in \"Send to FHIR and Post Errors\" >> \"Determine Overall Status\" >> \"Merge if split from bundle\"\n *\n * Reads the array of attributes in the content to determine the overall FHIR storage status of a bundle\n * in the event a bundle failed to persist as whole and attempted to store each entry into FHIR.\n *\n * The overall status will be set in the resourceSavedStatus attribute.\n * Sets the hri.ingest.record.progress attribute to SUCCESS, WARNING, ERROR, or ABORT\n * Sets the resourceSavedStatus attribute to success, warning, failure, aborted\n *\n * The status will take precedence in the following order:\n * Aborted\n * Failure\n * Warning\n * Success\n *\n */\nclass DetermineBundleStatusClass extends AbstractProcessor {\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n    .name(\"success\")\n    .description(\"Status was determined\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"Status not able to be determined, the FlowFile will be penalized and routed to this relationship\")\n    .build()\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_SUCCESS, REL_FAILURE] as Set\n    }\n\n    public enum Status {\n        SUCCESS(\"success\", 0),\n        WARNING(\"warning\", 1),\n        FAILURE(\"failure\", 2),\n        ABORTED(\"aborted\", 3)\n\n        private String value = null\n        private int rank = 0\n\n        Status(String value, int rank) {\n            this.value = value\n            this.rank = rank\n        }\n\n        public String value() {\n            return value\n        }\n\n        public int rank() {\n            return rank\n        }\n\n        public static Status fromValue(String value) {\n            for (Status entryType : Status.values()) {\n                if (entryType.value.equalsIgnoreCase(value)) {\n                    return entryType\n                }\n            }\n            throw new IllegalArgumentException(\"No constant with value \" + value + \" found.\")\n        }\n\n        public Status returnHigher(Status otherStatus) {\n            if (otherStatus == null)\n                return this\n\n            if (otherStatus.rank() >= rank())\n                return otherStatus\n            else\n                return this\n        }\n\n        public String toString() {\n            return value;\n        }\n    }\n\n\n    /**\n     * Class that determines the overall status\n     */\n    public class BundleStatusStreamCallback extends InputStreamCallback {\n        private FlowFile theFlowFile = null\n        private Status status = null\n\n        public BundleStatusStreamCallback(FlowFile theFlowFile) {\n            super();\n            this.theFlowFile = theFlowFile\n        }\n\n        public Status getStatus() {\n            return this.status\n        }\n\n        @Override\n        void process(InputStream instream) throws IOException {\n            def jsonSlurper = new JsonSlurper()\n            ArrayList jsonArray = jsonSlurper.parse(instream, \"UTF-8\")\n\n            // Iterate through the array to determine overall status\n            for (Map flowFileAttributes : jsonArray) {\n                String resourceSavedStatus = flowFileAttributes.getAt(\"resourceSavedStatus\")\n                if (resourceSavedStatus != null) {\n                    Status storageResult = Status.fromValue(resourceSavedStatus)\n                    if (storageResult != null) {\n                        this.status = storageResult.returnHigher(this.status)\n                    }\n\n                    if (this.status == Status.ABORTED)\n                        return\n                } else {\n                    getLogger().warn('FHIR storage status not found for {} resource with id {}', [flowFileAttributes.getAt(\"resourceType\"), flowFileAttributes.getAt(\"resourceId\")] as Object[])\n                }\n            }\n        }\n\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        List<FlowFile> flowFiles = session.get(100)\n        if (flowFiles == null) {\n            return\n        }\n\n        for (FlowFile aFlowFile : flowFiles) {\n            try {\n                BundleStatusStreamCallback callBack =  new BundleStatusStreamCallback(aFlowFile)\n                session.read(aFlowFile, callBack)\n                Status overallStatus = callBack.getStatus()\n                if (overallStatus != null) {\n                    session.putAttribute(aFlowFile, \"resourceSavedStatus\", overallStatus.toString())\n\n                    String hriStatus = null;\n                    if (overallStatus == Status.FAILURE)\n                        hriStatus = \"ERROR\"\n                    else if (overallStatus == Status.ABORTED)\n                        hriStatus = \"ABORT\"\n                    else\n                        hriStatus = overallStatus.toString().toUpperCase()\n                       \n                    session.putAttribute(aFlowFile, \"hri.ingest.record.progress\", hriStatus)\n                        \n                    session.transfer(aFlowFile, REL_SUCCESS)\n                } else {\n                    getLogger().error('Unable to determine overall bundle status in flowfile with UUID: {}', [aFlowFile.getAttribute(\"uuid\")] as Object[])\n                    session.transfer(aFlowFile, REL_FAILURE)\n                }\n            } catch (Exception e) {\n                getLogger().error('Exception determining overall bundle status in flowfile with UUID: {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n                session.transfer(aFlowFile, REL_FAILURE)\n            }\n        }\n    }\n}\n\nprocessor = new DetermineBundleStatusClass()\n"
              },
              "propertyDescriptors" : {
                "Script File" : {
                  "displayName" : "Script File",
                  "identifiesControllerService" : false,
                  "name" : "Script File",
                  "sensitive" : false
                },
                "Script Engine" : {
                  "displayName" : "Script Engine",
                  "identifiesControllerService" : false,
                  "name" : "Script Engine",
                  "sensitive" : false
                },
                "Script Body" : {
                  "displayName" : "Script Body",
                  "identifiesControllerService" : false,
                  "name" : "Script Body",
                  "sensitive" : false
                },
                "Module Directory" : {
                  "displayName" : "Module Directory",
                  "identifiesControllerService" : false,
                  "name" : "Module Directory",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ "original" ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-standard-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "5c2ccebf-efac-38f4-a841-1b1464f4b623",
              "name" : "Merge the bundle entries attributes",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 1392.0,
                "y" : 1936.0
              },
              "properties" : {
                "Keep Path" : "false",
                "Merge Strategy" : "Defragment",
                "Attribute Strategy" : "Keep All Unique Attributes",
                "Compression Level" : "1",
                "Maximum Number of Entries" : "400",
                "Minimum Group Size" : "0 B",
                "Maximum number of Bins" : "10000",
                "Tar Modified Time" : "${file.lastModifiedTime}",
                "Delimiter Strategy" : "Text",
                "Merge Format" : "Binary Concatenation",
                "Footer File" : "]",
                "Max Bin Age" : "10 minutes",
                "Demarcator File" : ",",
                "Header File" : "[",
                "mergecontent-metadata-strategy" : "Do Not Merge Uncommon Metadata",
                "Minimum Number of Entries" : "1"
              },
              "propertyDescriptors" : {
                "Keep Path" : {
                  "displayName" : "Keep Path",
                  "identifiesControllerService" : false,
                  "name" : "Keep Path",
                  "sensitive" : false
                },
                "Maximum Group Size" : {
                  "displayName" : "Maximum Group Size",
                  "identifiesControllerService" : false,
                  "name" : "Maximum Group Size",
                  "sensitive" : false
                },
                "Merge Strategy" : {
                  "displayName" : "Merge Strategy",
                  "identifiesControllerService" : false,
                  "name" : "Merge Strategy",
                  "sensitive" : false
                },
                "Attribute Strategy" : {
                  "displayName" : "Attribute Strategy",
                  "identifiesControllerService" : false,
                  "name" : "Attribute Strategy",
                  "sensitive" : false
                },
                "Compression Level" : {
                  "displayName" : "Compression Level",
                  "identifiesControllerService" : false,
                  "name" : "Compression Level",
                  "sensitive" : false
                },
                "Maximum Number of Entries" : {
                  "displayName" : "Maximum Number of Entries",
                  "identifiesControllerService" : false,
                  "name" : "Maximum Number of Entries",
                  "sensitive" : false
                },
                "Minimum Group Size" : {
                  "displayName" : "Minimum Group Size",
                  "identifiesControllerService" : false,
                  "name" : "Minimum Group Size",
                  "sensitive" : false
                },
                "Maximum number of Bins" : {
                  "displayName" : "Maximum number of Bins",
                  "identifiesControllerService" : false,
                  "name" : "Maximum number of Bins",
                  "sensitive" : false
                },
                "Tar Modified Time" : {
                  "displayName" : "Tar Modified Time",
                  "identifiesControllerService" : false,
                  "name" : "Tar Modified Time",
                  "sensitive" : false
                },
                "Delimiter Strategy" : {
                  "displayName" : "Delimiter Strategy",
                  "identifiesControllerService" : false,
                  "name" : "Delimiter Strategy",
                  "sensitive" : false
                },
                "Merge Format" : {
                  "displayName" : "Merge Format",
                  "identifiesControllerService" : false,
                  "name" : "Merge Format",
                  "sensitive" : false
                },
                "Footer File" : {
                  "displayName" : "Footer",
                  "identifiesControllerService" : false,
                  "name" : "Footer File",
                  "sensitive" : false
                },
                "Max Bin Age" : {
                  "displayName" : "Max Bin Age",
                  "identifiesControllerService" : false,
                  "name" : "Max Bin Age",
                  "sensitive" : false
                },
                "Demarcator File" : {
                  "displayName" : "Demarcator",
                  "identifiesControllerService" : false,
                  "name" : "Demarcator File",
                  "sensitive" : false
                },
                "Correlation Attribute Name" : {
                  "displayName" : "Correlation Attribute Name",
                  "identifiesControllerService" : false,
                  "name" : "Correlation Attribute Name",
                  "sensitive" : false
                },
                "Header File" : {
                  "displayName" : "Header",
                  "identifiesControllerService" : false,
                  "name" : "Header File",
                  "sensitive" : false
                },
                "mergecontent-metadata-strategy" : {
                  "displayName" : "Metadata Strategy",
                  "identifiesControllerService" : false,
                  "name" : "mergecontent-metadata-strategy",
                  "sensitive" : false
                },
                "Minimum Number of Entries" : {
                  "displayName" : "Minimum Number of Entries",
                  "identifiesControllerService" : false,
                  "name" : "Minimum Number of Entries",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.standard.MergeContent",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-standard-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 3,
              "executionNode" : "ALL",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "10ce4154-3304-329e-987c-8678f0737ec8",
              "name" : "If from split bundle",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 1392.0,
                "y" : 1280.0
              },
              "properties" : {
                "Routing Strategy" : "Route to Property name",
                "bundleWasSplit" : "${bundleWasSplit:equals(\"true\")}"
              },
              "propertyDescriptors" : {
                "Routing Strategy" : {
                  "displayName" : "Routing Strategy",
                  "identifiesControllerService" : false,
                  "name" : "Routing Strategy",
                  "sensitive" : false
                },
                "bundleWasSplit" : {
                  "displayName" : "bundleWasSplit",
                  "identifiesControllerService" : false,
                  "name" : "bundleWasSplit",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-standard-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "924fd4bf-f6d1-385b-8195-274a693ae866",
              "identifier" : "f7409771-4ea3-34b1-aa8f-6c3190be6c0c",
              "name" : "Put All Attributes in Content",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 1392.0,
                "y" : 1624.0
              },
              "properties" : {
                "Destination" : "flowfile-content",
                "Null Value" : "false",
                "Include Core Attributes" : "true"
              },
              "propertyDescriptors" : {
                "attributes-to-json-regex" : {
                  "displayName" : "Attributes Regular Expression",
                  "identifiesControllerService" : false,
                  "name" : "attributes-to-json-regex",
                  "sensitive" : false
                },
                "Destination" : {
                  "displayName" : "Destination",
                  "identifiesControllerService" : false,
                  "name" : "Destination",
                  "sensitive" : false
                },
                "Null Value" : {
                  "displayName" : "Null Value",
                  "identifiesControllerService" : false,
                  "name" : "Null Value",
                  "sensitive" : false
                },
                "Attributes List" : {
                  "displayName" : "Attributes List",
                  "identifiesControllerService" : false,
                  "name" : "Attributes List",
                  "sensitive" : false
                },
                "Include Core Attributes" : {
                  "displayName" : "Include Core Attributes",
                  "identifiesControllerService" : false,
                  "name" : "Include Core Attributes",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.standard.AttributesToJSON",
              "yieldDuration" : "1 sec"
            } ],
            "remoteProcessGroups" : [ ],
            "variables" : { }
          }, {
            "comments" : "",
            "componentType" : "PROCESS_GROUP",
            "connections" : [ {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "Failure relationship not used in script",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "36e3cec3-aaf2-3d50-968e-7e3204b62a26",
                "name" : "Handle Post FHIR Results",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "72ef2169-e42a-3b50-a553-7984654134dd",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "id" : "ae812c70-d7cf-3d6e-915c-1cb07aa2b2ca",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ {
                "x" : 3216.0,
                "y" : -200.0
              }, {
                "x" : 3224.0,
                "y" : 1120.0
              } ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f59cb438-fed1-37e7-b47c-5060c1bd0a2f",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "641c9932-7fe8-3e8a-bc13-ee2b7816abc0",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "failure" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "e7a47b68-f929-3e5d-b64a-46c95daec4ba",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "31c5e395-d024-3a33-bf3a-da87e1cf8d24",
                "name" : "FHIR Resource",
                "type" : "INPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f59cb438-fed1-37e7-b47c-5060c1bd0a2f",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "f655c95b-c17b-31cf-afc6-ea4a1a2ee525",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "success" ],
              "source" : {
                "comments" : "Failure relationship not used in script",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "36e3cec3-aaf2-3d50-968e-7e3204b62a26",
                "name" : "Handle Post FHIR Results",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "id" : "ef9c7dbc-e05a-3b42-a60b-a7316f06721f",
                "name" : "Input",
                "type" : "INPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "338abb4b-049e-32da-b24d-09f2e04ed662",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "id" : "23b5021b-6272-3ff7-9536-e90450046bd5",
                "name" : "retry",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "83d6b644-6f5a-3f4e-beff-5abba4943797",
                "name" : "Turn Off AutoBundle",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "ee1553e8-172a-3d49-9502-e543569c847e",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "id" : "5a25fc73-7553-3b7c-ac9c-308ec557c159",
                "name" : "Split",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "id" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                "name" : "Input Bundle",
                "type" : "INPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "589a6697-1cb5-323f-8dd2-d408be711ffa",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "bundle" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "060c7afa-913f-3e05-9ad9-fe90177c35a9",
                "name" : "Aborted",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "b8829046-5ad4-39c2-ab3c-95d153014dfd",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "id" : "2b717038-ca6e-3af3-b5f4-f3087a28039a",
                "name" : "Aborted",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "id" : "09547305-abe6-3fae-b2e1-252b8ab41c00",
                "name" : "input",
                "type" : "INPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "6a4dc605-26dd-32ea-a8fa-70b427c9497d",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "auto bundle" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "060c7afa-913f-3e05-9ad9-fe90177c35a9",
                "name" : "Aborted",
                "type" : "OUTPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "995764b9-0dc1-33ca-bfaf-dc903cc09c77",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "id" : "84bb932b-31e1-3b4d-b66f-33992802c9dc",
                "name" : "Aborted",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "Failure relationship not used in script",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "36e3cec3-aaf2-3d50-968e-7e3204b62a26",
                "name" : "Handle Post FHIR Results",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "76850e65-2ff7-3cb5-bc9b-bd743ba7b87e",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "id" : "235a93e2-19c5-3be4-814a-1dde89739885",
                "name" : "success",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "id" : "ef9c7dbc-e05a-3b42-a60b-a7316f06721f",
                "name" : "Input",
                "type" : "INPUT_PORT"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "51b52a67-3aaf-3294-9543-d59c83fef83d",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "FHIR resource" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "f163d4e9-3724-341a-9613-7cc565a21b25",
                "name" : "Pre-Process FHIR Resource",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "ae890885-6487-3317-8607-e0eeb8a1ee1b",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "success" ],
              "source" : {
                "comments" : "",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "83d6b644-6f5a-3f4e-beff-5abba4943797",
                "name" : "Turn Off AutoBundle",
                "type" : "PROCESSOR"
              },
              "zIndex" : 0
            }, {
              "backPressureDataSizeThreshold" : "1 GB",
              "backPressureObjectThreshold" : 10000,
              "bends" : [ {
                "x" : 1528.0,
                "y" : 824.0
              } ],
              "componentType" : "CONNECTION",
              "destination" : {
                "comments" : "Failure relationship not used in script",
                "groupId" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
                "id" : "36e3cec3-aaf2-3d50-968e-7e3204b62a26",
                "name" : "Handle Post FHIR Results",
                "type" : "PROCESSOR"
              },
              "flowFileExpiration" : "0 sec",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "38f135c1-5386-3ee7-937c-aff039fcf241",
              "labelIndex" : 1,
              "loadBalanceCompression" : "DO_NOT_COMPRESS",
              "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
              "name" : "",
              "partitioningAttribute" : "",
              "prioritizers" : [ ],
              "selectedRelationships" : [ "" ],
              "source" : {
                "comments" : "",
                "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                "name" : "Output",
                "type" : "OUTPUT_PORT"
              },
              "zIndex" : 0
            } ],
            "controllerServices" : [ ],
            "flowFileConcurrency" : "UNBOUNDED",
            "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
            "funnels" : [ ],
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
            "inputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "INPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "31c5e395-d024-3a33-bf3a-da87e1cf8d24",
              "name" : "FHIR Resource",
              "position" : {
                "x" : 2120.0,
                "y" : -544.0
              },
              "type" : "INPUT_PORT"
            } ],
            "labels" : [ {
              "componentType" : "LABEL",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "height" : 192.0,
              "identifier" : "132db3ea-b194-387e-8da9-d70e699d9690",
              "label" : "1. Sets the ResourceType and Resource ID attributes from the json in the content. Error if not found.\n2. Will send to bundle relationship if it is a bundle resource type\n3. Will send to FHIR resource relationship if it is not a bundle and autobundle is disabled.\n4. Will send to Auto Bundle relationship if it is not a bundle and autobundle is enabled.\n5. Will send to failure relationship if content has invalid json with:\n        invokehttp.status.code = 400\n        invokehttp.status.message = \"Invalid JSON\"\n        hri.ingest.record.progress = ERROR\n        resourceSavedStatus = failure\n        Log warning: Interop FHIR Adapter - Invalid JSON: UUID: {} \n        Content is cleared\n6. Will log error and send to failure relationship if resource id or resource type id is not set.  \n",
              "position" : {
                "x" : 2384.0,
                "y" : -448.0
              },
              "style" : {
                "font-size" : "12px"
              },
              "width" : 576.0
            }, {
              "componentType" : "LABEL",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "height" : 72.0,
              "identifier" : "7c8867b9-d955-35ca-a415-211bfccbefec",
              "label" : "Sets the invokehttp.status.message attribute to a default message for a code if the message is not set.\nSets the hri.ingest.record.progress attribute to SUCCESS, WARNING, or ERROR\nSets the resourceSavedStatus attribute to success, warning, or failure\nMarks as failure if code is not set\n",
              "position" : {
                "x" : 2432.0,
                "y" : 776.0
              },
              "style" : {
                "font-size" : "12px"
              },
              "width" : 584.0
            } ],
            "name" : "Save To FHIR",
            "outputPorts" : [ {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "OUTPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "f59cb438-fed1-37e7-b47c-5060c1bd0a2f",
              "name" : "Output",
              "position" : {
                "x" : 2120.0,
                "y" : 1096.0
              },
              "type" : "OUTPUT_PORT"
            }, {
              "allowRemoteAccess" : false,
              "comments" : "",
              "componentType" : "OUTPUT_PORT",
              "concurrentlySchedulableTaskCount" : 1,
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "060c7afa-913f-3e05-9ad9-fe90177c35a9",
              "name" : "Aborted",
              "position" : {
                "x" : 1752.0,
                "y" : 616.0
              },
              "type" : "OUTPUT_PORT"
            } ],
            "parameterContextName" : "cms_adapter_parameters",
            "position" : {
              "x" : 1248.0,
              "y" : 1208.0
            },
            "processGroups" : [ {
              "comments" : "",
              "componentType" : "PROCESS_GROUP",
              "connections" : [ {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 296.0,
                  "y" : 1168.0
                }, {
                  "x" : 296.0,
                  "y" : 1360.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "1b21ae63-604c-3266-97d4-ec0a7f9ce426",
                  "name" : "Get Bundle entries failed",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "2578812d-0f9b-3672-a52d-e02dee695119",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "54eb3803-c74d-332f-acac-a5604e00b6e3",
                  "name" : "Get Bundle Entries",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 112.0,
                  "y" : 664.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "60a4f689-42c5-377f-9f3e-138f52704941",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "retry" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "90c045b9-99d0-39a8-a75c-d8641d50e707",
                  "name" : "Get Resource From Entry",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "ebbf3c2a-3037-3a45-bd1d-95aa97a2dc43",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2875dc6c-c869-3750-85de-2adf7708ab5a",
                  "name" : "Set Flag to Indicate bundle was split",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2c992409-cd63-3aa0-ac43-e944a7cc6c89",
                  "name" : "Log Error Message",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "b0b5d768-4481-32c2-aafc-ad17057a642e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "1b21ae63-604c-3266-97d4-ec0a7f9ce426",
                  "name" : "Get Bundle entries failed",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "f9f8f92e-b348-35bd-b77f-b6cc91e7ff62",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2c992409-cd63-3aa0-ac43-e944a7cc6c89",
                  "name" : "Log Error Message",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "b53d5937-b56d-35e9-a06c-6f25433aeace",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "540a0c86-47a1-3fe6-958f-43d497b2d117",
                  "name" : "Rebuild Bundle",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e5116666-2cbd-30ca-8345-96fc581eb99c",
                  "name" : "Update FHIR Error Message",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "e15d9be0-07cc-38a4-84df-bde406118971",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "retries_exceeded" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "id" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                  "name" : "Input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "51ca0326-9798-3da6-abfe-7340809938f2",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e5116666-2cbd-30ca-8345-96fc581eb99c",
                  "name" : "Update FHIR Error Message",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "11e60dd6-3776-3669-a506-9611de6a0c1d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "19c17031-e55d-36a3-bd4e-da67aecfac93",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2875dc6c-c869-3750-85de-2adf7708ab5a",
                  "name" : "Set Flag to Indicate bundle was split",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "47d7de21-95d8-351f-8b07-b34a6a65a47e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "split" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "54eb3803-c74d-332f-acac-a5604e00b6e3",
                  "name" : "Get Bundle Entries",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : -1216.0,
                  "y" : 2152.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "9b3ba8de-6f40-32a4-ad9c-7ce4d238dbe1",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "cafcbe48-f951-3dde-9c31-2ef04fb08442",
                  "name" : "Remove Warnings from Bundle Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1192.0,
                  "y" : 640.0
                }, {
                  "x" : 1192.0,
                  "y" : 360.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "7c66d226-60e1-3e37-9767-db734217d91b",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "Retry as batch" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6de32c89-1ffd-3a69-a905-0d9bf6ead7f5",
                  "name" : "Failed getting resource from entry",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "8815ca10-5d3b-3612-b1d9-626e0a3dfbb6",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "unmatched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "90c045b9-99d0-39a8-a75c-d8641d50e707",
                  "name" : "Get Resource From Entry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "19c17031-e55d-36a3-bd4e-da67aecfac93",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "e228ed4b-4276-3f1d-b4ee-8e4079278838",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "580efa05-995c-322b-94ff-327f844b833e",
                  "name" : "Log Retry Failure",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : -811.1295776367188,
                  "y" : 1111.6143798828125
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "580efa05-995c-322b-94ff-327f844b833e",
                  "name" : "Log Retry Failure",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "53c998d8-faea-3e4d-8017-85d6e493b446",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1528.0,
                  "y" : -224.0
                }, {
                  "x" : 1536.0,
                  "y" : 2144.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "20881660-38dc-3bf0-8bc7-09fc772d55cb",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "540a0c86-47a1-3fe6-958f-43d497b2d117",
                  "name" : "Rebuild Bundle",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 120.0,
                  "y" : 480.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "c2d59c24-d413-3896-a83d-0beaa5ca8bb1",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                  "name" : "Retry",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "7a8b0313-2447-3878-b428-63779a81cfe7",
                  "name" : "Handle POST Bundle FHIR Response",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "757b146a-de80-3315-ae09-896d0ff15361",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                  "name" : "Response",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 120.0,
                  "y" : 560.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "fa414e13-0415-3c9e-8066-1311dd9b33d1",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                  "name" : "Failure",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1112.0,
                  "y" : 1424.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "5a25fc73-7553-3b7c-ac9c-308ec557c159",
                  "name" : "Split",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "41d870a4-4321-3b49-a3fe-83a0983af3c8",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "matched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "90c045b9-99d0-39a8-a75c-d8641d50e707",
                  "name" : "Get Resource From Entry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "00810b3a-7380-3aa9-868b-f63a9419d78a",
                  "name" : "Update FHIR Error Message",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "97f1289f-16dd-3f04-b15a-fe331c47cd9e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "Other FHIR Error" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2b717038-ca6e-3af3-b5f4-f3087a28039a",
                  "name" : "Aborted",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "4c3ead9c-7485-39dc-9881-c1edcb5e8dab",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                  "name" : "Check For Abort",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "540a0c86-47a1-3fe6-958f-43d497b2d117",
                  "name" : "Rebuild Bundle",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "90db25e8-7b81-35fd-8ac5-5ed5096dcde7",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                  "name" : "Input Bundle",
                  "type" : "INPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "19c17031-e55d-36a3-bd4e-da67aecfac93",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "fc5eb044-2502-3e47-b6c8-d97fcf9aeebc",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "id" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e5116666-2cbd-30ca-8345-96fc581eb99c",
                  "name" : "Update FHIR Error Message",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "1bc7d233-df94-34ab-abec-39f882e1af0d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "Stop processing" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "54eb3803-c74d-332f-acac-a5604e00b6e3",
                  "name" : "Get Bundle Entries",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "81ea5272-c54f-3534-b27b-06f9178f05a9",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "split" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "8d1e6be6-e982-3c95-87a5-fc16e059b8cb",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                  "name" : "No Retry",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                  "name" : "Check For Abort",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "e9f4559d-c3de-383e-8a7e-c0fbab947820",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "retry" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 48.0,
                  "y" : 1360.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "21970830-b1f5-320b-87ed-6062d86fa06d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                  "name" : "Handle No Retry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "2c992409-cd63-3aa0-ac43-e944a7cc6c89",
                  "name" : "Log Error Message",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "069c0c11-055a-37b6-b05a-cac0b4cffeae",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "6de32c89-1ffd-3a69-a905-0d9bf6ead7f5",
                  "name" : "Failed getting resource from entry",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : -208.0,
                  "y" : 1472.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "19c17031-e55d-36a3-bd4e-da67aecfac93",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "1429f16d-358d-30bd-9c3e-db1e47759634",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "00810b3a-7380-3aa9-868b-f63a9419d78a",
                  "name" : "Update FHIR Error Message",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "cafcbe48-f951-3dde-9c31-2ef04fb08442",
                  "name" : "Remove Warnings from Bundle Response",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "58fe63c8-d98d-3433-b06c-13c9f51e515d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "output" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "7a8b0313-2447-3878-b428-63779a81cfe7",
                  "name" : "Handle POST Bundle FHIR Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "bafe39b6-9de5-35d3-ab5f-bda995050b8e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "not-found", "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "29471849-930f-3e53-a7b7-305d44813f0d",
                  "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                  "name" : "Check For Abort",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              } ],
              "controllerServices" : [ ],
              "flowFileConcurrency" : "UNBOUNDED",
              "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
              "funnels" : [ ],
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
              "inputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "INPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                "name" : "Input Bundle",
                "position" : {
                  "x" : 576.0,
                  "y" : -488.0
                },
                "type" : "INPUT_PORT"
              } ],
              "labels" : [ {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 56.0,
                "identifier" : "74a18908-d8e6-37f2-bba5-931a264cd6a1",
                "label" : "Sends to Output if code 2xx or is a delete bundle with code 400/422.\nIf it is a delete bundle with errors, will set the message to \"Bundle has errors\"",
                "position" : {
                  "x" : -384.0,
                  "y" : -8.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 552.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 112.0,
                "identifier" : "59939ba2-ec14-3a7c-82a5-b0cf1b821dc1",
                "label" : "Rebuilds the bundle so the appropriate post or put calls are made for FHIR resources in the entry array.\nIf the request is to Delete, then the entry is left as is.\nIf there isn't a FHIR resource in the entry for a non-delete request, an validation error is generated in an Operation Outcome,\n    status code 400, status message Update bundle failed, and sent to the failure relationship.\n\nThis class also adds the batch id tag in the FHIR resource's metadata for each entry if the FHIRResourceTag attribute is set.",
                "position" : {
                  "x" : 856.0,
                  "y" : -400.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 696.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 24.0,
                "identifier" : "e024ad0f-ab6b-38f8-84a5-68de40141d60",
                "label" : "1xx, 3xx, 4xx codes",
                "position" : {
                  "x" : 816.0,
                  "y" : 488.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 128.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 24.0,
                "identifier" : "a43c6fa4-0f8d-3073-8fc6-11af56face09",
                "label" : "No OperationOutcomes will be in FlowFiles here",
                "position" : {
                  "x" : -960.0,
                  "y" : 1656.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 312.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 24.0,
                "identifier" : "916529de-9037-37a6-93d3-df038588babd",
                "label" : "General Errors",
                "position" : {
                  "x" : 240.0,
                  "y" : 544.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 96.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 40.0,
                "identifier" : "57a5e389-0538-30c0-855c-969cef70510a",
                "label" : "Split up the bundle if there are no delete entries to \nattempt storing individual entries.",
                "position" : {
                  "x" : 880.0,
                  "y" : 960.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 304.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 144.0,
                "identifier" : "44c03bbb-7828-3876-b1f8-185f8a63c985",
                "label" : "\nWill send to split relationship if error code 400/422 and does not have delete requests.\nIf error code 400/422 and has delete requests, will set bundle tranaction type to batch to \n      Retry on Batch. If already converted to batch, then will be removed from flow.\nIf code is 404, will send to rety relationship.\nIf code is 401, will sent to Stop Processing relationship.\nIf code is 409, will send to split relationship.\nOther error codes will be sent to the Other Error relationship. \nIf an exception happens, the flow file will be sent to the failure relationship",
                "position" : {
                  "x" : 840.0,
                  "y" : 704.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 496.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 24.0,
                "identifier" : "20107d23-f86d-301a-b436-fa83b31badee",
                "label" : "5xx codes",
                "position" : {
                  "x" : 120.0,
                  "y" : 424.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 88.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "height" : 24.0,
                "identifier" : "3a2dbbc0-dbfd-3197-b002-67a71a5ce79c",
                "label" : "All Codes",
                "position" : {
                  "x" : 280.0,
                  "y" : 192.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 72.0
              } ],
              "name" : "Handle Resource Bundle",
              "outputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "5a25fc73-7553-3b7c-ac9c-308ec557c159",
                "name" : "Split",
                "position" : {
                  "x" : 992.0,
                  "y" : 1976.0
                },
                "type" : "OUTPUT_PORT"
              }, {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "2b717038-ca6e-3af3-b5f4-f3087a28039a",
                "name" : "Aborted",
                "position" : {
                  "x" : -992.0,
                  "y" : 336.0
                },
                "type" : "OUTPUT_PORT"
              }, {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "6aeed3c0-7742-32b0-b5bf-509338ec9725",
                "name" : "Output",
                "position" : {
                  "x" : -576.0,
                  "y" : 2128.0
                },
                "type" : "OUTPUT_PORT"
              } ],
              "parameterContextName" : "cms_adapter_parameters",
              "position" : {
                "x" : 1336.0,
                "y" : 240.0
              },
              "processGroups" : [ {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "d8f89da6-20eb-3955-a417-59df8c025bb6",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                    "name" : "No Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "9401f751-73c3-3a7b-a1ea-f9488baf787b",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "No Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                    "name" : "Response",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "43071c3d-2cf1-37fa-97ac-df21d5524400",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Response" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "aab94691-8c50-30fe-9e9f-966fc5898afe",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "providerDirectory" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "eb302852-893e-3280-8192-8cfd9b03e420",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "f6e52f05-ff86-3dfd-8f92-695feaca59ad",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "unmatched" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "b528fd50-3745-32e3-9256-7a321174a00c",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                    "name" : "No Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "637548d6-e52b-3bae-ba99-2eb27368129e",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "No Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "23023de5-bc11-33bf-b61d-5b112ae77ffe",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                    "name" : "Response",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "c275bfc3-60a5-3ba9-a8bc-34206982a876",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Response" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "2335ed46-6329-3cdf-8cb7-d02b93dc9b39",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                    "name" : "input",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                  "name" : "input",
                  "position" : {
                    "x" : 1448.0,
                    "y" : -344.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ ],
                "name" : "Post Resource Bundle to FHIR server",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                  "name" : "No Retry",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 288.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                  "name" : "Response",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 152.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                  "name" : "Failure",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 416.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                  "name" : "Retry",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 536.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "parameterContextName" : "cms_adapter_parameters",
                "position" : {
                  "x" : 504.0,
                  "y" : 272.0
                },
                "processGroups" : [ ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ "Original" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 24,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                  "name" : "Post Resource to FHIR Patient Access",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 736.0,
                    "y" : 240.0
                  },
                  "properties" : {
                    "use-etag" : "false",
                    "Prefer" : "return=${FHIRPreferSetting}",
                    "Proxy Type" : "http",
                    "Basic Authentication Password" : "#{FHIR_UserPwd_PatientAccess}",
                    "Connection Timeout" : "5 secs",
                    "send-message-body" : "true",
                    "set-form-filename" : "true",
                    "Always Output Response" : "true",
                    "etag-max-cache-size" : "10MB",
                    "disable-http2" : "False",
                    "idle-timeout" : "5 mins",
                    "Put Response Body In Attribute" : "responseBody",
                    "Use Chunked Encoding" : "false",
                    "Follow Redirects" : "True",
                    "Remote URL" : "#{FHIR_URL_PatientAccess}${fhirUrlSuffix}",
                    "Content-Type" : "application/json",
                    "max-idle-connections" : "5",
                    "Read Timeout" : "130 secs",
                    "Max Length To Put In Attribute" : "2048",
                    "ignore-response-content" : "false",
                    "Digest Authentication" : "false",
                    "HTTP Method" : "POST",
                    "Add Response Headers to Request" : "false",
                    "Basic Authentication Username" : "#{FHIR_User_PatientAccess}",
                    "Include Date Header" : "True",
                    "Penalize on \"No Retry\"" : "false",
                    "X-FHIR-TENANT-ID" : "${tenant}"
                  },
                  "propertyDescriptors" : {
                    "Proxy Host" : {
                      "displayName" : "Proxy Host",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Host",
                      "sensitive" : false
                    },
                    "Attributes to Send" : {
                      "displayName" : "Attributes to Send",
                      "identifiesControllerService" : false,
                      "name" : "Attributes to Send",
                      "sensitive" : false
                    },
                    "use-etag" : {
                      "displayName" : "Use HTTP ETag",
                      "identifiesControllerService" : false,
                      "name" : "use-etag",
                      "sensitive" : false
                    },
                    "proxy-configuration-service" : {
                      "displayName" : "Proxy Configuration Service",
                      "identifiesControllerService" : true,
                      "name" : "proxy-configuration-service",
                      "sensitive" : false
                    },
                    "Prefer" : {
                      "displayName" : "Prefer",
                      "identifiesControllerService" : false,
                      "name" : "Prefer",
                      "sensitive" : false
                    },
                    "Proxy Type" : {
                      "displayName" : "Proxy Type",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Type",
                      "sensitive" : false
                    },
                    "Basic Authentication Password" : {
                      "displayName" : "Basic Authentication Password",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Password",
                      "sensitive" : true
                    },
                    "Connection Timeout" : {
                      "displayName" : "Connection Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Connection Timeout",
                      "sensitive" : false
                    },
                    "send-message-body" : {
                      "displayName" : "Send Message Body",
                      "identifiesControllerService" : false,
                      "name" : "send-message-body",
                      "sensitive" : false
                    },
                    "set-form-filename" : {
                      "displayName" : "Set Flowfile Form Data File Name",
                      "identifiesControllerService" : false,
                      "name" : "set-form-filename",
                      "sensitive" : false
                    },
                    "Always Output Response" : {
                      "displayName" : "Always Output Response",
                      "identifiesControllerService" : false,
                      "name" : "Always Output Response",
                      "sensitive" : false
                    },
                    "etag-max-cache-size" : {
                      "displayName" : "Maximum ETag Cache Size",
                      "identifiesControllerService" : false,
                      "name" : "etag-max-cache-size",
                      "sensitive" : false
                    },
                    "disable-http2" : {
                      "displayName" : "disable-http2",
                      "identifiesControllerService" : false,
                      "name" : "disable-http2",
                      "sensitive" : false
                    },
                    "idle-timeout" : {
                      "displayName" : "Idle Timeout",
                      "identifiesControllerService" : false,
                      "name" : "idle-timeout",
                      "sensitive" : false
                    },
                    "Put Response Body In Attribute" : {
                      "displayName" : "Put Response Body In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Response Body In Attribute",
                      "sensitive" : false
                    },
                    "Use Chunked Encoding" : {
                      "displayName" : "Use Chunked Encoding",
                      "identifiesControllerService" : false,
                      "name" : "Use Chunked Encoding",
                      "sensitive" : false
                    },
                    "Follow Redirects" : {
                      "displayName" : "Follow Redirects",
                      "identifiesControllerService" : false,
                      "name" : "Follow Redirects",
                      "sensitive" : false
                    },
                    "Remote URL" : {
                      "displayName" : "Remote URL",
                      "identifiesControllerService" : false,
                      "name" : "Remote URL",
                      "sensitive" : false
                    },
                    "Content-Type" : {
                      "displayName" : "Content-Type",
                      "identifiesControllerService" : false,
                      "name" : "Content-Type",
                      "sensitive" : false
                    },
                    "form-body-form-name" : {
                      "displayName" : "Flowfile Form Data Name",
                      "identifiesControllerService" : false,
                      "name" : "form-body-form-name",
                      "sensitive" : false
                    },
                    "max-idle-connections" : {
                      "displayName" : "Max Idle Connections",
                      "identifiesControllerService" : false,
                      "name" : "max-idle-connections",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-user" : {
                      "displayName" : "Proxy Username",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-user",
                      "sensitive" : false
                    },
                    "Read Timeout" : {
                      "displayName" : "Read Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Read Timeout",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-password" : {
                      "displayName" : "Proxy Password",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-password",
                      "sensitive" : true
                    },
                    "ignore-response-content" : {
                      "displayName" : "Ignore response's content",
                      "identifiesControllerService" : false,
                      "name" : "ignore-response-content",
                      "sensitive" : false
                    },
                    "Proxy Port" : {
                      "displayName" : "Proxy Port",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Port",
                      "sensitive" : false
                    },
                    "SSL Context Service" : {
                      "displayName" : "SSL Context Service",
                      "identifiesControllerService" : true,
                      "name" : "SSL Context Service",
                      "sensitive" : false
                    },
                    "Digest Authentication" : {
                      "displayName" : "Use Digest Authentication",
                      "identifiesControllerService" : false,
                      "name" : "Digest Authentication",
                      "sensitive" : false
                    },
                    "HTTP Method" : {
                      "displayName" : "HTTP Method",
                      "identifiesControllerService" : false,
                      "name" : "HTTP Method",
                      "sensitive" : false
                    },
                    "Add Response Headers to Request" : {
                      "displayName" : "Add Response Headers to Request",
                      "identifiesControllerService" : false,
                      "name" : "Add Response Headers to Request",
                      "sensitive" : false
                    },
                    "Basic Authentication Username" : {
                      "displayName" : "Basic Authentication Username",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Username",
                      "sensitive" : false
                    },
                    "Include Date Header" : {
                      "displayName" : "Include Date Header",
                      "identifiesControllerService" : false,
                      "name" : "Include Date Header",
                      "sensitive" : false
                    },
                    "Penalize on \"No Retry\"" : {
                      "displayName" : "Penalize on \"No Retry\"",
                      "identifiesControllerService" : false,
                      "name" : "Penalize on \"No Retry\"",
                      "sensitive" : false
                    },
                    "X-FHIR-TENANT-ID" : {
                      "displayName" : "X-FHIR-TENANT-ID",
                      "identifiesControllerService" : false,
                      "name" : "X-FHIR-TENANT-ID",
                      "sensitive" : false
                    },
                    "Useragent" : {
                      "displayName" : "Useragent",
                      "identifiesControllerService" : false,
                      "name" : "Useragent",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                  "name" : "Is Provider Directory",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1392.0,
                    "y" : -152.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "providerDirectory" : "${kafka.topic:getDelimitedField(4,'.'):toLower():startsWith('provider_directory')}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "providerDirectory" : {
                      "displayName" : "providerDirectory",
                      "identifiesControllerService" : false,
                      "name" : "providerDirectory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "Original" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 24,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "identifier" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                  "name" : "Post Resource to FHIR Provider Directory",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 2112.0,
                    "y" : 248.0
                  },
                  "properties" : {
                    "use-etag" : "false",
                    "Prefer" : "return=${FHIRPreferSetting}",
                    "Proxy Type" : "http",
                    "Basic Authentication Password" : "#{FHIR_UserPwd_ProviderDirectory}",
                    "Connection Timeout" : "5 secs",
                    "send-message-body" : "true",
                    "set-form-filename" : "true",
                    "Always Output Response" : "true",
                    "etag-max-cache-size" : "10MB",
                    "disable-http2" : "False",
                    "idle-timeout" : "5 mins",
                    "Put Response Body In Attribute" : "responseBody",
                    "Use Chunked Encoding" : "false",
                    "Follow Redirects" : "True",
                    "Remote URL" : "#{FHIR_URL_ProviderDirectory}${fhirUrlSuffix}",
                    "Content-Type" : "application/json",
                    "max-idle-connections" : "5",
                    "Read Timeout" : "130 secs",
                    "Max Length To Put In Attribute" : "2048",
                    "ignore-response-content" : "false",
                    "Digest Authentication" : "false",
                    "HTTP Method" : "POST",
                    "Add Response Headers to Request" : "false",
                    "Basic Authentication Username" : "#{FHIR_User_ProviderDirectory}",
                    "Include Date Header" : "True",
                    "Penalize on \"No Retry\"" : "false",
                    "X-FHIR-TENANT-ID" : "${tenant}"
                  },
                  "propertyDescriptors" : {
                    "Proxy Host" : {
                      "displayName" : "Proxy Host",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Host",
                      "sensitive" : false
                    },
                    "Attributes to Send" : {
                      "displayName" : "Attributes to Send",
                      "identifiesControllerService" : false,
                      "name" : "Attributes to Send",
                      "sensitive" : false
                    },
                    "use-etag" : {
                      "displayName" : "Use HTTP ETag",
                      "identifiesControllerService" : false,
                      "name" : "use-etag",
                      "sensitive" : false
                    },
                    "proxy-configuration-service" : {
                      "displayName" : "Proxy Configuration Service",
                      "identifiesControllerService" : true,
                      "name" : "proxy-configuration-service",
                      "sensitive" : false
                    },
                    "Prefer" : {
                      "displayName" : "Prefer",
                      "identifiesControllerService" : false,
                      "name" : "Prefer",
                      "sensitive" : false
                    },
                    "Proxy Type" : {
                      "displayName" : "Proxy Type",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Type",
                      "sensitive" : false
                    },
                    "Basic Authentication Password" : {
                      "displayName" : "Basic Authentication Password",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Password",
                      "sensitive" : true
                    },
                    "Connection Timeout" : {
                      "displayName" : "Connection Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Connection Timeout",
                      "sensitive" : false
                    },
                    "send-message-body" : {
                      "displayName" : "Send Message Body",
                      "identifiesControllerService" : false,
                      "name" : "send-message-body",
                      "sensitive" : false
                    },
                    "set-form-filename" : {
                      "displayName" : "Set Flowfile Form Data File Name",
                      "identifiesControllerService" : false,
                      "name" : "set-form-filename",
                      "sensitive" : false
                    },
                    "Always Output Response" : {
                      "displayName" : "Always Output Response",
                      "identifiesControllerService" : false,
                      "name" : "Always Output Response",
                      "sensitive" : false
                    },
                    "etag-max-cache-size" : {
                      "displayName" : "Maximum ETag Cache Size",
                      "identifiesControllerService" : false,
                      "name" : "etag-max-cache-size",
                      "sensitive" : false
                    },
                    "disable-http2" : {
                      "displayName" : "disable-http2",
                      "identifiesControllerService" : false,
                      "name" : "disable-http2",
                      "sensitive" : false
                    },
                    "idle-timeout" : {
                      "displayName" : "Idle Timeout",
                      "identifiesControllerService" : false,
                      "name" : "idle-timeout",
                      "sensitive" : false
                    },
                    "Put Response Body In Attribute" : {
                      "displayName" : "Put Response Body In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Response Body In Attribute",
                      "sensitive" : false
                    },
                    "Use Chunked Encoding" : {
                      "displayName" : "Use Chunked Encoding",
                      "identifiesControllerService" : false,
                      "name" : "Use Chunked Encoding",
                      "sensitive" : false
                    },
                    "Follow Redirects" : {
                      "displayName" : "Follow Redirects",
                      "identifiesControllerService" : false,
                      "name" : "Follow Redirects",
                      "sensitive" : false
                    },
                    "Remote URL" : {
                      "displayName" : "Remote URL",
                      "identifiesControllerService" : false,
                      "name" : "Remote URL",
                      "sensitive" : false
                    },
                    "Content-Type" : {
                      "displayName" : "Content-Type",
                      "identifiesControllerService" : false,
                      "name" : "Content-Type",
                      "sensitive" : false
                    },
                    "form-body-form-name" : {
                      "displayName" : "Flowfile Form Data Name",
                      "identifiesControllerService" : false,
                      "name" : "form-body-form-name",
                      "sensitive" : false
                    },
                    "max-idle-connections" : {
                      "displayName" : "Max Idle Connections",
                      "identifiesControllerService" : false,
                      "name" : "max-idle-connections",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-user" : {
                      "displayName" : "Proxy Username",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-user",
                      "sensitive" : false
                    },
                    "Read Timeout" : {
                      "displayName" : "Read Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Read Timeout",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-password" : {
                      "displayName" : "Proxy Password",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-password",
                      "sensitive" : true
                    },
                    "ignore-response-content" : {
                      "displayName" : "Ignore response's content",
                      "identifiesControllerService" : false,
                      "name" : "ignore-response-content",
                      "sensitive" : false
                    },
                    "Proxy Port" : {
                      "displayName" : "Proxy Port",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Port",
                      "sensitive" : false
                    },
                    "SSL Context Service" : {
                      "displayName" : "SSL Context Service",
                      "identifiesControllerService" : true,
                      "name" : "SSL Context Service",
                      "sensitive" : false
                    },
                    "Digest Authentication" : {
                      "displayName" : "Use Digest Authentication",
                      "identifiesControllerService" : false,
                      "name" : "Digest Authentication",
                      "sensitive" : false
                    },
                    "HTTP Method" : {
                      "displayName" : "HTTP Method",
                      "identifiesControllerService" : false,
                      "name" : "HTTP Method",
                      "sensitive" : false
                    },
                    "Add Response Headers to Request" : {
                      "displayName" : "Add Response Headers to Request",
                      "identifiesControllerService" : false,
                      "name" : "Add Response Headers to Request",
                      "sensitive" : false
                    },
                    "Basic Authentication Username" : {
                      "displayName" : "Basic Authentication Username",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Username",
                      "sensitive" : false
                    },
                    "Include Date Header" : {
                      "displayName" : "Include Date Header",
                      "identifiesControllerService" : false,
                      "name" : "Include Date Header",
                      "sensitive" : false
                    },
                    "Penalize on \"No Retry\"" : {
                      "displayName" : "Penalize on \"No Retry\"",
                      "identifiesControllerService" : false,
                      "name" : "Penalize on \"No Retry\"",
                      "sensitive" : false
                    },
                    "X-FHIR-TENANT-ID" : {
                      "displayName" : "X-FHIR-TENANT-ID",
                      "identifiesControllerService" : false,
                      "name" : "X-FHIR-TENANT-ID",
                      "sensitive" : false
                    },
                    "Useragent" : {
                      "displayName" : "Useragent",
                      "identifiesControllerService" : false,
                      "name" : "Useragent",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              }, {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "0d7ea990-3be5-3c5d-92a8-b0b04442491d",
                    "name" : "Log Abort Flag set",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "eeb1631e-4bde-333c-ab70-1ee8342465de",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "f1e71f71-7272-3241-b185-036d7ddaaddb",
                    "name" : "Add Abort Flag to Cache",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "f1e71f71-7272-3241-b185-036d7ddaaddb",
                    "name" : "Add Abort Flag to Cache",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "5eed997a-9300-3a76-a944-6310608dbd36",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "failure", "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "017fd75a-6fde-3c4c-a68a-f3c0fd93cbb5",
                    "name" : "Set Abort flag",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "34793802-aff1-3c32-ab13-704db1881f0b",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "6e993a26-cf56-3987-bedc-a9b007d0e09c",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "31f55471-ab6b-3691-8ae1-167a87b5c190",
                    "name" : "split into flow files for messages",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                    "name" : "Output",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "46011b61-42e8-3a7e-86a2-e1225aad92cc",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "original" ],
                  "source" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "34793802-aff1-3c32-ab13-704db1881f0b",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "31f55471-ab6b-3691-8ae1-167a87b5c190",
                    "name" : "split into flow files for messages",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "09959561-6b6d-36be-8258-dca352e135dc",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                    "name" : "Input",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "017fd75a-6fde-3c4c-a68a-f3c0fd93cbb5",
                    "name" : "Set Abort flag",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "ac9a8b1c-80bb-3910-8811-f69068bcfc08",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "copy" ],
                  "source" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                    "id" : "34793802-aff1-3c32-ab13-704db1881f0b",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                  "name" : "Input",
                  "position" : {
                    "x" : 1008.0,
                    "y" : 24.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ ],
                "name" : "Stop Processing",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                  "name" : "Output",
                  "position" : {
                    "x" : 1008.0,
                    "y" : 736.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "position" : {
                  "x" : -656.0,
                  "y" : 1176.0
                },
                "processGroups" : [ ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "31f55471-ab6b-3691-8ae1-167a87b5c190",
                  "name" : "split into flow files for messages",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 952.0,
                    "y" : 224.0
                  },
                  "properties" : {
                    "Number of Copies" : "1"
                  },
                  "propertyDescriptors" : {
                    "Number of Copies" : {
                      "displayName" : "Number of Copies",
                      "identifiesControllerService" : false,
                      "name" : "Number of Copies",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.DuplicateFlowFile",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "unmatched" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "34793802-aff1-3c32-ab13-704db1881f0b",
                  "name" : "Route Copy for abort indication",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 952.0,
                    "y" : 432.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "original" : "${copy.index:equals(0)}",
                    "copy" : "${copy.index:equals(1)}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "original" : {
                      "displayName" : "original",
                      "identifiesControllerService" : false,
                      "name" : "original",
                      "sensitive" : false
                    },
                    "copy" : {
                      "displayName" : "copy",
                      "identifiesControllerService" : false,
                      "name" : "copy",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "017fd75a-6fde-3c4c-a68a-f3c0fd93cbb5",
                  "name" : "Set Abort flag",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 424.0
                  },
                  "properties" : {
                    "Regular Expression" : "(?s)(^.*$)",
                    "Replacement Value" : "${invokehttp.status.code}: ${invokehttp.status.message}",
                    "Evaluation Mode" : "Entire text",
                    "Line-by-Line Evaluation Mode" : "All",
                    "Character Set" : "UTF-8",
                    "Maximum Buffer Size" : "1 MB",
                    "Replacement Strategy" : "Always Replace"
                  },
                  "propertyDescriptors" : {
                    "Regular Expression" : {
                      "displayName" : "Search Value",
                      "identifiesControllerService" : false,
                      "name" : "Regular Expression",
                      "sensitive" : false
                    },
                    "Replacement Value" : {
                      "displayName" : "Replacement Value",
                      "identifiesControllerService" : false,
                      "name" : "Replacement Value",
                      "sensitive" : false
                    },
                    "Evaluation Mode" : {
                      "displayName" : "Evaluation Mode",
                      "identifiesControllerService" : false,
                      "name" : "Evaluation Mode",
                      "sensitive" : false
                    },
                    "Line-by-Line Evaluation Mode" : {
                      "displayName" : "Line-by-Line Evaluation Mode",
                      "identifiesControllerService" : false,
                      "name" : "Line-by-Line Evaluation Mode",
                      "sensitive" : false
                    },
                    "Character Set" : {
                      "displayName" : "Character Set",
                      "identifiesControllerService" : false,
                      "name" : "Character Set",
                      "sensitive" : false
                    },
                    "Maximum Buffer Size" : {
                      "displayName" : "Maximum Buffer Size",
                      "identifiesControllerService" : false,
                      "name" : "Maximum Buffer Size",
                      "sensitive" : false
                    },
                    "Replacement Strategy" : {
                      "displayName" : "Replacement Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Replacement Strategy",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.ReplaceText",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "success" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "0d7ea990-3be5-3c5d-92a8-b0b04442491d",
                  "name" : "Log Abort Flag set",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 944.0
                  },
                  "properties" : {
                    "log-message" : "Abort flag \"abort-${sourceBatchId}\" set",
                    "log-level" : "info",
                    "log-prefix" : "Interop FHIR Adapter - "
                  },
                  "propertyDescriptors" : {
                    "log-message" : {
                      "displayName" : "Log message",
                      "identifiesControllerService" : false,
                      "name" : "log-message",
                      "sensitive" : false
                    },
                    "log-level" : {
                      "displayName" : "Log Level",
                      "identifiesControllerService" : false,
                      "name" : "log-level",
                      "sensitive" : false
                    },
                    "log-prefix" : {
                      "displayName" : "Log prefix",
                      "identifiesControllerService" : false,
                      "name" : "log-prefix",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.LogMessage",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "failure" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "0083c255-69fa-3c90-9739-6f14ecb5bf5c",
                  "identifier" : "f1e71f71-7272-3241-b185-036d7ddaaddb",
                  "name" : "Add Abort Flag to Cache",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 696.0
                  },
                  "properties" : {
                    "Cache Entry Identifier" : "abort-${sourceBatchId}",
                    "Cache update strategy" : "keeporiginal",
                    "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                    "Max cache entry size" : "1 MB"
                  },
                  "propertyDescriptors" : {
                    "Cache Entry Identifier" : {
                      "displayName" : "Cache Entry Identifier",
                      "identifiesControllerService" : false,
                      "name" : "Cache Entry Identifier",
                      "sensitive" : false
                    },
                    "Cache update strategy" : {
                      "displayName" : "Cache update strategy",
                      "identifiesControllerService" : false,
                      "name" : "Cache update strategy",
                      "sensitive" : false
                    },
                    "Distributed Cache Service" : {
                      "displayName" : "Distributed Cache Service",
                      "identifiesControllerService" : true,
                      "name" : "Distributed Cache Service",
                      "sensitive" : false
                    },
                    "Max cache entry size" : {
                      "displayName" : "Max cache entry size",
                      "identifiesControllerService" : false,
                      "name" : "Max cache entry size",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.PutDistributedMapCache",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              } ],
              "processors" : [ {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "00810b3a-7380-3aa9-868b-f63a9419d78a",
                "name" : "Update FHIR Error Message",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -160.0,
                  "y" : 912.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.io.IOUtils\n\n/**\n * For \"Update FHIR Error Message\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Put Resource to FHIR\"\n *\n * Sets the invokehttp.status.message attribute to a default message for a code if the message is not set.\n * Prepends the message with FHIR Server\n */\n\nstatusMessageAttributeName = \"invokehttp.status.message\"\n\ncodeMap = [\n  '200': \"OK\",\n  '201': \"Created\",\n  '400': \"Bad Request\",\n  '401': \"Not Authorized\",\n  '404': \"Not Found\",\n  '422': \"Unprocessable Entity\",\n  '500': \"Internal Server Error\",\n  '502': \"Bad Gateway\",\n  '503': \"Service Unavailable\",\n  '504': \"Gateway Timeout\"\n]\n\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles != null) {\n    for (FlowFile flowFile : flowFiles) {\n        // Set the HTTP message if it isn't set\n        String originalStatusMessage = flowFile.getAttribute( statusMessageAttributeName)\n        String httpStatusCode = flowFile.getAttribute(\"invokehttp.status.code\")\n        \n        if (httpStatusCode != null) {\n            if (!originalStatusMessage) {\n                String codeMessage = codeMap.get(httpStatusCode)\n                if ( codeMessage != null ) {\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, codeMessage )\n                } else {\n                    // Just create a generic error message\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"Error \" + httpStatusCode )\n                }\n            }\n        }\n        \n        // Prepend the status message with FHIR Server\n        flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"FHIR Server - \" + flowFile.getAttribute( statusMessageAttributeName) )\n        \n        session.transfer(flowFile, REL_SUCCESS)\n    }\n}\n\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "cafcbe48-f951-3dde-9c31-2ef04fb08442",
                "name" : "Remove Warnings from Bundle Response",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -1384.0,
                  "y" : 72.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Remove Warnings from Bundle Response\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Handle Resource Bundle\" and \n *                                                         \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Auto Build Bundle\" >> \"Handle Auto Built Resource Bundle\"\n *     \n * 1. Sets the mime and content type attributes to json if it is set to fhir+json\n * 2. If the resource is a bundle, the attribute FHIRPreferSetting is set to minimal, and the code is 2xx:  Removes the outcome field in each of the entry's response.      \n */\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null)\n    return\n\nString [] contentTypeAttrs = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n\nfor (FlowFile aFlowFile : flowFiles) {\n    \n    // Convert fhir+json to json\n    for (String attrName : contentTypeAttrs) {\n        String attr = aFlowFile.getAttribute(attrName)\n        if ( attr != null) {\n            aFlowFile = session.putAttribute(aFlowFile, attrName, attr.replace(\"fhir+json\",\"json\"))\n        }\n    }\n\n    // Get the code and prefer setting\n    String preferSetting = aFlowFile.getAttribute(\"FHIRPreferSetting\")\n    String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n\n    try {\n        if (httpStatusCode && httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3 &&\n            preferSetting && preferSetting.equals(\"minimal\")) {    \n    \n            aFlowFile = session.write(aFlowFile, new StreamCallback() {\n                @Override\n                void process(InputStream instream,  OutputStream outstream) throws IOException {\n                    String inputText = instream.getText()\n                    \n                    if (inputText != null && !inputText.isEmpty()) {\n                        def jsonSlurper = new JsonSlurper()\n                        Map inputJson = jsonSlurper.parseText(inputText)\n\n                        String resourceType = inputJson.getAt(\"resourceType\")\n\n                        if (resourceType != null) {\n                            if (resourceType.equals(\"Bundle\")) {\n                                // Bundle handling\n                                ArrayList entries = inputJson.getAt(\"entry\")\n\n                                if (entries != null) {\n                                    for (Map anEntry : entries) {\n                                        // Remove the output from the response\n                                        Map response = anEntry.getAt(\"response\")\n                                        if (response != null) {\n                                            Map outcome = response.remove(\"outcome\")\n                                        }\n                                    } // end loop of entries\n                                    \n                                } // End of entries != null\n                            } // end if bundle\n                        } // end if resource type != null\n                        \n                        // Write out the flowfile contents.\n                        outstream.write( JsonOutput.toJson(inputJson).getBytes(StandardCharsets.UTF_8))\n                    }\n                }\n            })\n        }\n        aFlowFile = session.putAttribute(aFlowFile, \"Content-Length\", \"\" + aFlowFile.getSize())\n        session.transfer(aFlowFile, REL_SUCCESS)\n    } catch (Exception e) {\n        log.error('Exception removing bundle response output in flowfile with UUID {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n        session.transfer(aFlowFile, REL_FAILURE)\n    }\n}\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                "name" : "RetryFlowFile",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -640.0,
                  "y" : 552.0
                },
                "properties" : {
                  "penalize-retries" : "true",
                  "maximum-retries" : "3",
                  "Fail on Non-numerical Overwrite" : "false",
                  "reuse-mode" : "fail",
                  "retry-attribute" : "postBundleResource.retries"
                },
                "propertyDescriptors" : {
                  "penalize-retries" : {
                    "displayName" : "Penalize Retries",
                    "identifiesControllerService" : false,
                    "name" : "penalize-retries",
                    "sensitive" : false
                  },
                  "maximum-retries" : {
                    "displayName" : "Maximum Retries",
                    "identifiesControllerService" : false,
                    "name" : "maximum-retries",
                    "sensitive" : false
                  },
                  "Fail on Non-numerical Overwrite" : {
                    "displayName" : "Fail on Non-numerical Overwrite",
                    "identifiesControllerService" : false,
                    "name" : "Fail on Non-numerical Overwrite",
                    "sensitive" : false
                  },
                  "reuse-mode" : {
                    "displayName" : "Reuse Mode",
                    "identifiesControllerService" : false,
                    "name" : "reuse-mode",
                    "sensitive" : false
                  },
                  "retry-attribute" : {
                    "displayName" : "Retry Attribute",
                    "identifiesControllerService" : false,
                    "name" : "retry-attribute",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.RetryFlowFile",
                "yieldDuration" : "30 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "580efa05-995c-322b-94ff-327f844b833e",
                "name" : "Log Retry Failure",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -1104.0,
                  "y" : 1168.0
                },
                "properties" : {
                  "Log prefix" : "Interop FHIR Adapter - unable to retry POST to FHIR Server",
                  "character-set" : "UTF-8",
                  "Log Level" : "error",
                  "attributes-to-log-regex" : ".*",
                  "Log Payload" : "true"
                },
                "propertyDescriptors" : {
                  "Log prefix" : {
                    "displayName" : "Log prefix",
                    "identifiesControllerService" : false,
                    "name" : "Log prefix",
                    "sensitive" : false
                  },
                  "character-set" : {
                    "displayName" : "Character Set",
                    "identifiesControllerService" : false,
                    "name" : "character-set",
                    "sensitive" : false
                  },
                  "Log Level" : {
                    "displayName" : "Log Level",
                    "identifiesControllerService" : false,
                    "name" : "Log Level",
                    "sensitive" : false
                  },
                  "attributes-to-ignore-regex" : {
                    "displayName" : "Attributes to Ignore by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-ignore-regex",
                    "sensitive" : false
                  },
                  "Attributes to Ignore" : {
                    "displayName" : "Attributes to Ignore",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Ignore",
                    "sensitive" : false
                  },
                  "Attributes to Log" : {
                    "displayName" : "Attributes to Log",
                    "identifiesControllerService" : false,
                    "name" : "Attributes to Log",
                    "sensitive" : false
                  },
                  "attributes-to-log-regex" : {
                    "displayName" : "Attributes to Log by Regular Expression",
                    "identifiesControllerService" : false,
                    "name" : "attributes-to-log-regex",
                    "sensitive" : false
                  },
                  "Log Payload" : {
                    "displayName" : "Log Payload",
                    "identifiesControllerService" : false,
                    "name" : "Log Payload",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.LogAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "2875dc6c-c869-3750-85de-2adf7708ab5a",
                "name" : "Set Flag to Indicate bundle was split",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : 1112.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "bundleWasSplit" : "true",
                  "bundleEntryIndex" : "${fragment.index}"
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "bundleWasSplit" : {
                    "displayName" : "bundleWasSplit",
                    "identifiesControllerService" : false,
                    "name" : "bundleWasSplit",
                    "sensitive" : false
                  },
                  "bundleEntryIndex" : {
                    "displayName" : "bundleEntryIndex",
                    "identifiesControllerService" : false,
                    "name" : "bundleEntryIndex",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "original" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "54eb3803-c74d-332f-acac-a5604e00b6e3",
                "name" : "Get Bundle Entries",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : 872.0
                },
                "properties" : {
                  "Null Value Representation" : "empty string",
                  "JsonPath Expression" : "$.entry"
                },
                "propertyDescriptors" : {
                  "Null Value Representation" : {
                    "displayName" : "Null Value Representation",
                    "identifiesControllerService" : false,
                    "name" : "Null Value Representation",
                    "sensitive" : false
                  },
                  "JsonPath Expression" : {
                    "displayName" : "JsonPath Expression",
                    "identifiesControllerService" : false,
                    "name" : "JsonPath Expression",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.SplitJson",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "e5116666-2cbd-30ca-8345-96fc581eb99c",
                "name" : "Update FHIR Error Message",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -640.0,
                  "y" : 904.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.io.IOUtils\n\n/**\n * For \"Update FHIR Error Message\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Put Resource to FHIR\"\n *\n * Sets the invokehttp.status.message attribute to a default message for a code if the message is not set.\n * Prepends the message with FHIR Server\n */\n\nstatusMessageAttributeName = \"invokehttp.status.message\"\n\ncodeMap = [\n  '200': \"OK\",\n  '201': \"Created\",\n  '400': \"Bad Request\",\n  '401': \"Not Authorized\",\n  '404': \"Not Found\",\n  '422': \"Unprocessable Entity\",\n  '500': \"Internal Server Error\",\n  '502': \"Bad Gateway\",\n  '503': \"Service Unavailable\",\n  '504': \"Gateway Timeout\"\n]\n\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles != null) {\n    for (FlowFile flowFile : flowFiles) {\n        // Set the HTTP message if it isn't set\n        String originalStatusMessage = flowFile.getAttribute( statusMessageAttributeName)\n        String httpStatusCode = flowFile.getAttribute(\"invokehttp.status.code\")\n        \n        if (httpStatusCode != null) {\n            if (!originalStatusMessage) {\n                String codeMessage = codeMap.get(httpStatusCode)\n                if ( codeMessage != null ) {\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, codeMessage )\n                } else {\n                    // Just create a generic error message\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"Error \" + httpStatusCode )\n                }\n            }\n        }\n        \n        // Prepend the status message with FHIR Server\n        flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"FHIR Server - \" + flowFile.getAttribute( statusMessageAttributeName) )\n        \n        session.transfer(flowFile, REL_SUCCESS)\n    }\n}\n\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "failure" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "19c17031-e55d-36a3-bd4e-da67aecfac93",
                "name" : "Clear Flow File Contents",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -640.0,
                  "y" : 1600.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.exception.ProcessException\nimport java.nio.charset.StandardCharsets\n\n/**\n * Clears the FlowFile content and sets the Content-Type, mime.type to text.\n * \n */\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null) {\n    return\n}\n\nString [] CONTENT_TYPE_ATTRS = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n\nfor (FlowFile aFlowFile : flowFiles) {\n    aFlowFile = session.write(aFlowFile, new StreamCallback () {\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            outstream.write(\"\".getBytes(StandardCharsets.UTF_8))\n        }\n\n    })\n\n    for (String attrName : CONTENT_TYPE_ATTRS) {\n        String attr = aFlowFile.getAttribute(attrName)\n        if ( attr != null ) {\n            aFlowFile = session.putAttribute(aFlowFile, attrName, \"text/plain\")\n        }\n    }\n\n    session.transfer(aFlowFile, REL_SUCCESS)\n}\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "6de32c89-1ffd-3a69-a905-0d9bf6ead7f5",
                "name" : "Failed getting resource from entry",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : 1680.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "errorType" : "Failed getting resource from entry",
                  "errorMessage" : "ResourceType: \"${resourceType}\", ResourceId: \"${resourceId}\", File: \"${filename}\""
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "errorType" : {
                    "displayName" : "errorType",
                    "identifiesControllerService" : false,
                    "name" : "errorType",
                    "sensitive" : false
                  },
                  "errorMessage" : {
                    "displayName" : "errorMessage",
                    "identifiesControllerService" : false,
                    "name" : "errorMessage",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                "name" : "Check For Abort",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -344.0,
                  "y" : 296.0
                },
                "properties" : {
                  "Cache Entry Identifier" : "abort-${sourceBatchId}",
                  "Put Cache Value In Attribute" : "abortedReason",
                  "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                  "Max Length To Put In Attribute" : "256",
                  "Character Set" : "UTF-8"
                },
                "propertyDescriptors" : {
                  "Cache Entry Identifier" : {
                    "displayName" : "Cache Entry Identifier",
                    "identifiesControllerService" : false,
                    "name" : "Cache Entry Identifier",
                    "sensitive" : false
                  },
                  "Put Cache Value In Attribute" : {
                    "displayName" : "Put Cache Value In Attribute",
                    "identifiesControllerService" : false,
                    "name" : "Put Cache Value In Attribute",
                    "sensitive" : false
                  },
                  "Distributed Cache Service" : {
                    "displayName" : "Distributed Cache Service",
                    "identifiesControllerService" : true,
                    "name" : "Distributed Cache Service",
                    "sensitive" : false
                  },
                  "Max Length To Put In Attribute" : {
                    "displayName" : "Max Length To Put In Attribute",
                    "identifiesControllerService" : false,
                    "name" : "Max Length To Put In Attribute",
                    "sensitive" : false
                  },
                  "Character Set" : {
                    "displayName" : "Character Set",
                    "identifiesControllerService" : false,
                    "name" : "Character Set",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.FetchDistributedMapCache",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "2c992409-cd63-3aa0-ac43-e944a7cc6c89",
                "name" : "Log Error Message",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 120.0,
                  "y" : 1952.0
                },
                "properties" : {
                  "log-message" : "${errorType}: ${errorMessage}",
                  "log-level" : "error",
                  "log-prefix" : "Interop FHIR Adapter - "
                },
                "propertyDescriptors" : {
                  "log-message" : {
                    "displayName" : "Log message",
                    "identifiesControllerService" : false,
                    "name" : "log-message",
                    "sensitive" : false
                  },
                  "log-level" : {
                    "displayName" : "Log Level",
                    "identifiesControllerService" : false,
                    "name" : "log-level",
                    "sensitive" : false
                  },
                  "log-prefix" : {
                    "displayName" : "Log prefix",
                    "identifiesControllerService" : false,
                    "name" : "log-prefix",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.LogMessage",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "7a8b0313-2447-3878-b428-63779a81cfe7",
                "name" : "Handle POST Bundle FHIR Response",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : -336.0,
                  "y" : 72.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.commons.io.IOUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.util.StandardValidators\nimport groovy.json.JsonSlurper\n\n\n/**\n * For \"Handle POST Bundle FHIR Response\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Handle Resource Bundle\"\n *  Note: If a bundle is in batch transaction, then it is a delete bundle since only bundles with delete entries may be converted to batch transaction type.\n *  \n *  1. If code is 2xx and not a batch, handle FHIR + JSON content type and send to Output\n *  2. If code is 2xx and a batch with no errors, handle FHIR + JSON content type and send to Output\n *  3. If code is 2xx and a batch with errors, handle FHIR + JSON content type, set invokehttp.status.code to 400, set invokehttp.status.message to \"Bundle has errors\" and send to Output\n *  4. If it is a batch with code 400 or 422,  handle FHIR + JSON content type and send to Output\n *  5. Anything else is removed.\n *  \n */\nclass ProcessResponseFromPostBundle extends AbstractProcessor {\n    \n    private static final String [] CONTENT_TYPE_ATTRS = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n    \n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n    public static final Relationship REL_OUTPUT = new Relationship.Builder()\n    .name(\"output\")\n    .description(\"Flowfile sent on for further processing\")\n    .build()\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_OUTPUT] as Set\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    /**\n     * Reads the content\n     */\n    class ContentReader implements InputStreamCallback {\n        String content = null;\n        \n        public ContentReader() {\n            super()\n        }\n        \n        public def getContent() {\n            return this.content\n        }\n        \n        @Override\n        void process(InputStream instream) throws IOException {\n            this.content = IOUtils.toString(instream, \"UTF-8\")\n        }\n    \n    }\n    \n    \n    /**\n     * Sets all the content type and mime type attributes from fhir+json to json\n     * @param session\n     * @param flowFile\n     * @return\n     */\n    private FlowFile handleFHIRJSonContentType(ProcessSession session, FlowFile flowFile) {\n        for (String attrName : CONTENT_TYPE_ATTRS) {\n            String attr = flowFile.getAttribute(attrName)\n            if ( attr != null ) {\n                flowFile = session.putAttribute(flowFile, attrName, attr.replace(\"fhir+json\",\"json\"))\n            }\n        }\n        \n        return flowFile\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        List<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n        if (flowFiles == null) {\n            return\n        }\n\n        for (FlowFile aFlowFile : flowFiles) {\n            String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n            String bundleIsBatch = aFlowFile.getAttribute(\"bundleIsBatch\")\n            \n            // If code is 2xx or a batch with 400 or 422, handle FHIR + JSON content type\n            if ((httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3) ||\n                ((bundleIsBatch && bundleIsBatch.equalsIgnoreCase(\"true\")) && (httpStatusCode.equals(\"400\") || httpStatusCode.equals(\"422\")))) {\n                aFlowFile = handleFHIRJSonContentType(session, aFlowFile)\n                \n                // If code 2xx and a batch with errors, set invokehttp.status.code to 400, set invokehttp.status.message to \"Bundle has errors\"\n                if (httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3 && bundleIsBatch && bundleIsBatch.equalsIgnoreCase(\"true\")) {\n                    // Check if content has errors\n                    ContentReader reader = new ContentReader()\n                    session.read(aFlowFile, reader)\n                    if (reader.getContent() && reader.getContent().find(\"\\\"severity\\\"\\\\s*:\\\\s*(\\\"error\\\")|(\\\"fatal\\\")\") != null) {\n                        aFlowFile = session.putAllAttributes(aFlowFile, [\"invokehttp.status.code\": \"400\", \"invokehttp.status.message\": \"Bundle has errors\"])\n                    }\n                } \n                \n                session.transfer(aFlowFile, REL_OUTPUT)\n            } else {\n                // remove from flow - handled elsewhere in flow\n                session.remove(aFlowFile)\n            }\n        }\n     }\n}\n\nprocessor = new ProcessResponseFromPostBundle()\n\n",
                  "Number of flowfiles to pull" : "100"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Number of flowfiles to pull" : {
                    "displayName" : "Number of flowfiles to pull",
                    "identifiesControllerService" : false,
                    "name" : "Number of flowfiles to pull",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "e6b79ecc-b79a-3068-9028-1bde2a52a7cf",
                "name" : "Handle No Retry",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : 576.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n\n/**\n * For \"Handle No Retry\" processor in \"Send to FHIR and Post Errors\" >> \"Save to FHIR\" >> \"Handle Resource Bundle\"\n *\n * Will send to split relationship if error code 400/422 and does not have delete requests.\n * Will send to split relationship if error code is 409.\n * If error code 400/422 and has delete requests, will set bundle tranaction type to batch to Retry on Batch. If already converted to batch, then will be removed from flow.\n * If code is 404, will send to rety relationship.\n * If code is 401, will sent to Stop Processing relationship.\n * Other error codes will be sent to the Other Error relationship. \n * If an exception happens, the flow file will be sent to the failure relationship\n * \n */\n\nclass HandleNoRetryAfterPostBundle extends AbstractProcessor {\n\n    public static final Relationship REL_BATCH_RETRY = new Relationship.Builder()\n    .name(\"Retry as batch\")\n    .description(\"Retry the bundle in batch mode\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"If there was a failure updating the resource bundle to batch mode, the FlowFile will routed to this relationship\")\n    .build()\n\n    public static final Relationship REL_SPLIT = new Relationship.Builder()\n    .name(\"split\")\n    .description(\"The bundle should be split up to try each bundle entry individually\")\n    .build()\n\n    public static final Relationship REL_RETRY = new Relationship.Builder()\n    .name(\"retry\")\n    .description(\"Retry sending the bundle to the FHIR server\")\n    .build()\n\n    public static final Relationship REL_STOP_PROCESSING = new Relationship.Builder()\n    .name(\"Stop processing\")\n    .description(\"No more post attempts should be made to the FHIR server\")\n    .build()\n\n    public static final Relationship REL_OTHER_FHIR_ERROR = new Relationship.Builder()\n    .name(\"Other FHIR Error\")\n    .description(\"Some other error occurred with the FHIR server\")\n    .build()\n\n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_BATCH_RETRY, REL_FAILURE, REL_SPLIT, REL_RETRY, REL_STOP_PROCESSING, REL_OTHER_FHIR_ERROR] as Set\n    }\n\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n\n    /**\n     * Updates the bundle to use batch transaction\n     */\n    public class BundleToBatch extends StreamCallback {\n\n        public BundleToBatch() {\n            super()\n        }\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            JsonSlurper jsonSlurper = new JsonSlurper()\n            Map bundleJson = jsonSlurper.parse(instream, \"UTF-8\")\n\n            bundleJson.putAt(\"type\", \"batch\")\n\n            outstream.write(JsonOutput.toJson(bundleJson).getBytes(StandardCharsets.UTF_8))\n        }\n\n    }\n\n\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        ArrayList<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n\n        if (!flowFiles)\n            return\n\n        for (FlowFile aFlowFile : flowFiles) {\n            String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n\n            // if 404 error, send to retry relationship\n            if (httpStatusCode.equals(\"404\")) {\n                session.transfer(aFlowFile, REL_RETRY)\n                continue\n            }\n\n            // if 401 error, send to Stop Processing relationship\n            if (httpStatusCode.equals(\"401\")) {\n                session.transfer(aFlowFile, REL_STOP_PROCESSING)\n                continue\n            }\n\n            // If 409 error, send to split relationship\n            if (httpStatusCode.equals(\"409\")) {\n                session.transfer(aFlowFile, REL_SPLIT)\n                continue;\n            }\n                \n            if (httpStatusCode.equals(\"400\") || httpStatusCode.equals(\"422\")) {\n\n                // If bundle is already set to batch (delete requests failed in transaction mode and failed again in batch), remove from flow\n                String bundleIsBatch = aFlowFile.getAttribute(\"bundleIsBatch\")\n                if (bundleIsBatch && bundleIsBatch.equalsIgnoreCase(\"true\")) {\n                    session.remove(aFlowFile)\n                } else {\n                    // If bundle has delete requests, set the bundle transaction to batch and send to retry as batch\n                    String bundleHasDeleteRequests = aFlowFile.getAttribute(\"bundleHasDeleteRequests\")\n                    if (bundleHasDeleteRequests && bundleHasDeleteRequests.equalsIgnoreCase(\"true\")) {\n\n                        try {\n                            BundleToBatch writer = new BundleToBatch();\n                            aFlowFile = session.write(aFlowFile, writer)\n\n                            aFlowFile = session.putAttribute(aFlowFile, \"bundleIsBatch\",\"true\")\n                            session.transfer(aFlowFile, REL_BATCH_RETRY)\n                        } catch (Exception e) {\n                            aFlowFile = session.putAllAttributes(aFlowFile, [\"invokehttp.status.code\":\"400\", \"invokehttp.status.message\": \"Update bundle failed\"])\n                            getLogger().error(\"Interop FHIR Adapter - Exception updating bundle to batch mode. Bundle Id: {}, FlowFile UUID: {}\",\n                                              [aFlowFile.getAttribute(\"resourceId\"), aFlowFile.getAttribute(\"uuid\")] as Object[],\n                                              e)\n                            session.transfer(aFlowFile, REL_FAILURE)\n                        }\n\n                    } else {\n                        // Send to split relationship\n                        session.transfer(aFlowFile, REL_SPLIT)\n                    }\n                }\n\n                continue\n            }\n\n            // if other error, send to Other Error relationship\n            session.transfer(aFlowFile, REL_OTHER_FHIR_ERROR)\n\n        }\n    }\n\n}\n\nprocessor = new HandleNoRetryAfterPostBundle()\n\n",
                  "Number of flowfiles to pull" : "100"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Number of flowfiles to pull" : {
                    "displayName" : "Number of flowfiles to pull",
                    "identifiesControllerService" : false,
                    "name" : "Number of flowfiles to pull",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "1b21ae63-604c-3266-97d4-ec0a7f9ce426",
                "name" : "Get Bundle entries failed",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 120.0,
                  "y" : 1680.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "errorType" : "Get Bundle entries failed",
                  "errorMessage" : "ResourceType: \"${resourceType}\", ResourceId: \"${resourceId}\", File: \"${filename}\""
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "errorType" : {
                    "displayName" : "errorType",
                    "identifiesControllerService" : false,
                    "name" : "errorType",
                    "sensitive" : false
                  },
                  "errorMessage" : {
                    "displayName" : "errorMessage",
                    "identifiesControllerService" : false,
                    "name" : "errorMessage",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "540a0c86-47a1-3fe6-958f-43d497b2d117",
                "name" : "Rebuild Bundle",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : -288.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Rebuild Bundle\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Handle Resource Bundle\"\n *\n * Rebuilds the bundle so the appropriate post or put calls are made for FHIR resources in the entry array.\n * The fullURL field will be preserved on the bundle entry with a resource.\n * If the request is to Delete, then the entry is left as is.\n * If there isn't a FHIR resource in the entry for a non-delete request, an validation error is generated in an Operation Outcome,\n *  status code 400, status message Update bundle failed, and sent to the failure relationship.\n *\n * This class also adds the batch id tag in the FHIR resource's metadata for each entry if the FHIRResourceTag attribute is set.\n */\n\n/**\n * Class that handles generating the bundle\n */\npublic class RebuildBundle implements StreamCallback {\n    private FlowFile theFlowFile = null\n    private boolean hasValidationErrors = false\n    private boolean hasDeletes = false\n    private String bundleId = null\n\n    public RebuildBundle(FlowFile theFlowFile) {\n        super();\n        this.theFlowFile = theFlowFile\n    }\n\n    public boolean hasValidationErrors() {\n        return hasValidationErrors;\n    }\n\n    public boolean hasDeletes() {\n        return hasDeletes;\n    }\n    \n    public String getBundleId() {\n        return bundleId\n    }\n\n\n    @Override\n    void process(InputStream instream, OutputStream outstream) throws IOException {\n        def jsonSlurper = new JsonSlurper()\n        Map inputFHIRResource = jsonSlurper.parse(instream, \"UTF-8\")\n        def fhirResourceTag = this.theFlowFile.getAttribute(\"FHIRResourceTag\")\n\n        Map outputFHIRResource = processJson(inputFHIRResource, fhirResourceTag)\n\n        outstream.write(JsonOutput.toJson(outputFHIRResource).getBytes(StandardCharsets.UTF_8))\n    }\n\n    public Map processJson(Map inputFHIRResource, def fhirResourceTag) {\n        // need to rebuild the resource bundle with type transaction.\n        Map outputFHIRResource = [:]\n\n        if (inputFHIRResource.getAt(\"resourceType\") == \"Bundle\") {\n            // recreate the bundle resource\n            outputFHIRResource.putAt(\"resourceType\", \"Bundle\")\n            outputFHIRResource.putAt(\"type\", \"transaction\")\n\n            // Determine bundle id.  Id could be in resource or provided as attribute.  Hotfix for trex\n            if (inputFHIRResource.containsKey(\"id\")) {\n                bundleId = inputFHIRResource.getAt(\"id\")\n            } else {\n                bundleId = this.theFlowFile.getAttribute(\"resourceId\")\n            }\n\n            // Set the resource id if provided.\n            if (bundleId)\n                outputFHIRResource.putAt(\"id\", bundleId)\n            \n            // build the new entry list by grabbing the resource and setting the request\n            def newEntryList = []\n            Map validationErrors = null\n            int entryCount = 0\n\n            for (Map anEntry: inputFHIRResource.getAt(\"entry\")) {\n                Map newEntry = [:]\n                boolean isDeleteEntry = false\n\n                // Flag if this is a delete entry\n                if (anEntry.containsKey(\"request\")) {\n                    def requestEntry = anEntry.getAt(\"request\")\n                    if (requestEntry.getAt(\"method\") == \"DELETE\") {\n                        newEntry.putAt(\"request\", requestEntry)\n                        isDeleteEntry = true\n                        this.hasDeletes = true\n                        newEntryList.add(newEntry)\n                    }\n                }\n\n                // If this isn't a delete entry, grab the resource and set to put/post request and add to the entry array\n                if (!isDeleteEntry) {\n                    if (anEntry.containsKey(\"resource\")) {\n                        // Only do the work if there are no validation errors\n                        if (validationErrors == null) {\n                            // Preserve the fullUrl if set\n                            if (anEntry.containsKey(\"fullUrl\")) {\n                                newEntry.putAt(\"fullUrl\", anEntry.getAt(\"fullUrl\"))\n                            } \n\n                            newEntry.putAt(\"resource\", anEntry.getAt(\"resource\"))\n\n                            Map requestEntry = [:]\n                            Map resource = newEntry.getAt(\"resource\")\n                            def resourceType = resource.getAt(\"resourceType\")\n\n                            if (resource.containsKey(\"id\"))\n                                requestEntry = [\"method\": \"PUT\", \"url\": resourceType + '/' + resource.getAt(\"id\")]\n                            else\n                                requestEntry = [\"method\": \"POST\", \"url\": resourceType]\n\n                            newEntry.putAt(\"request\", requestEntry)\n\n                            // Add FHIRResourceTag if set\n                            if (fhirResourceTag) {\n                                resource = addTagToResource(resource, fhirResourceTag)\n                            }\n\n                            newEntry.putAt(\"resource\", resource)\n                            \n                            newEntryList.add(newEntry)\n                        } // End of validationErrors == null\n                    } else {\n                        if (validationErrors == null) {\n                            validationErrors = [:]\n                            validationErrors.putAt(\"resourceType\", \"OperationOutcome\")\n                            validationErrors.putAt(\"issue\", [])\n                        }\n\n                        Map newIssue = [:]\n                        newIssue.putAt(\"severity\", \"error\")\n                        newIssue.putAt(\"code\", \"required\")\n                        newIssue.putAt(\"details\", [\"text\" : \"The Interop FHIR Adapter requires each entry in a Bundle to have a resource unless the entry request is DELETE\"])\n                        newIssue.putAt(\"expression\", [\"Bundle.entry[\" + entryCount + \"]\"])\n                        validationErrors.getAt(\"issue\").add(newIssue)\n                    }\n                } //  end if ! isDeleteEntry\n\n                entryCount += 1\n            } // end entry array iteration\n\n            if (validationErrors == null)\n                outputFHIRResource.putAt(\"entry\", newEntryList)\n            else {\n                outputFHIRResource = validationErrors\n                this.hasValidationErrors = true\n            }\n        } else {\n            // not a resource bundle, just pass it along\n            outputFHIRResource = inputFHIRResource\n        }\n\n        return outputFHIRResource\n    }\n\n    /**\n     * Adds the given tag to the FHIR resource.  If the meta or tag fields do not exist, they will be created.\n     * @param fhirResource\n     * @param fhirResourceTag\n     * @return\n     */\n    private Map addTagToResource(Map fhirResource, String fhirResourceTag) {\n        if (fhirResourceTag) {\n            String CODE_SYSTEM=\"http://ibm.com/fhir/cdm/StructureDefinition/ingestion-batch-id\"\n\n            def fhirTag=[system:CODE_SYSTEM,code:fhirResourceTag]\n\n            // create 'meta' element if is doesn't exist\n            // NOTE: this appends property 'meta' to end of list. (least expensive option)\n            fhirResource.putIfAbsent(\"meta\", [:] )\n\n            // Create empty tag array if it doesn't exist.\n            Map metaMap = fhirResource.getAt(\"meta\")\n            metaMap.putIfAbsent(\"tag\", [])\n\n            def tagArray = metaMap.get(\"tag\")\n\n            // search for an existing entry with same CODE_SYSTEM\n            def existingEntry = tagArray.find { tagArrayEntry -> tagArrayEntry.getAt(\"system\") == CODE_SYSTEM }\n            if ( ! existingEntry ) {\n                // NOT FOUND - add a new entry to tagArray\n                tagArray.add(fhirTag)\n            } else {\n                // There was an array entry for our code system - set value\n                existingEntry.putAt(\"code\", fhirResourceTag)\n            }\n\n        }\n\n        return fhirResource\n    }\n}\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null) {\n    return\n}\n\nfor (FlowFile aFlowFile : flowFiles) {\n    RebuildBundle writer = new RebuildBundle(aFlowFile);\n    aFlowFile = session.write(aFlowFile, writer)\n\n    aFlowFile = session.putAttribute(aFlowFile, \"bundleId\", writer.getBundleId())\n\n    if (writer.hasValidationErrors()) {\n        aFlowFile = session.putAllAttributes(aFlowFile, [\"mime.type\": \"application/json\", \"invokehttp.status.code\": \"400\", \"invokehttp.status.message\": \"Update bundle failed\"])\n        log.warn('Interop FHIR Adapter - Update bundle failed validation: BundleId: {}', [aFlowFile.getAttribute(\"bundleId\")] as Object[])\n        session.transfer(aFlowFile, REL_FAILURE)\n    } else {\n        if (writer.hasDeletes())\n            aFlowFile = session.putAttribute(aFlowFile, \"bundleHasDeleteRequests\", \"true\")\n        session.transfer(aFlowFile, REL_SUCCESS)\n    }\n\n}\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "29471849-930f-3e53-a7b7-305d44813f0d",
                "identifier" : "90c045b9-99d0-39a8-a75c-d8641d50e707",
                "name" : "Get Resource From Entry",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 520.0,
                  "y" : 1360.0
                },
                "properties" : {
                  "Destination" : "flowfile-content",
                  "resource" : "$.resource",
                  "Return Type" : "auto-detect",
                  "Null Value Representation" : "empty string",
                  "Path Not Found Behavior" : "ignore"
                },
                "propertyDescriptors" : {
                  "Destination" : {
                    "displayName" : "Destination",
                    "identifiesControllerService" : false,
                    "name" : "Destination",
                    "sensitive" : false
                  },
                  "resource" : {
                    "displayName" : "resource",
                    "identifiesControllerService" : false,
                    "name" : "resource",
                    "sensitive" : false
                  },
                  "Return Type" : {
                    "displayName" : "Return Type",
                    "identifiesControllerService" : false,
                    "name" : "Return Type",
                    "sensitive" : false
                  },
                  "Null Value Representation" : {
                    "displayName" : "Null Value Representation",
                    "identifiesControllerService" : false,
                    "name" : "Null Value Representation",
                    "sensitive" : false
                  },
                  "Path Not Found Behavior" : {
                    "displayName" : "Path Not Found Behavior",
                    "identifiesControllerService" : false,
                    "name" : "Path Not Found Behavior",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
                "yieldDuration" : "1 sec"
              } ],
              "remoteProcessGroups" : [ ],
              "variables" : { }
            }, {
              "comments" : "",
              "componentType" : "PROCESS_GROUP",
              "connections" : [ {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1664.0,
                  "y" : 528.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "c4f3d5df-5443-3476-841b-0745099a3fdd",
                  "name" : "No Retry",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "1c7f2dc5-c97c-3eab-ab17-32864634fc25",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "cb7b4b25-9848-3697-822b-eca3e87ce2a0",
                  "name" : "No Retry",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1064.0,
                  "y" : 536.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "4be6a445-791a-3a7b-a576-cf46762dffaf",
                  "name" : "Retry",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "7b53d9f3-1b86-3c08-8b9e-e4711591b991",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "e7240313-52bf-3750-9e78-0acdfab68bcf",
                  "name" : "Retry",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 664.0,
                  "y" : 464.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "cd4f272d-f19c-3661-827d-15aa5163db8b",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "ed95509b-bc06-333c-b884-4fddc05babfb",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "79f26f21-854a-33a5-aa70-797420c73239",
                  "name" : "Retry",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "bcb9bd5b-1e79-3242-b318-9c459d2838cc",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "401fc18c-f5a2-3f4b-9fa5-747f29d77e9a",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "id" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 2144.0,
                  "y" : 1728.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "ae812c70-d7cf-3d6e-915c-1cb07aa2b2ca",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "a8e4242b-907b-311a-9eb3-8f24ef872ddd",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "output" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "96b5633d-4ca4-3a8b-8f47-1fb692f651c3",
                  "name" : "Handle PUT Resource FHIR Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "84bb932b-31e1-3b4d-b66f-33992802c9dc",
                  "name" : "Aborted",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "50080064-4702-3c54-acc3-9c27d51b4f95",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "83aee767-e5a6-306e-bfeb-229e373b78c1",
                  "name" : "Aborted",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 752.0,
                  "y" : 1112.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "bcb9bd5b-1e79-3242-b318-9c459d2838cc",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "0a6bc914-713f-3402-b7f0-98065d33db0d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "e05496e3-21da-374b-a5e8-886ef5a85571",
                  "name" : "Failure",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "id" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                  "name" : "Input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "9777d3cb-87c8-3e5e-b21a-68fd5b21fb63",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "2ea27690-536f-3215-a768-2d726d1f9438",
                  "name" : "Stop Processing",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "ae812c70-d7cf-3d6e-915c-1cb07aa2b2ca",
                  "name" : "Output",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "b9c5e224-2895-3596-8add-c0d14c582b9b",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "bcb9bd5b-1e79-3242-b318-9c459d2838cc",
                  "name" : "Clear Flow File Contents",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "96b5633d-4ca4-3a8b-8f47-1fb692f651c3",
                  "name" : "Handle PUT Resource FHIR Response",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "ecd82d7f-129a-394b-b732-56185ff6f22d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "9615a29a-260d-3ba7-8fe0-86d5180b9287",
                  "name" : "Response",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "59818383-04cf-3170-9949-49ff171e76a3",
                  "name" : "Add Tag to Resource",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "1781d685-3803-3954-97b6-632df5546733",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "ef9c7dbc-e05a-3b42-a60b-a7316f06721f",
                  "name" : "Input",
                  "type" : "INPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1336.0,
                  "y" : 536.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "id" : "4f47f394-65a2-3b57-bc8e-c113afb13bb2",
                  "name" : "Failure",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "2fe78047-e88e-35ea-9493-e72546d6fcf4",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "180f8656-80ab-3d74-bd0c-856678d61fab",
                  "name" : "Failure",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1896.0,
                  "y" : 1128.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "id" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                  "name" : "Input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "ce908375-0695-3815-8106-bd5647d0062b",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "stop" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "96b5633d-4ca4-3a8b-8f47-1fb692f651c3",
                  "name" : "Handle PUT Resource FHIR Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "id" : "cd4f272d-f19c-3661-827d-15aa5163db8b",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "3d229e0e-3ddf-324c-b782-a06cfc1dfc1b",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                  "id" : "59818383-04cf-3170-9949-49ff171e76a3",
                  "name" : "Add Tag to Resource",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              } ],
              "controllerServices" : [ ],
              "flowFileConcurrency" : "UNBOUNDED",
              "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
              "funnels" : [ ],
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
              "inputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "INPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "ef9c7dbc-e05a-3b42-a60b-a7316f06721f",
                "name" : "Input",
                "position" : {
                  "x" : 1080.0,
                  "y" : -288.0
                },
                "type" : "INPUT_PORT"
              } ],
              "labels" : [ {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 24.0,
                "identifier" : "b4bbcf4d-3729-30e5-8121-962d978579c5",
                "label" : "All Codes",
                "position" : {
                  "x" : 1648.0,
                  "y" : 296.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 72.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 104.0,
                "identifier" : "d3b649ba-9e26-3f7c-aa11-3c612459e29a",
                "label" : "If OperationOutcome is in content, sets content-type/mime.type to application/json\nFilters out 5XX and 409 codes.\nFilters out 404 code if doesn't have OperationOutcome in content.\nIf 401 code, clears out content and sends to stop.\nAll other codes with no OO, content is cleared and sent to output.\n",
                "position" : {
                  "x" : 2360.0,
                  "y" : 312.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 472.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 24.0,
                "identifier" : "ec4df7cf-2e73-3b63-820b-6b6580d3b7d1",
                "label" : "1xx, 3xx, 4xx codes",
                "position" : {
                  "x" : 1648.0,
                  "y" : 464.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 128.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 24.0,
                "identifier" : "6442b1f3-acc1-3096-8bf8-68fff6f1270e",
                "label" : "General Errors",
                "position" : {
                  "x" : 1368.0,
                  "y" : 480.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 96.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 72.0,
                "identifier" : "ee606748-1f25-3642-82dd-5d61ba93d4a4",
                "label" : "If the FHIRResourceTag attribute is set, adds a metadata tag to the resource with the following:\nCodeSystem = \"http://ibm.com/fhir/cdm/StructureDefinition/ingestion-batch-id\"\nCode = value of the FHIRResourceTag attribute",
                "position" : {
                  "x" : 1432.0,
                  "y" : 160.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 552.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 24.0,
                "identifier" : "91315e42-0bb7-3737-96b8-f94c606e4b96",
                "label" : "No OperationOutcomes will be in FlowFiles here",
                "position" : {
                  "x" : 1352.0,
                  "y" : 1360.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 312.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 64.0,
                "identifier" : "8baad66d-d5cb-307a-83f1-397904590bbe",
                "label" : "Retry 404 error with no OO.\nRetry 409 error, don't abort batch.\n\nFilter out the rest.",
                "position" : {
                  "x" : 1592.0,
                  "y" : 584.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 224.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "height" : 24.0,
                "identifier" : "70b00b34-e54c-3c02-ad9f-023683828813",
                "label" : "5xx codes",
                "position" : {
                  "x" : 944.0,
                  "y" : 480.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 88.0
              } ],
              "name" : "Put Resource to FHIR",
              "outputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "84bb932b-31e1-3b4d-b66f-33992802c9dc",
                "name" : "Aborted",
                "position" : {
                  "x" : 256.0,
                  "y" : 752.0
                },
                "type" : "OUTPUT_PORT"
              }, {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "ae812c70-d7cf-3d6e-915c-1cb07aa2b2ca",
                "name" : "Output",
                "position" : {
                  "x" : 1080.0,
                  "y" : 1704.0
                },
                "type" : "OUTPUT_PORT"
              } ],
              "parameterContextName" : "cms_adapter_parameters",
              "position" : {
                "x" : 2048.0,
                "y" : 240.0
              },
              "processGroups" : [ {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                    "name" : "Check NoRetry Flag",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "65296729-e70b-31b2-baa7-13158b93879c",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "5f2ba238-14a4-3a6d-bb16-acaed8fe008c",
                    "name" : "Retry 404/409 Error",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                    "name" : "Check NoRetry Flag",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "a8b81db2-d088-3913-b5e4-4f883dfd19ae",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "4be6a445-791a-3a7b-a576-cf46762dffaf",
                    "name" : "Retry",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ {
                    "x" : -16.0,
                    "y" : 1520.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "d3e7cd86-296d-3d74-9701-41ddf65c8b56",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c3d12e48-37bd-3f29-9238-f4d011c86aad",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "0e51b58a-2cc5-3755-8b45-7fec92f5b122",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c647e272-c827-30b0-812d-7f9575c03bed",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c6b95821-46b1-3ec7-8856-76f1498b76b0",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "noRetry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                    "name" : "Check NoRetry Flag",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "5f2ba238-14a4-3a6d-bb16-acaed8fe008c",
                    "name" : "Retry 404/409 Error",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "4707e25f-c2a1-3273-adac-f5db968947c2",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c4f3d5df-5443-3476-841b-0745099a3fdd",
                    "name" : "No Retry",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "79f26f21-854a-33a5-aa70-797420c73239",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "d1d9d88b-3288-39ca-a088-1a00a0ea9c4f",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "not-found", "failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "d3e7cd86-296d-3d74-9701-41ddf65c8b56",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "cb832e11-4f17-38bc-8c9d-7a3b326aaeab",
                    "name" : "RetryFlowFile for 409",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "35b8eb8c-57b8-3cde-9361-a4e5f8ec9c84",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "6d027521-c28d-316a-868e-128711ef58c0",
                    "name" : "Jitter Retry",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "e05496e3-21da-374b-a5e8-886ef5a85571",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "e9849efb-4330-3457-8921-fbc3e15ac287",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "abf32b32-762e-3d4c-aa23-bc4e27ea0726",
                    "name" : "Log Retry Failure",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c647e272-c827-30b0-812d-7f9575c03bed",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "b6a0d079-f855-3afc-9e42-42a22304e6eb",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retries_exceeded" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "cb832e11-4f17-38bc-8c9d-7a3b326aaeab",
                    "name" : "RetryFlowFile for 409",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "6d027521-c28d-316a-868e-128711ef58c0",
                    "name" : "Jitter Retry",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c5d83f6c-3a81-34d6-aac0-f73438218988",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "PARTITION_BY_ATTRIBUTE",
                  "name" : "",
                  "partitioningAttribute" : "resourceTypeAndId",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry 409" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "5f2ba238-14a4-3a6d-bb16-acaed8fe008c",
                    "name" : "Retry 404/409 Error",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "abf32b32-762e-3d4c-aa23-bc4e27ea0726",
                    "name" : "Log Retry Failure",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "f02eb1f9-b936-3bd9-80f6-39b63195ce70",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "0e51b58a-2cc5-3755-8b45-7fec92f5b122",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ {
                    "x" : 1623.451416015625,
                    "y" : 752.0
                  }, {
                    "x" : 1623.451416015625,
                    "y" : 800.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "6d027521-c28d-316a-868e-128711ef58c0",
                    "name" : "Jitter Retry",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "b0ffa0ca-6928-3f26-9823-e11c4d42cb3c",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Yield" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "6d027521-c28d-316a-868e-128711ef58c0",
                    "name" : "Jitter Retry",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "00431b42-b47d-3172-947c-317cc1d955cd",
                    "name" : "Update FHIR Error Message",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "b578d966-1387-3a18-b0ce-f6176638debd",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "not-found", "failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c647e272-c827-30b0-812d-7f9575c03bed",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ {
                    "x" : 264.0,
                    "y" : 1024.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "83aee767-e5a6-306e-bfeb-229e373b78c1",
                    "name" : "Aborted",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "cad7be32-28fa-3472-a4da-8b0427803c33",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c647e272-c827-30b0-812d-7f9575c03bed",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "2ea27690-536f-3215-a768-2d726d1f9438",
                    "name" : "Stop Processing",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "6c1abb7a-4b10-319f-97f3-cc48619c4af6",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "00431b42-b47d-3172-947c-317cc1d955cd",
                    "name" : "Update FHIR Error Message",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "0e51b58a-2cc5-3755-8b45-7fec92f5b122",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "f0e2a2d9-f905-3f95-a30a-5081f76794fd",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "unmatched" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                    "name" : "Check NoRetry Flag",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "83aee767-e5a6-306e-bfeb-229e373b78c1",
                    "name" : "Aborted",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "f1ff77b7-ae52-3fda-b1a9-c8ef6094e796",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "d3e7cd86-296d-3d74-9701-41ddf65c8b56",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ {
                    "x" : 1271.451416015625,
                    "y" : 1520.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "d3e7cd86-296d-3d74-9701-41ddf65c8b56",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c6abfe90-4c01-317f-a9ce-6b617903da0c",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "cb832e11-4f17-38bc-8c9d-7a3b326aaeab",
                    "name" : "RetryFlowFile for 409",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                    "name" : "Check NoRetry Flag",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "18eb7346-4aeb-3868-8146-7537ebc8f253",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "4f47f394-65a2-3b57-bc8e-c113afb13bb2",
                    "name" : "Failure",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "c647e272-c827-30b0-812d-7f9575c03bed",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "48156422-73a0-3038-84ed-72e7405ea04f",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retries_exceeded" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                    "id" : "0e51b58a-2cc5-3755-8b45-7fec92f5b122",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c4f3d5df-5443-3476-841b-0745099a3fdd",
                  "name" : "No Retry",
                  "position" : {
                    "x" : 1152.0,
                    "y" : 200.0
                  },
                  "type" : "INPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "4be6a445-791a-3a7b-a576-cf46762dffaf",
                  "name" : "Retry",
                  "position" : {
                    "x" : 280.0,
                    "y" : 192.0
                  },
                  "type" : "INPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "4f47f394-65a2-3b57-bc8e-c113afb13bb2",
                  "name" : "Failure",
                  "position" : {
                    "x" : 640.0,
                    "y" : 192.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 32.0,
                  "identifier" : "fc066568-2063-3471-8f82-fd8969ed52da",
                  "label" : "404 error retry",
                  "position" : {
                    "x" : 872.0,
                    "y" : 408.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 104.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 24.0,
                  "identifier" : "02b72027-cea4-325c-afac-ff22768c9f40",
                  "label" : "1xx, 3xx, 4xx codes",
                  "position" : {
                    "x" : 1216.0,
                    "y" : 152.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 128.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 24.0,
                  "identifier" : "4f4a2c16-2dba-36e4-a87f-79d44e589dd7",
                  "label" : "5xx codes",
                  "position" : {
                    "x" : 352.0,
                    "y" : 144.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 88.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 64.0,
                  "identifier" : "3f3bf9e1-89a9-3d78-a843-7f7526bbe361",
                  "label" : "Retry 404 error with no OO.\nRetry 409 error, don't abort batch.\n\nFilter out the rest.",
                  "position" : {
                    "x" : 1488.0,
                    "y" : 448.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 224.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 24.0,
                  "identifier" : "2af3f371-912a-39b6-912e-515af587c63b",
                  "label" : "General Errors",
                  "position" : {
                    "x" : 720.0,
                    "y" : 144.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 96.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "height" : 56.0,
                  "identifier" : "55bc83a2-e650-3dbc-91f9-180361bb6e2a",
                  "label" : "409 codes want to retry quickly but space out retry attempts for\nflowfiles with same resource type and id to reduce the chance\nof conflict errors.",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 648.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 368.0
                } ],
                "name" : "Handle Put Resource Errors",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "83aee767-e5a6-306e-bfeb-229e373b78c1",
                  "name" : "Aborted",
                  "position" : {
                    "x" : 144.0,
                    "y" : 1232.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "79f26f21-854a-33a5-aa70-797420c73239",
                  "name" : "Retry",
                  "position" : {
                    "x" : 464.0,
                    "y" : 1728.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "e05496e3-21da-374b-a5e8-886ef5a85571",
                  "name" : "Failure",
                  "position" : {
                    "x" : -464.0,
                    "y" : 1728.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "2ea27690-536f-3215-a768-2d726d1f9438",
                  "name" : "Stop Processing",
                  "position" : {
                    "x" : 504.0,
                    "y" : 1232.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "position" : {
                  "x" : 1008.0,
                  "y" : 680.0
                },
                "processGroups" : [ ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "abf32b32-762e-3d4c-aa23-bc4e27ea0726",
                  "name" : "Log Retry Failure",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : -512.0,
                    "y" : 1000.0
                  },
                  "properties" : {
                    "log-message" : "unable to retry PUT to FHIR Server",
                    "log-level" : "error",
                    "log-prefix" : "Interop FHIR Adapter - "
                  },
                  "propertyDescriptors" : {
                    "log-message" : {
                      "displayName" : "Log message",
                      "identifiesControllerService" : false,
                      "name" : "log-message",
                      "sensitive" : false
                    },
                    "log-level" : {
                      "displayName" : "Log Level",
                      "identifiesControllerService" : false,
                      "name" : "log-level",
                      "sensitive" : false
                    },
                    "log-prefix" : {
                      "displayName" : "Log prefix",
                      "identifiesControllerService" : false,
                      "name" : "log-prefix",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.LogMessage",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "0e51b58a-2cc5-3755-8b45-7fec92f5b122",
                  "name" : "RetryFlowFile",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : -184.0,
                    "y" : 688.0
                  },
                  "properties" : {
                    "penalize-retries" : "true",
                    "maximum-retries" : "3",
                    "Fail on Non-numerical Overwrite" : "false",
                    "reuse-mode" : "fail",
                    "retry-attribute" : "putSingleFhirResource.retries"
                  },
                  "propertyDescriptors" : {
                    "penalize-retries" : {
                      "displayName" : "Penalize Retries",
                      "identifiesControllerService" : false,
                      "name" : "penalize-retries",
                      "sensitive" : false
                    },
                    "maximum-retries" : {
                      "displayName" : "Maximum Retries",
                      "identifiesControllerService" : false,
                      "name" : "maximum-retries",
                      "sensitive" : false
                    },
                    "Fail on Non-numerical Overwrite" : {
                      "displayName" : "Fail on Non-numerical Overwrite",
                      "identifiesControllerService" : false,
                      "name" : "Fail on Non-numerical Overwrite",
                      "sensitive" : false
                    },
                    "reuse-mode" : {
                      "displayName" : "Reuse Mode",
                      "identifiesControllerService" : false,
                      "name" : "reuse-mode",
                      "sensitive" : false
                    },
                    "retry-attribute" : {
                      "displayName" : "Retry Attribute",
                      "identifiesControllerService" : false,
                      "name" : "retry-attribute",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RetryFlowFile",
                  "yieldDuration" : "30 sec"
                }, {
                  "autoTerminatedRelationships" : [ "failure" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "cb832e11-4f17-38bc-8c9d-7a3b326aaeab",
                  "name" : "RetryFlowFile for 409",
                  "penaltyDuration" : "1 sec",
                  "position" : {
                    "x" : 1096.0,
                    "y" : 968.0
                  },
                  "properties" : {
                    "penalize-retries" : "true",
                    "maximum-retries" : "10",
                    "Fail on Non-numerical Overwrite" : "false",
                    "reuse-mode" : "fail",
                    "retry-attribute" : "singleFhirResource409.retries"
                  },
                  "propertyDescriptors" : {
                    "penalize-retries" : {
                      "displayName" : "Penalize Retries",
                      "identifiesControllerService" : false,
                      "name" : "penalize-retries",
                      "sensitive" : false
                    },
                    "maximum-retries" : {
                      "displayName" : "Maximum Retries",
                      "identifiesControllerService" : false,
                      "name" : "maximum-retries",
                      "sensitive" : false
                    },
                    "Fail on Non-numerical Overwrite" : {
                      "displayName" : "Fail on Non-numerical Overwrite",
                      "identifiesControllerService" : false,
                      "name" : "Fail on Non-numerical Overwrite",
                      "sensitive" : false
                    },
                    "reuse-mode" : {
                      "displayName" : "Reuse Mode",
                      "identifiesControllerService" : false,
                      "name" : "reuse-mode",
                      "sensitive" : false
                    },
                    "retry-attribute" : {
                      "displayName" : "Retry Attribute",
                      "identifiesControllerService" : false,
                      "name" : "retry-attribute",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RetryFlowFile",
                  "yieldDuration" : "30 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "a3a32a52-526f-3bbc-b9cc-04cd9440f166",
                  "name" : "Check NoRetry Flag",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 451.55546118000916,
                    "y" : 423.35205267131437
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "noRetry" : "${noRetry:notNull():and(${noRetry:equalsIgnoreCase(\"true\")})}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "noRetry" : {
                      "displayName" : "noRetry",
                      "identifiesControllerService" : false,
                      "name" : "noRetry",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-scripting-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "5f2ba238-14a4-3a6d-bb16-acaed8fe008c",
                  "name" : "Retry 404/409 Error",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1096.0,
                    "y" : 440.0
                  },
                  "properties" : {
                    "Script Engine" : "Groovy",
                    "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n\n/**\n * For \"Retry 404/409 Error\" processor in \"Send to FHIR and Post Errors\" >> \"Save to FHIR\" >> \"Put Resource to FHIR\"\n *\n * 1. Sends flowfiles to retry that have 404 error code in invokehttp.status.code and doesn't have an OperationOutcome in the response body attribute.\n * 2. Sends flowfiles to retry 409 that have 409 error code, sets abortBatch attribute to \"false\", creates attribute resourceTypeAndId that combines the resourceType and resourceId\n * \n */\n\nclass Handle404_409PutResourceNoRetry extends AbstractProcessor {\n\n    public static final Relationship REL_RETRY = new Relationship.Builder()\n    .name(\"Retry\")\n    .description(\"Retry sending the resource\")\n    .build()\n\n    public static final Relationship REL_RETRY_409 = new Relationship.Builder()\n    .name(\"Retry 409\")\n    .description(\"Retry from 409 error for shorter retry delay\")\n    .build()\n\n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_RETRY, REL_RETRY_409] as Set\n    }\n\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        ArrayList<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n\n        if (!flowFiles)\n            return\n\n        for (FlowFile aFlowFile : flowFiles) {\n            try {\n                String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n\n                if (httpStatusCode) {\n                    if (httpStatusCode.equals(\"404\")) {\n                        // Check if response contains an OperationOutcome\n                        String responseBody = aFlowFile.getAttribute(\"responseBody\")\n                        if (!responseBody || responseBody.find(\"\\\"resourceType\\\"\\\\s*:\\\\s*\\\"OperationOutcome\\\"\") == null) {\n                            session.transfer(aFlowFile, REL_RETRY)\n                            continue;\n                        }\n                    }\n\n                    if (httpStatusCode.equals(\"409\")) {\n                        String resourceId = aFlowFile.getAttribute(\"resourceId\");\n                        String resourceType = aFlowFile.getAttribute(\"resourceType\");\n                        aFlowFile = session.putAttribute(aFlowFile, \"resourceTypeAndId\", resourceType + \"_\" + resourceId)\n                        session.putAttribute(aFlowFile, \"abortBatch\", \"false\")\n                        session.transfer(aFlowFile, REL_RETRY_409)\n                        continue;\n                    }\n                }\n\n                // Remove all other flowfiles\n                session.remove(aFlowFile)\n            } catch (Exception e) {\n                throw new ProcessException(e)\n            }\n\n        }\n    }\n}\n\nprocessor = new Handle404_409PutResourceNoRetry()\n\n",
                    "Number of flowfiles to pull" : "100"
                  },
                  "propertyDescriptors" : {
                    "Script File" : {
                      "displayName" : "Script File",
                      "identifiesControllerService" : false,
                      "name" : "Script File",
                      "sensitive" : false
                    },
                    "Script Engine" : {
                      "displayName" : "Script Engine",
                      "identifiesControllerService" : false,
                      "name" : "Script Engine",
                      "sensitive" : false
                    },
                    "Script Body" : {
                      "displayName" : "Script Body",
                      "identifiesControllerService" : false,
                      "name" : "Script Body",
                      "sensitive" : false
                    },
                    "Number of flowfiles to pull" : {
                      "displayName" : "Number of flowfiles to pull",
                      "identifiesControllerService" : false,
                      "name" : "Number of flowfiles to pull",
                      "sensitive" : false
                    },
                    "Module Directory" : {
                      "displayName" : "Module Directory",
                      "identifiesControllerService" : false,
                      "name" : "Module Directory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "d3e7cd86-296d-3d74-9701-41ddf65c8b56",
                  "name" : "Check For Abort",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 408.0,
                    "y" : 1456.0
                  },
                  "properties" : {
                    "Cache Entry Identifier" : "abort-${sourceBatchId}",
                    "Put Cache Value In Attribute" : "abortedReason",
                    "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                    "Max Length To Put In Attribute" : "256",
                    "Character Set" : "UTF-8"
                  },
                  "propertyDescriptors" : {
                    "Cache Entry Identifier" : {
                      "displayName" : "Cache Entry Identifier",
                      "identifiesControllerService" : false,
                      "name" : "Cache Entry Identifier",
                      "sensitive" : false
                    },
                    "Put Cache Value In Attribute" : {
                      "displayName" : "Put Cache Value In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Cache Value In Attribute",
                      "sensitive" : false
                    },
                    "Distributed Cache Service" : {
                      "displayName" : "Distributed Cache Service",
                      "identifiesControllerService" : true,
                      "name" : "Distributed Cache Service",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "Character Set" : {
                      "displayName" : "Character Set",
                      "identifiesControllerService" : false,
                      "name" : "Character Set",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.FetchDistributedMapCache",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "failure" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-scripting-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "00431b42-b47d-3172-947c-317cc1d955cd",
                  "name" : "Update FHIR Error Message",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 451.55546118000916,
                    "y" : 935.3520526713144
                  },
                  "properties" : {
                    "Script Engine" : "Groovy",
                    "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.io.IOUtils\n\n/**\n * For \"Update FHIR Error Message\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Put Resource to FHIR\"\n *\n * Sets the invokehttp.status.message attribute to a default message for a code if the message is not set.\n * Prepends the message with FHIR Server\n */\n\nstatusMessageAttributeName = \"invokehttp.status.message\"\n\ncodeMap = [\n  '200': \"OK\",\n  '201': \"Created\",\n  '400': \"Bad Request\",\n  '401': \"Not Authorized\",\n  '404': \"Not Found\",\n  '409': \"Conflict\",\n  '422': \"Unprocessable Entity\",\n  '500': \"Internal Server Error\",\n  '502': \"Bad Gateway\",\n  '503': \"Service Unavailable\",\n  '504': \"Gateway Timeout\"\n]\n\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles != null) {\n    for (FlowFile flowFile : flowFiles) {\n        // Set the HTTP message if it isn't set\n        String originalStatusMessage = flowFile.getAttribute( statusMessageAttributeName)\n        String httpStatusCode = flowFile.getAttribute(\"invokehttp.status.code\")\n        \n        if (httpStatusCode != null) {\n            if (!originalStatusMessage) {\n                String codeMessage = codeMap.get(httpStatusCode)\n                if ( codeMessage != null ) {\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, codeMessage )\n                } else {\n                    // Just create a generic error message\n                    flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"Error \" + httpStatusCode )\n                }\n            }\n        }\n        \n        // Prepend the status message with FHIR Server\n        flowFile = session.putAttribute(flowFile, statusMessageAttributeName, \"FHIR Server - \" + flowFile.getAttribute( statusMessageAttributeName) )\n        \n        session.transfer(flowFile, REL_SUCCESS)\n    }\n}\n\n"
                  },
                  "propertyDescriptors" : {
                    "Script File" : {
                      "displayName" : "Script File",
                      "identifiesControllerService" : false,
                      "name" : "Script File",
                      "sensitive" : false
                    },
                    "Script Engine" : {
                      "displayName" : "Script Engine",
                      "identifiesControllerService" : false,
                      "name" : "Script Engine",
                      "sensitive" : false
                    },
                    "Script Body" : {
                      "displayName" : "Script Body",
                      "identifiesControllerService" : false,
                      "name" : "Script Body",
                      "sensitive" : false
                    },
                    "Module Directory" : {
                      "displayName" : "Module Directory",
                      "identifiesControllerService" : false,
                      "name" : "Module Directory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.script.ExecuteScript",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-scripting-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "6d027521-c28d-316a-868e-128711ef58c0",
                  "name" : "Jitter Retry",
                  "penaltyDuration" : "1 sec",
                  "position" : {
                    "x" : 1096.0,
                    "y" : 720.0
                  },
                  "properties" : {
                    "Script Engine" : "Groovy",
                    "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n\n/**\n * For \"Jitter Retry\" processor in \"Send to FHIR and Post Errors\" >> \"Save to FHIR\" >> \"Put Resource to FHIR\"\n *\n * Sorts the flowfiles by the resourceTypeAndId attribute and sends 1 flowfile per resourceTypeAndId to the Retry relationship.\n * Additional flowfiles with the same resourceTypeAndId will be penalized and put on the yield relationship.\n * \n * It is expected the penalized time will be small on the processor for quick retry attempts. 333 milliseconds for example. \n * \n */\n\nclass JitterRetry extends AbstractProcessor {\n\n    public static final Relationship REL_RETRY = new Relationship.Builder()\n    .name(\"Retry\")\n    .description(\"Send to a Retry processor\")\n    .build()\n\n    public static final Relationship REL_YIELD = new Relationship.Builder()\n    .name(\"Yield\")\n    .description(\"Penalized flowfile and send to itself to wait to continue\")\n    .build()\n\n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_RETRY, REL_YIELD] as Set\n    }\n\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        ArrayList<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n\n        if (!flowFiles)\n            return\n\n        Map<String, List<FlowFile>> sortedFlowFiles = new HashMap<>();\n        \n        for (FlowFile aFlowFile : flowFiles) {\n            String resourceTypeAndId = aFlowFile.getAttribute(\"resourceTypeAndId\")\n            List<FlowFile> sameResourceFlowFiles = sortedFlowFiles.get(resourceTypeAndId);\n            if (sameResourceFlowFiles == null) {\n                sameResourceFlowFiles = new ArrayList<>();\n                sortedFlowFiles.put(resourceTypeAndId, sameResourceFlowFiles)\n            }\n\n            sameResourceFlowFiles.add(aFlowFile)\n        }\n        \n        for (List<FlowFile> sameResourceFlowFiles: sortedFlowFiles.values()) {\n            session.transfer(sameResourceFlowFiles.get(0), REL_RETRY)\n            \n            for (int i = 1; i < sameResourceFlowFiles.size(); i++) {\n                FlowFile yieldFlowFile = session.penalize(sameResourceFlowFiles.get(i))\n                session.transfer(yieldFlowFile, REL_YIELD)\n            }\n        }\n    }\n}\n\nprocessor = new JitterRetry()\n\n",
                    "Number of flowfiles to pull" : "100"
                  },
                  "propertyDescriptors" : {
                    "Script File" : {
                      "displayName" : "Script File",
                      "identifiesControllerService" : false,
                      "name" : "Script File",
                      "sensitive" : false
                    },
                    "Script Engine" : {
                      "displayName" : "Script Engine",
                      "identifiesControllerService" : false,
                      "name" : "Script Engine",
                      "sensitive" : false
                    },
                    "Script Body" : {
                      "displayName" : "Script Body",
                      "identifiesControllerService" : false,
                      "name" : "Script Body",
                      "sensitive" : false
                    },
                    "Number of flowfiles to pull" : {
                      "displayName" : "Number of flowfiles to pull",
                      "identifiesControllerService" : false,
                      "name" : "Number of flowfiles to pull",
                      "sensitive" : false
                    },
                    "Module Directory" : {
                      "displayName" : "Module Directory",
                      "identifiesControllerService" : false,
                      "name" : "Module Directory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "1 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "5b247f51-cbe0-3d8c-a34b-a3d00d47bf50",
                  "identifier" : "c647e272-c827-30b0-812d-7f9575c03bed",
                  "name" : "Check For Abort",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 451.55546118000916,
                    "y" : 687.3520526713144
                  },
                  "properties" : {
                    "Cache Entry Identifier" : "abort-${sourceBatchId}",
                    "Put Cache Value In Attribute" : "abortedReason",
                    "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                    "Max Length To Put In Attribute" : "256",
                    "Character Set" : "UTF-8"
                  },
                  "propertyDescriptors" : {
                    "Cache Entry Identifier" : {
                      "displayName" : "Cache Entry Identifier",
                      "identifiesControllerService" : false,
                      "name" : "Cache Entry Identifier",
                      "sensitive" : false
                    },
                    "Put Cache Value In Attribute" : {
                      "displayName" : "Put Cache Value In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Cache Value In Attribute",
                      "sensitive" : false
                    },
                    "Distributed Cache Service" : {
                      "displayName" : "Distributed Cache Service",
                      "identifiesControllerService" : true,
                      "name" : "Distributed Cache Service",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "Character Set" : {
                      "displayName" : "Character Set",
                      "identifiesControllerService" : false,
                      "name" : "Character Set",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.FetchDistributedMapCache",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              }, {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "5c381a17-b906-3965-ac96-e3e7da525b84",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "9af47152-8ac7-32d6-b11c-06e08ea5b771",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "54951b5c-4b24-3a91-a585-0106f2a51434",
                    "name" : "split into flow files for messages",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "1e20c9d9-fea4-3059-914b-e276f94dba8d",
                    "name" : "Log Abort Flag set",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "40a77efc-378d-34e6-8b66-b20fcaf13437",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "aa04725b-82fb-34cb-844d-9302068e3737",
                    "name" : "Add the Abort Flag To Cache",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "9724d442-6e30-3de3-b4a7-4ed6f1821318",
                    "name" : "Set Abort flag",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "6e62490e-64ea-3714-8e56-2efde00037bd",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "copy" ],
                  "source" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "5c381a17-b906-3965-ac96-e3e7da525b84",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "54951b5c-4b24-3a91-a585-0106f2a51434",
                    "name" : "split into flow files for messages",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "6daeee82-bd82-38a3-927a-f7e3fd5f3488",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "unmatched" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "41240b85-6e48-370b-8626-51f98448b3bf",
                    "name" : "Set To Abort?",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ {
                    "x" : 672.0,
                    "y" : 360.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                    "name" : "Output",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "2ecba9af-f064-35b8-ac51-4367968a9187",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "noAbort" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "41240b85-6e48-370b-8626-51f98448b3bf",
                    "name" : "Set To Abort?",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "41240b85-6e48-370b-8626-51f98448b3bf",
                    "name" : "Set To Abort?",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "09959561-6b6d-36be-8258-dca352e135dc",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                    "name" : "Input",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                    "name" : "Output",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "d1cb4a07-3d6e-3b1e-a318-b993c338d625",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "original" ],
                  "source" : {
                    "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "5c381a17-b906-3965-ac96-e3e7da525b84",
                    "name" : "Route Copy for abort indication",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "aa04725b-82fb-34cb-844d-9302068e3737",
                    "name" : "Add the Abort Flag To Cache",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "a012f2c2-10ca-3c1e-aaa6-8e9843c02ab1",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "failure", "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                    "id" : "9724d442-6e30-3de3-b4a7-4ed6f1821318",
                    "name" : "Set Abort flag",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "2d8a4ed1-cdb1-306a-9b65-bdaadbe1aa2c",
                  "name" : "Input",
                  "position" : {
                    "x" : 1008.0,
                    "y" : -208.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ ],
                "name" : "Stop Processing",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "3f9ebf21-d750-332d-b393-53fc0f4a4a48",
                  "name" : "Output",
                  "position" : {
                    "x" : 1008.0,
                    "y" : 736.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "position" : {
                  "x" : 1008.0,
                  "y" : 1032.0
                },
                "processGroups" : [ ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ "failure" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "aa04725b-82fb-34cb-844d-9302068e3737",
                  "name" : "Add the Abort Flag To Cache",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 696.0
                  },
                  "properties" : {
                    "Cache Entry Identifier" : "abort-${sourceBatchId}",
                    "Cache update strategy" : "keeporiginal",
                    "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                    "Max cache entry size" : "1 MB"
                  },
                  "propertyDescriptors" : {
                    "Cache Entry Identifier" : {
                      "displayName" : "Cache Entry Identifier",
                      "identifiesControllerService" : false,
                      "name" : "Cache Entry Identifier",
                      "sensitive" : false
                    },
                    "Cache update strategy" : {
                      "displayName" : "Cache update strategy",
                      "identifiesControllerService" : false,
                      "name" : "Cache update strategy",
                      "sensitive" : false
                    },
                    "Distributed Cache Service" : {
                      "displayName" : "Distributed Cache Service",
                      "identifiesControllerService" : true,
                      "name" : "Distributed Cache Service",
                      "sensitive" : false
                    },
                    "Max cache entry size" : {
                      "displayName" : "Max cache entry size",
                      "identifiesControllerService" : false,
                      "name" : "Max cache entry size",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.PutDistributedMapCache",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "9724d442-6e30-3de3-b4a7-4ed6f1821318",
                  "name" : "Set Abort flag",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 424.0
                  },
                  "properties" : {
                    "Regular Expression" : "(?s)(^.*$)",
                    "Replacement Value" : "${invokehttp.status.code}: ${invokehttp.status.message}",
                    "Evaluation Mode" : "Entire text",
                    "Line-by-Line Evaluation Mode" : "All",
                    "Character Set" : "UTF-8",
                    "Maximum Buffer Size" : "1 MB",
                    "Replacement Strategy" : "Always Replace"
                  },
                  "propertyDescriptors" : {
                    "Regular Expression" : {
                      "displayName" : "Search Value",
                      "identifiesControllerService" : false,
                      "name" : "Regular Expression",
                      "sensitive" : false
                    },
                    "Replacement Value" : {
                      "displayName" : "Replacement Value",
                      "identifiesControllerService" : false,
                      "name" : "Replacement Value",
                      "sensitive" : false
                    },
                    "Evaluation Mode" : {
                      "displayName" : "Evaluation Mode",
                      "identifiesControllerService" : false,
                      "name" : "Evaluation Mode",
                      "sensitive" : false
                    },
                    "Line-by-Line Evaluation Mode" : {
                      "displayName" : "Line-by-Line Evaluation Mode",
                      "identifiesControllerService" : false,
                      "name" : "Line-by-Line Evaluation Mode",
                      "sensitive" : false
                    },
                    "Character Set" : {
                      "displayName" : "Character Set",
                      "identifiesControllerService" : false,
                      "name" : "Character Set",
                      "sensitive" : false
                    },
                    "Maximum Buffer Size" : {
                      "displayName" : "Maximum Buffer Size",
                      "identifiesControllerService" : false,
                      "name" : "Maximum Buffer Size",
                      "sensitive" : false
                    },
                    "Replacement Strategy" : {
                      "displayName" : "Replacement Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Replacement Strategy",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.ReplaceText",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "54951b5c-4b24-3a91-a585-0106f2a51434",
                  "name" : "split into flow files for messages",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 952.0,
                    "y" : 224.0
                  },
                  "properties" : {
                    "Number of Copies" : "1"
                  },
                  "propertyDescriptors" : {
                    "Number of Copies" : {
                      "displayName" : "Number of Copies",
                      "identifiesControllerService" : false,
                      "name" : "Number of Copies",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.DuplicateFlowFile",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "unmatched" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "5c381a17-b906-3965-ac96-e3e7da525b84",
                  "name" : "Route Copy for abort indication",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 952.0,
                    "y" : 432.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "original" : "${copy.index:equals(0)}",
                    "copy" : "${copy.index:equals(1)}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "original" : {
                      "displayName" : "original",
                      "identifiesControllerService" : false,
                      "name" : "original",
                      "sensitive" : false
                    },
                    "copy" : {
                      "displayName" : "copy",
                      "identifiesControllerService" : false,
                      "name" : "copy",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "41240b85-6e48-370b-8626-51f98448b3bf",
                  "name" : "Set To Abort?",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 952.0,
                    "y" : -48.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "noAbort" : "${abortBatch:notNull():and(\n    ${abortBatch:equals(\"false\")}\n)}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "noAbort" : {
                      "displayName" : "noAbort",
                      "identifiesControllerService" : false,
                      "name" : "noAbort",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "success" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "a5d78bb0-c3d5-3927-af80-c399a00e2f34",
                  "identifier" : "1e20c9d9-fea4-3059-914b-e276f94dba8d",
                  "name" : "Log Abort Flag set",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1664.0,
                    "y" : 952.0
                  },
                  "properties" : {
                    "log-message" : "Abort flag \"abort-${sourceBatchId}\" set",
                    "log-level" : "info",
                    "log-prefix" : "Interop FHIR Adapter - "
                  },
                  "propertyDescriptors" : {
                    "log-message" : {
                      "displayName" : "Log message",
                      "identifiesControllerService" : false,
                      "name" : "log-message",
                      "sensitive" : false
                    },
                    "log-level" : {
                      "displayName" : "Log Level",
                      "identifiesControllerService" : false,
                      "name" : "log-level",
                      "sensitive" : false
                    },
                    "log-prefix" : {
                      "displayName" : "Log prefix",
                      "identifiesControllerService" : false,
                      "name" : "log-prefix",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.LogMessage",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              }, {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "cb7b4b25-9848-3697-822b-eca3e87ce2a0",
                    "name" : "No Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "bb547ea5-b1bb-3e6b-913c-ebb3d3fa664f",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "No Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                    "name" : "PUT Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "f5ee7611-1236-31ff-be13-4e9a97a50b4a",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "8cba466d-00a2-3a6f-9e05-e4ec56e95b02",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "cd4f272d-f19c-3661-827d-15aa5163db8b",
                    "name" : "input",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "9615a29a-260d-3ba7-8fe0-86d5180b9287",
                    "name" : "Response",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "6b22f672-8c92-3790-86aa-8b6afbe64038",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Response" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                    "name" : "PUT Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "9615a29a-260d-3ba7-8fe0-86d5180b9287",
                    "name" : "Response",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "f97a323d-e015-3e2f-b388-18ab6117f6d6",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Response" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                    "name" : "PUT Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                    "name" : "PUT Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "2e5b17f7-efd0-3840-a49d-c9827664451d",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "providerDirectory" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "f5ee7611-1236-31ff-be13-4e9a97a50b4a",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "cb7b4b25-9848-3697-822b-eca3e87ce2a0",
                    "name" : "No Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "0ed34676-4694-3ea7-a971-cc32680cade6",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "No Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                    "name" : "PUT Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "180f8656-80ab-3d74-bd0c-856678d61fab",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "c04e69a2-44ed-3b20-8b78-4d633513bf6b",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                    "name" : "PUT Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                    "name" : "PUT Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "a50d4b00-9275-3a79-8bce-9b23fb45ae78",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "unmatched" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "f5ee7611-1236-31ff-be13-4e9a97a50b4a",
                    "name" : "Is Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "180f8656-80ab-3d74-bd0c-856678d61fab",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "cd813c78-d41f-31fe-b28b-edfa54cf3001",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                    "name" : "PUT Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "e7240313-52bf-3750-9e78-0acdfab68bcf",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "22619f7a-b61f-39ed-9d20-7baef864fc71",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                    "name" : "PUT Resource to FHIR Provider Directory",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 10000,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "e7240313-52bf-3750-9e78-0acdfab68bcf",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "a0acf3a2-558e-38f2-b5e8-fc98b84003e1",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "Retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                    "id" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                    "name" : "PUT Resource to FHIR Patient Access",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "cd4f272d-f19c-3661-827d-15aa5163db8b",
                  "name" : "input",
                  "position" : {
                    "x" : 1448.0,
                    "y" : -344.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ ],
                "name" : "Put Resource to FHIR server",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "9615a29a-260d-3ba7-8fe0-86d5180b9287",
                  "name" : "Response",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 152.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "180f8656-80ab-3d74-bd0c-856678d61fab",
                  "name" : "Failure",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 416.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "e7240313-52bf-3750-9e78-0acdfab68bcf",
                  "name" : "Retry",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 536.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "cb7b4b25-9848-3697-822b-eca3e87ce2a0",
                  "name" : "No Retry",
                  "position" : {
                    "x" : 1456.0,
                    "y" : 288.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "parameterContextName" : "cms_adapter_parameters",
                "position" : {
                  "x" : 1008.0,
                  "y" : 272.0
                },
                "processGroups" : [ ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "f5ee7611-1236-31ff-be13-4e9a97a50b4a",
                  "name" : "Is Provider Directory",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1392.0,
                    "y" : -152.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "providerDirectory" : "${kafka.topic:getDelimitedField(4,'.'):toLower():startsWith('provider_directory')}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "providerDirectory" : {
                      "displayName" : "providerDirectory",
                      "identifiesControllerService" : false,
                      "name" : "providerDirectory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "Original" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 24,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "33c0fd7f-c450-3965-a077-bfb34b500e9c",
                  "name" : "PUT Resource to FHIR Patient Access",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 736.0,
                    "y" : 240.0
                  },
                  "properties" : {
                    "use-etag" : "false",
                    "Prefer" : "return=${FHIRPreferSetting}",
                    "Proxy Type" : "http",
                    "Basic Authentication Password" : "#{FHIR_UserPwd_PatientAccess}",
                    "Connection Timeout" : "5 secs",
                    "send-message-body" : "true",
                    "set-form-filename" : "true",
                    "Always Output Response" : "true",
                    "etag-max-cache-size" : "10MB",
                    "disable-http2" : "False",
                    "idle-timeout" : "5 mins",
                    "Put Response Body In Attribute" : "responseBody",
                    "Use Chunked Encoding" : "false",
                    "Follow Redirects" : "True",
                    "Remote URL" : "#{FHIR_URL_PatientAccess}${fhirUrlSuffix}/${resourceType}/${resourceId}",
                    "Content-Type" : "application/json",
                    "max-idle-connections" : "5",
                    "Read Timeout" : "130 secs",
                    "Max Length To Put In Attribute" : "2048",
                    "ignore-response-content" : "false",
                    "Digest Authentication" : "false",
                    "HTTP Method" : "PUT",
                    "Add Response Headers to Request" : "false",
                    "Basic Authentication Username" : "#{FHIR_User_PatientAccess}",
                    "Include Date Header" : "True",
                    "Penalize on \"No Retry\"" : "false",
                    "X-FHIR-TENANT-ID" : "${tenant}"
                  },
                  "propertyDescriptors" : {
                    "Proxy Host" : {
                      "displayName" : "Proxy Host",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Host",
                      "sensitive" : false
                    },
                    "Attributes to Send" : {
                      "displayName" : "Attributes to Send",
                      "identifiesControllerService" : false,
                      "name" : "Attributes to Send",
                      "sensitive" : false
                    },
                    "use-etag" : {
                      "displayName" : "Use HTTP ETag",
                      "identifiesControllerService" : false,
                      "name" : "use-etag",
                      "sensitive" : false
                    },
                    "proxy-configuration-service" : {
                      "displayName" : "Proxy Configuration Service",
                      "identifiesControllerService" : true,
                      "name" : "proxy-configuration-service",
                      "sensitive" : false
                    },
                    "Prefer" : {
                      "displayName" : "Prefer",
                      "identifiesControllerService" : false,
                      "name" : "Prefer",
                      "sensitive" : false
                    },
                    "Proxy Type" : {
                      "displayName" : "Proxy Type",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Type",
                      "sensitive" : false
                    },
                    "Basic Authentication Password" : {
                      "displayName" : "Basic Authentication Password",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Password",
                      "sensitive" : true
                    },
                    "Connection Timeout" : {
                      "displayName" : "Connection Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Connection Timeout",
                      "sensitive" : false
                    },
                    "send-message-body" : {
                      "displayName" : "Send Message Body",
                      "identifiesControllerService" : false,
                      "name" : "send-message-body",
                      "sensitive" : false
                    },
                    "set-form-filename" : {
                      "displayName" : "Set Flowfile Form Data File Name",
                      "identifiesControllerService" : false,
                      "name" : "set-form-filename",
                      "sensitive" : false
                    },
                    "Always Output Response" : {
                      "displayName" : "Always Output Response",
                      "identifiesControllerService" : false,
                      "name" : "Always Output Response",
                      "sensitive" : false
                    },
                    "etag-max-cache-size" : {
                      "displayName" : "Maximum ETag Cache Size",
                      "identifiesControllerService" : false,
                      "name" : "etag-max-cache-size",
                      "sensitive" : false
                    },
                    "disable-http2" : {
                      "displayName" : "disable-http2",
                      "identifiesControllerService" : false,
                      "name" : "disable-http2",
                      "sensitive" : false
                    },
                    "idle-timeout" : {
                      "displayName" : "Idle Timeout",
                      "identifiesControllerService" : false,
                      "name" : "idle-timeout",
                      "sensitive" : false
                    },
                    "Put Response Body In Attribute" : {
                      "displayName" : "Put Response Body In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Response Body In Attribute",
                      "sensitive" : false
                    },
                    "Use Chunked Encoding" : {
                      "displayName" : "Use Chunked Encoding",
                      "identifiesControllerService" : false,
                      "name" : "Use Chunked Encoding",
                      "sensitive" : false
                    },
                    "Follow Redirects" : {
                      "displayName" : "Follow Redirects",
                      "identifiesControllerService" : false,
                      "name" : "Follow Redirects",
                      "sensitive" : false
                    },
                    "Remote URL" : {
                      "displayName" : "Remote URL",
                      "identifiesControllerService" : false,
                      "name" : "Remote URL",
                      "sensitive" : false
                    },
                    "Content-Type" : {
                      "displayName" : "Content-Type",
                      "identifiesControllerService" : false,
                      "name" : "Content-Type",
                      "sensitive" : false
                    },
                    "form-body-form-name" : {
                      "displayName" : "Flowfile Form Data Name",
                      "identifiesControllerService" : false,
                      "name" : "form-body-form-name",
                      "sensitive" : false
                    },
                    "max-idle-connections" : {
                      "displayName" : "Max Idle Connections",
                      "identifiesControllerService" : false,
                      "name" : "max-idle-connections",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-user" : {
                      "displayName" : "Proxy Username",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-user",
                      "sensitive" : false
                    },
                    "Read Timeout" : {
                      "displayName" : "Read Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Read Timeout",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-password" : {
                      "displayName" : "Proxy Password",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-password",
                      "sensitive" : true
                    },
                    "ignore-response-content" : {
                      "displayName" : "Ignore response's content",
                      "identifiesControllerService" : false,
                      "name" : "ignore-response-content",
                      "sensitive" : false
                    },
                    "Proxy Port" : {
                      "displayName" : "Proxy Port",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Port",
                      "sensitive" : false
                    },
                    "SSL Context Service" : {
                      "displayName" : "SSL Context Service",
                      "identifiesControllerService" : true,
                      "name" : "SSL Context Service",
                      "sensitive" : false
                    },
                    "Digest Authentication" : {
                      "displayName" : "Use Digest Authentication",
                      "identifiesControllerService" : false,
                      "name" : "Digest Authentication",
                      "sensitive" : false
                    },
                    "HTTP Method" : {
                      "displayName" : "HTTP Method",
                      "identifiesControllerService" : false,
                      "name" : "HTTP Method",
                      "sensitive" : false
                    },
                    "Add Response Headers to Request" : {
                      "displayName" : "Add Response Headers to Request",
                      "identifiesControllerService" : false,
                      "name" : "Add Response Headers to Request",
                      "sensitive" : false
                    },
                    "Basic Authentication Username" : {
                      "displayName" : "Basic Authentication Username",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Username",
                      "sensitive" : false
                    },
                    "Include Date Header" : {
                      "displayName" : "Include Date Header",
                      "identifiesControllerService" : false,
                      "name" : "Include Date Header",
                      "sensitive" : false
                    },
                    "Penalize on \"No Retry\"" : {
                      "displayName" : "Penalize on \"No Retry\"",
                      "identifiesControllerService" : false,
                      "name" : "Penalize on \"No Retry\"",
                      "sensitive" : false
                    },
                    "X-FHIR-TENANT-ID" : {
                      "displayName" : "X-FHIR-TENANT-ID",
                      "identifiesControllerService" : false,
                      "name" : "X-FHIR-TENANT-ID",
                      "sensitive" : false
                    },
                    "Useragent" : {
                      "displayName" : "Useragent",
                      "identifiesControllerService" : false,
                      "name" : "Useragent",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ "Original" ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 24,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "3901418d-7ae2-3dc8-8f2f-75aff5b815b6",
                  "identifier" : "a4f8af16-4e9b-3452-b149-f2ced90d65c1",
                  "name" : "PUT Resource to FHIR Provider Directory",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 2112.0,
                    "y" : 248.0
                  },
                  "properties" : {
                    "use-etag" : "false",
                    "Prefer" : "return=${FHIRPreferSetting}",
                    "Proxy Type" : "http",
                    "Basic Authentication Password" : "#{FHIR_UserPwd_ProviderDirectory}",
                    "Connection Timeout" : "5 secs",
                    "send-message-body" : "true",
                    "set-form-filename" : "true",
                    "Always Output Response" : "true",
                    "etag-max-cache-size" : "10MB",
                    "disable-http2" : "False",
                    "idle-timeout" : "5 mins",
                    "Put Response Body In Attribute" : "responseBody",
                    "Use Chunked Encoding" : "false",
                    "Follow Redirects" : "True",
                    "Remote URL" : "#{FHIR_URL_ProviderDirectory}${fhirUrlSuffix}/${resourceType}/${resourceId}",
                    "Content-Type" : "application/json",
                    "max-idle-connections" : "5",
                    "Read Timeout" : "130 secs",
                    "Max Length To Put In Attribute" : "2048",
                    "ignore-response-content" : "false",
                    "Digest Authentication" : "false",
                    "HTTP Method" : "PUT",
                    "Add Response Headers to Request" : "false",
                    "Basic Authentication Username" : "#{FHIR_User_ProviderDirectory}",
                    "Include Date Header" : "True",
                    "Penalize on \"No Retry\"" : "false",
                    "X-FHIR-TENANT-ID" : "${tenant}"
                  },
                  "propertyDescriptors" : {
                    "Proxy Host" : {
                      "displayName" : "Proxy Host",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Host",
                      "sensitive" : false
                    },
                    "Attributes to Send" : {
                      "displayName" : "Attributes to Send",
                      "identifiesControllerService" : false,
                      "name" : "Attributes to Send",
                      "sensitive" : false
                    },
                    "use-etag" : {
                      "displayName" : "Use HTTP ETag",
                      "identifiesControllerService" : false,
                      "name" : "use-etag",
                      "sensitive" : false
                    },
                    "proxy-configuration-service" : {
                      "displayName" : "Proxy Configuration Service",
                      "identifiesControllerService" : true,
                      "name" : "proxy-configuration-service",
                      "sensitive" : false
                    },
                    "Prefer" : {
                      "displayName" : "Prefer",
                      "identifiesControllerService" : false,
                      "name" : "Prefer",
                      "sensitive" : false
                    },
                    "Proxy Type" : {
                      "displayName" : "Proxy Type",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Type",
                      "sensitive" : false
                    },
                    "Basic Authentication Password" : {
                      "displayName" : "Basic Authentication Password",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Password",
                      "sensitive" : true
                    },
                    "Connection Timeout" : {
                      "displayName" : "Connection Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Connection Timeout",
                      "sensitive" : false
                    },
                    "send-message-body" : {
                      "displayName" : "Send Message Body",
                      "identifiesControllerService" : false,
                      "name" : "send-message-body",
                      "sensitive" : false
                    },
                    "set-form-filename" : {
                      "displayName" : "Set Flowfile Form Data File Name",
                      "identifiesControllerService" : false,
                      "name" : "set-form-filename",
                      "sensitive" : false
                    },
                    "Always Output Response" : {
                      "displayName" : "Always Output Response",
                      "identifiesControllerService" : false,
                      "name" : "Always Output Response",
                      "sensitive" : false
                    },
                    "etag-max-cache-size" : {
                      "displayName" : "Maximum ETag Cache Size",
                      "identifiesControllerService" : false,
                      "name" : "etag-max-cache-size",
                      "sensitive" : false
                    },
                    "disable-http2" : {
                      "displayName" : "disable-http2",
                      "identifiesControllerService" : false,
                      "name" : "disable-http2",
                      "sensitive" : false
                    },
                    "idle-timeout" : {
                      "displayName" : "Idle Timeout",
                      "identifiesControllerService" : false,
                      "name" : "idle-timeout",
                      "sensitive" : false
                    },
                    "Put Response Body In Attribute" : {
                      "displayName" : "Put Response Body In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Response Body In Attribute",
                      "sensitive" : false
                    },
                    "Use Chunked Encoding" : {
                      "displayName" : "Use Chunked Encoding",
                      "identifiesControllerService" : false,
                      "name" : "Use Chunked Encoding",
                      "sensitive" : false
                    },
                    "Follow Redirects" : {
                      "displayName" : "Follow Redirects",
                      "identifiesControllerService" : false,
                      "name" : "Follow Redirects",
                      "sensitive" : false
                    },
                    "Remote URL" : {
                      "displayName" : "Remote URL",
                      "identifiesControllerService" : false,
                      "name" : "Remote URL",
                      "sensitive" : false
                    },
                    "Content-Type" : {
                      "displayName" : "Content-Type",
                      "identifiesControllerService" : false,
                      "name" : "Content-Type",
                      "sensitive" : false
                    },
                    "form-body-form-name" : {
                      "displayName" : "Flowfile Form Data Name",
                      "identifiesControllerService" : false,
                      "name" : "form-body-form-name",
                      "sensitive" : false
                    },
                    "max-idle-connections" : {
                      "displayName" : "Max Idle Connections",
                      "identifiesControllerService" : false,
                      "name" : "max-idle-connections",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-user" : {
                      "displayName" : "Proxy Username",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-user",
                      "sensitive" : false
                    },
                    "Read Timeout" : {
                      "displayName" : "Read Timeout",
                      "identifiesControllerService" : false,
                      "name" : "Read Timeout",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "invokehttp-proxy-password" : {
                      "displayName" : "Proxy Password",
                      "identifiesControllerService" : false,
                      "name" : "invokehttp-proxy-password",
                      "sensitive" : true
                    },
                    "ignore-response-content" : {
                      "displayName" : "Ignore response's content",
                      "identifiesControllerService" : false,
                      "name" : "ignore-response-content",
                      "sensitive" : false
                    },
                    "Proxy Port" : {
                      "displayName" : "Proxy Port",
                      "identifiesControllerService" : false,
                      "name" : "Proxy Port",
                      "sensitive" : false
                    },
                    "SSL Context Service" : {
                      "displayName" : "SSL Context Service",
                      "identifiesControllerService" : true,
                      "name" : "SSL Context Service",
                      "sensitive" : false
                    },
                    "Digest Authentication" : {
                      "displayName" : "Use Digest Authentication",
                      "identifiesControllerService" : false,
                      "name" : "Digest Authentication",
                      "sensitive" : false
                    },
                    "HTTP Method" : {
                      "displayName" : "HTTP Method",
                      "identifiesControllerService" : false,
                      "name" : "HTTP Method",
                      "sensitive" : false
                    },
                    "Add Response Headers to Request" : {
                      "displayName" : "Add Response Headers to Request",
                      "identifiesControllerService" : false,
                      "name" : "Add Response Headers to Request",
                      "sensitive" : false
                    },
                    "Basic Authentication Username" : {
                      "displayName" : "Basic Authentication Username",
                      "identifiesControllerService" : false,
                      "name" : "Basic Authentication Username",
                      "sensitive" : false
                    },
                    "Include Date Header" : {
                      "displayName" : "Include Date Header",
                      "identifiesControllerService" : false,
                      "name" : "Include Date Header",
                      "sensitive" : false
                    },
                    "Penalize on \"No Retry\"" : {
                      "displayName" : "Penalize on \"No Retry\"",
                      "identifiesControllerService" : false,
                      "name" : "Penalize on \"No Retry\"",
                      "sensitive" : false
                    },
                    "X-FHIR-TENANT-ID" : {
                      "displayName" : "X-FHIR-TENANT-ID",
                      "identifiesControllerService" : false,
                      "name" : "X-FHIR-TENANT-ID",
                      "sensitive" : false
                    },
                    "Useragent" : {
                      "displayName" : "Useragent",
                      "identifiesControllerService" : false,
                      "name" : "Useragent",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              } ],
              "processors" : [ {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "59818383-04cf-3170-9949-49ff171e76a3",
                "name" : "Add Tag to Resource",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1024.0,
                  "y" : -8.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Add Tag to Resource\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Put Resources to FHIR\"\n *\n * Adds the batchid tag in the FHIR Resource's metadata if the FHIRResourceTag is set.\n */\nclass AddTagToSingleResource extends AbstractProcessor {\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n    .name(\"success\")\n    .description(\"If the resource was successfully updated it will be routed to this relationship\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"If the resource was not able to be updated, the FlowFile will be penalized and routed to this relationship\")\n    .build()\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_SUCCESS, REL_FAILURE] as Set\n    }\n\n    /**\n     * Class that handles adding the resource tag\n     */\n    class GroovyStreamCallback extends StreamCallback {\n        private FlowFile theFlowFile = null;\n\n        public GroovyStreamCallback(FlowFile theFlowFile) {\n            super();\n            this.theFlowFile = theFlowFile;\n        }\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            def jsonSlurper = new JsonSlurper()\n            def inputFHIRResource = jsonSlurper.parse(instream, \"UTF-8\")\n            def CODE_SYSTEM=\"http://ibm.com/fhir/cdm/StructureDefinition/ingestion-batch-id\"\n            def fhirResourceTag = this.theFlowFile.getAttribute(\"FHIRResourceTag\")\n\n            // If the fhirResourceTag attribute is set, add it to the metadata of the resource.\n            if (fhirResourceTag) {\n                def fhirTag=[system:CODE_SYSTEM,code:fhirResourceTag]\n\n                // create 'meta' element if is doesn't exist\n                // NOTE: this appends property 'meta' to end of list. (least expensive option)\n                inputFHIRResource.putIfAbsent(\"meta\", [:] )\n\n                // Create empty tag array if it doesn't exist.\n                def metaMap = inputFHIRResource.meta\n                metaMap.putIfAbsent(\"tag\", [])\n\n                def tagArray = metaMap.get(\"tag\")\n\n                // search for an existing entry with same CODE_SYSTEM\n                def existingEntry = tagArray.find { tagArrayEntry -> tagArrayEntry.system==CODE_SYSTEM }\n                if ( ! existingEntry ) {\n                    // NOT FOUND - add a new entry to tagArray\n                    tagArray.add(fhirTag)\n                } else {\n                    // There was an array entry for our code system - set value\n                    existingEntry.code=fhirResourceTag\n                }\n\n            }\n\n            def output_json_string = JsonOutput.toJson(inputFHIRResource)\n            outstream.write( output_json_string.getBytes(StandardCharsets.UTF_8))\n\n        }\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        List<FlowFile> flowFiles = session.get(100)\n        if (flowFiles == null) {\n            return\n        }\n\n        for (FlowFile aFlowFile : flowFiles) {\n            try {\n                aFlowFile = session.write(aFlowFile, new GroovyStreamCallback(aFlowFile))\n                session.transfer(aFlowFile, REL_SUCCESS)\n            } catch (Exception e) {\n                getLogger().error('Exception adding tag to resource with UUID: {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n                session.transfer(aFlowFile, REL_FAILURE)\n            }\n        }\n    }\n}\n\nprocessor = new AddTagToSingleResource()\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "failure" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "bcb9bd5b-1e79-3242-b318-9c459d2838cc",
                "name" : "Clear Flow File Contents",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1024.0,
                  "y" : 1384.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.exception.ProcessException\nimport java.nio.charset.StandardCharsets\n\n/**\n * Clears the FlowFile content and sets the Content-Type, mime.type to text.\n * \n */\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null) {\n    return\n}\n\nString [] CONTENT_TYPE_ATTRS = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n\nfor (FlowFile aFlowFile : flowFiles) {\n    aFlowFile = session.write(aFlowFile, new StreamCallback () {\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            outstream.write(\"\".getBytes(StandardCharsets.UTF_8))\n        }\n\n    })\n\n    for (String attrName : CONTENT_TYPE_ATTRS) {\n        String attr = aFlowFile.getAttribute(attrName)\n        if ( attr != null ) {\n            aFlowFile = session.putAttribute(aFlowFile, attrName, \"text/plain\")\n        }\n    }\n\n    session.transfer(aFlowFile, REL_SUCCESS)\n}\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "0fe7e9a4-ce0b-3099-9939-d2f78ff16353",
                "identifier" : "96b5633d-4ca4-3a8b-8f47-1fb692f651c3",
                "name" : "Handle PUT Resource FHIR Response",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1984.0,
                  "y" : 296.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n\n/**\n * For \"Handle PUT Resource FHIR Response\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Put Resources to FHIR\"\n *  1. If code is 2xx or 400 or 422, handle FHIR + JSON content type and send to output\n *  2. If 404 and content has OperationOutcome, handle FHIR + JSON content type and send to output\n *  3. If 404 and content does not have OperationOutcome, remove from flow.\n *  4. If 409, remove from flow\n *  4. If 5xx, remove from flow\n *  5. clear flow file contents\n *  6. If 401 error, set the invokehttp.status.message to \"FHIR Server - Not Authorized\" and send to stop processing relationship \n *  7. Anything else send to output relationship \n * \n */\nclass ProcessResponseFromPutFHIR extends AbstractProcessor {\n    \n    private static final String [] CONTENT_TYPE_ATTRS = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n    \n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n    public static final Relationship REL_OUTPUT = new Relationship.Builder()\n    .name(\"output\")\n    .description(\"Flowfile sent on for further processing\")\n    .build()\n\n    public static final Relationship REL_STOP = new Relationship.Builder()\n    .name(\"stop\")\n    .description(\"Type of error indicates no further processing should continue in the batch\")\n    .build()\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_OUTPUT, REL_STOP] as Set\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    /**\n     * Reads the content\n     */\n    class ContentReader implements InputStreamCallback {\n        String content = null;\n        \n        public ContentReader() {\n            super()\n        }\n        \n        public def getContent() {\n            return this.content\n        }\n        \n        @Override\n        void process(InputStream instream) throws IOException {\n            this.content = IOUtils.toString(instream, \"UTF-8\")\n        }\n    \n    }\n    \n    \n    /**\n     * Clears the flowfile content\n     */\n    public class ClearFlowFileContents extends StreamCallback {\n\n        public ClearFlowFileContents() {\n            super();\n        }\n\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            outstream.write(\"\".getBytes(StandardCharsets.UTF_8))\n        }\n\n    }\n    \n    /**\n     * Sets all the content type and mime type attributes from fhir+json to json\n     * @param session\n     * @param flowFile\n     * @return\n     */\n    private FlowFile handleFHIRJSonContentType(ProcessSession session, FlowFile flowFile) {\n        for (String attrName : CONTENT_TYPE_ATTRS) {\n            String attr = flowFile.getAttribute(attrName)\n            if ( attr != null ) {\n                flowFile = session.putAttribute(flowFile, attrName, attr.replace(\"fhir+json\",\"json\"))\n            }\n        }\n        \n        return flowFile\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        List<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n        if (flowFiles == null) {\n            return\n        }\n\n        for (FlowFile aFlowFile : flowFiles) {\n            String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n            \n            // If code is 2xx or 400 or 422, handle FHIR + JSON content type and send to output\n            if ((httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3) ||\n                httpStatusCode.equals(\"400\") ||\n                httpStatusCode.equals(\"422\")) {\n                aFlowFile = handleFHIRJSonContentType(session, aFlowFile)\n                session.transfer(aFlowFile, REL_OUTPUT)\n                continue\n            }\n            \n            // Check 404 error\n            if (httpStatusCode.equals(\"404\")) {\n                // Check if content has OperationOutcome, if so handle FHIR + JSON content type and send to output\n                ContentReader reader = new ContentReader()\n                session.read(aFlowFile, reader)\n                if (reader.getContent() && reader.getContent().find(\"\\\"resourceType\\\"\\\\s*:\\\\s*\\\"OperationOutcome\\\"\") != null) {\n                    aFlowFile = handleFHIRJSonContentType(session, aFlowFile)\n                    session.transfer(aFlowFile, REL_OUTPUT)\n                } else {\n                    // remove from flow - handled elsewhere in flow\n                    session.remove(aFlowFile)            \n                }\n                \n                continue\n            }\n            \n            // If 409 or 5xx, remove from flow\n            if ((httpStatusCode.startsWith(\"5\") && httpStatusCode.length() == 3) ||\n                 httpStatusCode.equals(\"409\")) {\n                session.remove(aFlowFile)\n                continue\n            }\n\n\n            // clear flow file contents\n            try {\n                ClearFlowFileContents writer = new ClearFlowFileContents();\n                aFlowFile = session.write(aFlowFile, writer)\n                for (String attrName : CONTENT_TYPE_ATTRS) {\n                    String attr = aFlowFile.getAttribute(attrName)\n                    if ( attr != null ) {\n                        aFlowFile = session.putAttribute(aFlowFile, attrName, \"text/plain\")\n                    }\n                }\n        \n            } catch (Exception e) {\n                getLogger().error('Exception clearing flowfile', e)\n            }\n\n            \n            // If 401 error, set the invokehttp.status.message to \"FHIR Server - Not Authorized\" and send to stop processing relationship\n            if (httpStatusCode.equals(\"401\")) {\n                aFlowFile = session.putAttribute(aFlowFile, \"invokehttp.status.message\",  \"FHIR Server - Not Authorized\")\n                session.transfer(aFlowFile, REL_STOP)\n                continue\n             }\n                \n             // Anything else send to output relationship\n             session.transfer(aFlowFile, REL_OUTPUT)\n        }\n    }\n}\n\nprocessor = new ProcessResponseFromPutFHIR()\n\n",
                  "Number of flowfiles to pull" : "100"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Number of flowfiles to pull" : {
                    "displayName" : "Number of flowfiles to pull",
                    "identifiesControllerService" : false,
                    "name" : "Number of flowfiles to pull",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              } ],
              "remoteProcessGroups" : [ ],
              "variables" : { }
            }, {
              "comments" : "",
              "componentType" : "PROCESS_GROUP",
              "connections" : [ {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ {
                  "x" : 1208.0,
                  "y" : 1008.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "23b5021b-6272-3ff7-9536-e90450046bd5",
                  "name" : "retry",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "fce79103-b35a-3f55-bc73-e22e4a3fc2ec",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "d1e72f4b-1a02-30cd-a870-f9adce1538f8",
                  "name" : "Build Resource Bundle",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "176be395-1553-3964-8329-0edf4fa000c2",
                  "name" : "split flow file for FHIR Server",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "408810f1-cb99-39a0-9737-79b54adf1f84",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "d1e72f4b-1a02-30cd-a870-f9adce1538f8",
                  "name" : "Build Resource Bundle",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "65a13bb4-f514-3863-ac24-a934c56b16d7",
                  "name" : "Check Merge Failure Flag",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "01479bf2-2507-3ff5-abb0-53193fa967e0",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "b2b32995-f797-339f-9232-59061d627f94",
                  "name" : "Setup FHIR flowfile for Merge",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "d1e72f4b-1a02-30cd-a870-f9adce1538f8",
                  "name" : "Build Resource Bundle",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "6003acb8-ac9e-301c-acff-cb981790ae6f",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "09547305-abe6-3fae-b2e1-252b8ab41c00",
                  "name" : "input",
                  "type" : "INPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "0da295a1-e92b-3211-8e94-a7ebcebf038d",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "1ef0d8a5-c407-3dcd-a7a6-e54898a84c43",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "65a13bb4-f514-3863-ac24-a934c56b16d7",
                  "name" : "Check Merge Failure Flag",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "d3a7b004-bceb-363f-8105-60dc4319f4dc",
                  "name" : "Log Error Creating Bundle Payload",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "189fe85c-b8fa-3a71-bbac-dc582e93c064",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "unmatched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "ef45cc66-3683-37c2-83e4-244580d7887f",
                  "name" : "Set content to FHIR payload",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "51308e33-232b-32b8-b9d6-07dd0b71bd35",
                  "name" : "Route to Send to FHIR",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "7c54d6ed-c246-3aa3-bdab-9968a919bd01",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "176be395-1553-3964-8329-0edf4fa000c2",
                  "name" : "split flow file for FHIR Server",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "23bbd5ea-2569-3ade-ae72-0275d4ade299",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "4ae6b28d-8395-3444-82a2-59d97db9f7c7",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "a055dffe-ed1d-3ee3-8e0e-cf044100eb54",
                  "name" : "Handle Merge Failure",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "a055dffe-ed1d-3ee3-8e0e-cf044100eb54",
                  "name" : "Handle Merge Failure",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "73a90941-27a8-3ee3-8fec-bbf05641d3c8",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure", "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "ca4cbc40-0151-3517-8a1f-32190d0f1bb8",
                  "name" : "Flag Merge Failure",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "f590582d-39e1-3fde-82ca-cb618a4eca53",
                  "name" : "Setup Original for Merge",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "0394ab99-7092-33bf-96da-05e71647815e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "original" ],
                "source" : {
                  "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "51308e33-232b-32b8-b9d6-07dd0b71bd35",
                  "name" : "Route to Send to FHIR",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "id" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                  "name" : "Input Bundle",
                  "type" : "INPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "50062bbc-9e24-35d0-bd5e-c4436790977e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "matched" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "ef45cc66-3683-37c2-83e4-244580d7887f",
                  "name" : "Set content to FHIR payload",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "23bbd5ea-2569-3ade-ae72-0275d4ade299",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "935e7634-5458-3a3a-b446-32f233d89d52",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "merged" ],
                "source" : {
                  "comments" : "This processor uses the 'fragement' properties that were previously set into the flow files to 'de-fragment' the batch.\nThe merged flow file will contain all FHIR resources for which a publish attempt was made, as a json array.\n\nThe metadata strategy is to only include attributes with the same key and value in the merged file.  This is important for the batch status, because if some files are published and some fail, the batch status attribute will not exist (will be null).",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "340155c4-5709-398a-a6b4-030eceb17fd2",
                  "name" : "Merge FHIR Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "b2b32995-f797-339f-9232-59061d627f94",
                  "name" : "Setup FHIR flowfile for Merge",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "adacbcb6-205a-3ee9-bb0c-1960c0e6f646",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "id" : "63385abb-68ec-3bd9-98dd-4fffb4f9a0ab",
                  "name" : "Success",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "ef45cc66-3683-37c2-83e4-244580d7887f",
                  "name" : "Set content to FHIR payload",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "5034c9f0-3aa7-30e4-aaae-1b00ad34393e",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "copy" ],
                "source" : {
                  "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "51308e33-232b-32b8-b9d6-07dd0b71bd35",
                  "name" : "Route to Send to FHIR",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "4117bc79-c1d6-3722-9ec2-f3d5e2880e26",
                  "name" : "Process Results",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "2d1a142c-48b0-306a-9d72-f41b35af19e1",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "23bbd5ea-2569-3ade-ae72-0275d4ade299",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "23b5021b-6272-3ff7-9536-e90450046bd5",
                  "name" : "retry",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "90f91ded-a428-3f7f-973d-5634821b2141",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "retry" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "4117bc79-c1d6-3722-9ec2-f3d5e2880e26",
                  "name" : "Process Results",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "0da295a1-e92b-3211-8e94-a7ebcebf038d",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "7441d3ee-e9e6-3a45-a707-fa9803c98e43",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "f590582d-39e1-3fde-82ca-cb618a4eca53",
                  "name" : "Setup Original for Merge",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "235a93e2-19c5-3be4-814a-1dde89739885",
                  "name" : "success",
                  "type" : "OUTPUT_PORT"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "a29f8c86-e9a2-3624-a0ed-e5ea32f3e9a1",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "4117bc79-c1d6-3722-9ec2-f3d5e2880e26",
                  "name" : "Process Results",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "63082db0-65d8-311c-806e-b901739f6494",
                  "name" : "Set failed flag",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "fab69b1b-829c-38a6-8d2f-270c32018188",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "id" : "cf65e2df-ab8e-3eb1-86dd-4c1bd1a9e7c4",
                  "name" : "Failure",
                  "type" : "OUTPUT_PORT"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "This processor uses the 'fragement' properties that were previously set into the flow files to 'de-fragment' the batch.\nThe merged flow file will contain all FHIR resources for which a publish attempt was made, as a json array.\n\nThe metadata strategy is to only include attributes with the same key and value in the merged file.  This is important for the batch status, because if some files are published and some fail, the batch status attribute will not exist (will be null).",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "340155c4-5709-398a-a6b4-030eceb17fd2",
                  "name" : "Merge FHIR Response",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "4031975b-205f-3b75-98ff-7e58d90bd573",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "PARTITION_BY_ATTRIBUTE",
                "name" : "",
                "partitioningAttribute" : "fragment.identifier",
                "prioritizers" : [ "org.apache.nifi.prioritizer.PriorityAttributePrioritizer" ],
                "selectedRelationships" : [ "" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "0da295a1-e92b-3211-8e94-a7ebcebf038d",
                  "name" : "Funnel",
                  "type" : "FUNNEL"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 10000,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "ca4cbc40-0151-3517-8a1f-32190d0f1bb8",
                  "name" : "Flag Merge Failure",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "91b15557-d337-3031-a8f3-4e1f044ede69",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "failure" ],
                "source" : {
                  "comments" : "This processor uses the 'fragement' properties that were previously set into the flow files to 'de-fragment' the batch.\nThe merged flow file will contain all FHIR resources for which a publish attempt was made, as a json array.\n\nThe metadata strategy is to only include attributes with the same key and value in the merged file.  This is important for the batch status, because if some files are published and some fail, the batch status attribute will not exist (will be null).",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "340155c4-5709-398a-a6b4-030eceb17fd2",
                  "name" : "Merge FHIR Response",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "63082db0-65d8-311c-806e-b901739f6494",
                  "name" : "Set failed flag",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "102f20d2-e1d2-31fb-ae92-19029e320038",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "d3a7b004-bceb-363f-8105-60dc4319f4dc",
                  "name" : "Log Error Creating Bundle Payload",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              }, {
                "backPressureDataSizeThreshold" : "1 GB",
                "backPressureObjectThreshold" : 200,
                "bends" : [ {
                  "x" : 3568.0,
                  "y" : 2144.0
                } ],
                "componentType" : "CONNECTION",
                "destination" : {
                  "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "b2b32995-f797-339f-9232-59061d627f94",
                  "name" : "Setup FHIR flowfile for Merge",
                  "type" : "PROCESSOR"
                },
                "flowFileExpiration" : "0 sec",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "8c5e6b58-c03b-3351-8def-9acf85271b9d",
                "labelIndex" : 1,
                "loadBalanceCompression" : "DO_NOT_COMPRESS",
                "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                "name" : "",
                "partitioningAttribute" : "",
                "prioritizers" : [ ],
                "selectedRelationships" : [ "success" ],
                "source" : {
                  "comments" : "",
                  "groupId" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                  "id" : "63082db0-65d8-311c-806e-b901739f6494",
                  "name" : "Set failed flag",
                  "type" : "PROCESSOR"
                },
                "zIndex" : 0
              } ],
              "controllerServices" : [ ],
              "flowFileConcurrency" : "UNBOUNDED",
              "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
              "funnels" : [ {
                "componentType" : "FUNNEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "0da295a1-e92b-3211-8e94-a7ebcebf038d",
                "position" : {
                  "x" : 2024.0,
                  "y" : 2376.0
                }
              }, {
                "componentType" : "FUNNEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "23bbd5ea-2569-3ade-ae72-0275d4ade299",
                "position" : {
                  "x" : 2024.0,
                  "y" : 3016.0
                }
              } ],
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
              "inputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "INPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "09547305-abe6-3fae-b2e1-252b8ab41c00",
                "name" : "input",
                "position" : {
                  "x" : 1928.0,
                  "y" : 704.0
                },
                "type" : "INPUT_PORT"
              } ],
              "labels" : [ {
                "componentType" : "LABEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "height" : 56.0,
                "identifier" : "641f3bda-85b4-3e94-9d24-7675f21420f4",
                "label" : "Logs an error that merge failed, removes the copy flowfile, and sets \nautoBundleFailed to \"true\"",
                "position" : {
                  "x" : 2848.0,
                  "y" : 2992.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 408.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "height" : 48.0,
                "identifier" : "bae73d26-c711-3251-ab06-8f121ab9c476",
                "label" : "Set the flag in the distributed cache map if the original flowfile \nwas kicked out of the bin",
                "position" : {
                  "x" : 2856.0,
                  "y" : 2664.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 368.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "height" : 96.0,
                "identifier" : "1ead0668-379d-3486-af2e-68fba9eae005",
                "label" : "Collects a number of FlowFiles that contains a FHIR resource and builds a resource bundle to be sent to the FHIR server.\n This script also captures the flowfile attributes needed when the bundle is split up again into individual flowfiles.\n The resulting flowfile content will have a section that contains the flowfile attributes in an array corresponding to the bundle entry.\n Another section will contain the resource bundle to be sent to FHIR.\nThe copyId and segment.original.filename attributes are set for the duplicate flowfile processor later on the flow.\n ",
                "position" : {
                  "x" : 2256.0,
                  "y" : 960.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 720.0
              }, {
                "componentType" : "LABEL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "height" : 40.0,
                "identifier" : "e91e2f6f-197d-3b13-8006-8bdfe1a960a7",
                "label" : "Note: Some connections have customized back pressure settings",
                "position" : {
                  "x" : 1896.0,
                  "y" : 608.0
                },
                "style" : {
                  "font-size" : "12px"
                },
                "width" : 368.0
              } ],
              "name" : "Auto Build Bundle",
              "outputPorts" : [ {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "235a93e2-19c5-3be4-814a-1dde89739885",
                "name" : "success",
                "position" : {
                  "x" : 1928.0,
                  "y" : 3752.0
                },
                "type" : "OUTPUT_PORT"
              }, {
                "allowRemoteAccess" : false,
                "comments" : "",
                "componentType" : "OUTPUT_PORT",
                "concurrentlySchedulableTaskCount" : 1,
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "23b5021b-6272-3ff7-9536-e90450046bd5",
                "name" : "retry",
                "position" : {
                  "x" : 1080.0,
                  "y" : 3752.0
                },
                "type" : "OUTPUT_PORT"
              } ],
              "parameterContextName" : "cms_adapter_parameters",
              "position" : {
                "x" : 2720.0,
                "y" : 240.0
              },
              "processGroups" : [ {
                "comments" : "",
                "componentType" : "PROCESS_GROUP",
                "connections" : [ {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "63385abb-68ec-3bd9-98dd-4fffb4f9a0ab",
                    "name" : "Success",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "9e76118c-8e1c-39e7-b5c1-bd38468f0496",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "failure", "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "d3fa013f-91a1-3c47-9b09-b11233ea5619",
                    "name" : "Remove Warnings from Bundle Response",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                    "name" : "input",
                    "type" : "INPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "1ce88d7e-676d-3bdf-a0c2-cefa9a5b9cf9",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                    "name" : "Input Bundle",
                    "type" : "INPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ {
                    "x" : 120.0,
                    "y" : 480.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "c2d59c24-d413-3896-a83d-0beaa5ca8bb1",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                    "name" : "Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "cf65e2df-ab8e-3eb1-86dd-4c1bd1a9e7c4",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "d4846c9d-19c1-3ad0-99ea-30d334b8f095",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "72ab2849-7ea3-372d-957d-850c46a9f31c",
                    "name" : "Set Flag to No Retry",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "d3fa013f-91a1-3c47-9b09-b11233ea5619",
                    "name" : "Remove Warnings from Bundle Response",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "757b146a-de80-3315-ae09-896d0ff15361",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                    "name" : "Response",
                    "type" : "OUTPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ {
                    "x" : 216.0,
                    "y" : 632.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "fa414e13-0415-3c9e-8066-1311dd9b33d1",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "f5c8103c-b3d9-30e8-95d3-7f698dcf8019",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "404Error" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "c586d455-376c-3963-807b-b6258830b7e3",
                    "name" : "Check 404 error",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ {
                    "x" : -664.0,
                    "y" : 752.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "72ab2849-7ea3-372d-957d-850c46a9f31c",
                    "name" : "Set Flag to No Retry",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "4c3ead9c-7485-39dc-9881-c1edcb5e8dab",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "success" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "72ab2849-7ea3-372d-957d-850c46a9f31c",
                    "name" : "Set Flag to No Retry",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "de6b6d80-696f-3d58-a3c7-782c1ebdfc95",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retries_exceeded", "failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ {
                    "x" : 696.0,
                    "y" : 1328.0
                  } ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "cf65e2df-ab8e-3eb1-86dd-4c1bd1a9e7c4",
                    "name" : "Failure",
                    "type" : "OUTPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "4acb4fac-b0d5-3434-93e4-9a49cfa5a7bc",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "unmatched" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "c586d455-376c-3963-807b-b6258830b7e3",
                    "name" : "Check 404 error",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "c586d455-376c-3963-807b-b6258830b7e3",
                    "name" : "Check 404 error",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "8d1e6be6-e982-3c95-87a5-fc16e059b8cb",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                    "name" : "No Retry",
                    "type" : "OUTPUT_PORT"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "e9f4559d-c3de-383e-8a7e-c0fbab947820",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "retry" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                    "name" : "RetryFlowFile",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                }, {
                  "backPressureDataSizeThreshold" : "1 GB",
                  "backPressureObjectThreshold" : 200,
                  "bends" : [ ],
                  "componentType" : "CONNECTION",
                  "destination" : {
                    "comments" : "",
                    "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                    "name" : "input",
                    "type" : "INPUT_PORT"
                  },
                  "flowFileExpiration" : "0 sec",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "bafe39b6-9de5-35d3-ab5f-bda995050b8e",
                  "labelIndex" : 1,
                  "loadBalanceCompression" : "DO_NOT_COMPRESS",
                  "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                  "name" : "",
                  "partitioningAttribute" : "",
                  "prioritizers" : [ ],
                  "selectedRelationships" : [ "not-found", "failure" ],
                  "source" : {
                    "comments" : "",
                    "groupId" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                    "id" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                    "name" : "Check For Abort",
                    "type" : "PROCESSOR"
                  },
                  "zIndex" : 0
                } ],
                "controllerServices" : [ ],
                "flowFileConcurrency" : "UNBOUNDED",
                "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                "funnels" : [ ],
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                "inputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "INPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "d962ce8e-7a18-3004-829d-7a05ae37808a",
                  "name" : "Input Bundle",
                  "position" : {
                    "x" : 576.0,
                    "y" : 24.0
                  },
                  "type" : "INPUT_PORT"
                } ],
                "labels" : [ {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 40.0,
                  "identifier" : "2cbd5081-3b4d-3219-9b2b-baceb14d4732",
                  "label" : "Note: All connections has customized back pressure settings",
                  "position" : {
                    "x" : 552.0,
                    "y" : -80.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 344.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 24.0,
                  "identifier" : "a70a040b-b8d9-3638-aaf6-0ac1b2fb963e",
                  "label" : "1xx, 3xx, 4xx codes",
                  "position" : {
                    "x" : 720.0,
                    "y" : 552.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 128.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 24.0,
                  "identifier" : "e2cc9a7b-aef7-325e-a743-dbc3856e5eb9",
                  "label" : "5xx codes",
                  "position" : {
                    "x" : 112.0,
                    "y" : 424.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 88.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 40.0,
                  "identifier" : "560727bb-c45a-385a-b599-17680003a700",
                  "label" : "Bundles will always be a supported resource type.\nNo need to check for OperationOutcome",
                  "position" : {
                    "x" : 24.0,
                    "y" : 768.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 336.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 24.0,
                  "identifier" : "a2b13a50-6180-3b0d-880d-10e9cf74188b",
                  "label" : "2xx Codes",
                  "position" : {
                    "x" : 960.0,
                    "y" : 304.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 72.0
                }, {
                  "componentType" : "LABEL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "height" : 24.0,
                  "identifier" : "587d2f5e-1904-3716-9535-242e22d4a369",
                  "label" : "General Errors",
                  "position" : {
                    "x" : 136.0,
                    "y" : 576.0
                  },
                  "style" : {
                    "font-size" : "12px"
                  },
                  "width" : 96.0
                } ],
                "name" : "Handle Auto Built Resource Bundle",
                "outputPorts" : [ {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "cf65e2df-ab8e-3eb1-86dd-4c1bd1a9e7c4",
                  "name" : "Failure",
                  "position" : {
                    "x" : -512.0,
                    "y" : 1304.0
                  },
                  "type" : "OUTPUT_PORT"
                }, {
                  "allowRemoteAccess" : false,
                  "comments" : "",
                  "componentType" : "OUTPUT_PORT",
                  "concurrentlySchedulableTaskCount" : 1,
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "63385abb-68ec-3bd9-98dd-4fffb4f9a0ab",
                  "name" : "Success",
                  "position" : {
                    "x" : 1208.0,
                    "y" : 656.0
                  },
                  "type" : "OUTPUT_PORT"
                } ],
                "parameterContextName" : "cms_adapter_parameters",
                "position" : {
                  "x" : 2720.0,
                  "y" : 1792.0
                },
                "processGroups" : [ {
                  "comments" : "",
                  "componentType" : "PROCESS_GROUP",
                  "connections" : [ {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                      "name" : "Retry",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "d8f89da6-20eb-3955-a417-59df8c025bb6",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Retry" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                      "name" : "Post Resource to FHIR Patient Access",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                      "name" : "Response",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "43071c3d-2cf1-37fa-97ac-df21d5524400",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Response" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                      "name" : "Post Resource to FHIR Patient Access",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                      "name" : "No Retry",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "9401f751-73c3-3a7b-a1ea-f9488baf787b",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "No Retry" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                      "name" : "Post Resource to FHIR Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 500,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                      "name" : "Post Resource to FHIR Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "aab94691-8c50-30fe-9e9f-966fc5898afe",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "providerDirectory" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                      "name" : "Is Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                      "name" : "Failure",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "eb302852-893e-3280-8192-8cfd9b03e420",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Failure" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                      "name" : "Post Resource to FHIR Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 500,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                      "name" : "Post Resource to FHIR Patient Access",
                      "type" : "PROCESSOR"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "f6e52f05-ff86-3dfd-8f92-695feaca59ad",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "unmatched" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                      "name" : "Is Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                      "name" : "Failure",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "b528fd50-3745-32e3-9256-7a321174a00c",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Failure" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                      "name" : "Post Resource to FHIR Patient Access",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                      "name" : "No Retry",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "637548d6-e52b-3bae-ba99-2eb27368129e",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "No Retry" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                      "name" : "Post Resource to FHIR Patient Access",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                      "name" : "Retry",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "23023de5-bc11-33bf-b61d-5b112ae77ffe",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Retry" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                      "name" : "Post Resource to FHIR Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                      "name" : "Response",
                      "type" : "OUTPUT_PORT"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "c275bfc3-60a5-3ba9-a8bc-34206982a876",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ ],
                    "selectedRelationships" : [ "Response" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                      "name" : "Post Resource to FHIR Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "zIndex" : 0
                  }, {
                    "backPressureDataSizeThreshold" : "1 GB",
                    "backPressureObjectThreshold" : 200,
                    "bends" : [ ],
                    "componentType" : "CONNECTION",
                    "destination" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                      "name" : "Is Provider Directory",
                      "type" : "PROCESSOR"
                    },
                    "flowFileExpiration" : "0 sec",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "2335ed46-6329-3cdf-8cb7-d02b93dc9b39",
                    "labelIndex" : 1,
                    "loadBalanceCompression" : "DO_NOT_COMPRESS",
                    "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
                    "name" : "",
                    "partitioningAttribute" : "",
                    "prioritizers" : [ "org.apache.nifi.prioritizer.OldestFlowFileFirstPrioritizer" ],
                    "selectedRelationships" : [ "" ],
                    "source" : {
                      "comments" : "",
                      "groupId" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                      "id" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                      "name" : "input",
                      "type" : "INPUT_PORT"
                    },
                    "zIndex" : 0
                  } ],
                  "controllerServices" : [ ],
                  "flowFileConcurrency" : "UNBOUNDED",
                  "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
                  "funnels" : [ ],
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                  "inputPorts" : [ {
                    "allowRemoteAccess" : false,
                    "comments" : "",
                    "componentType" : "INPUT_PORT",
                    "concurrentlySchedulableTaskCount" : 1,
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "a92d14d4-829d-3526-b773-0a547f8659ee",
                    "name" : "input",
                    "position" : {
                      "x" : 1448.0,
                      "y" : -344.0
                    },
                    "type" : "INPUT_PORT"
                  } ],
                  "labels" : [ {
                    "componentType" : "LABEL",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "height" : 40.0,
                    "identifier" : "d6624d62-6989-3bb9-be47-96899872fc9c",
                    "label" : "Note: All connections has customized back pressure settings",
                    "position" : {
                      "x" : 1392.0,
                      "y" : -496.0
                    },
                    "style" : {
                      "font-size" : "12px"
                    },
                    "width" : 344.0
                  } ],
                  "name" : "Post Resource Bundle to FHIR server",
                  "outputPorts" : [ {
                    "allowRemoteAccess" : false,
                    "comments" : "",
                    "componentType" : "OUTPUT_PORT",
                    "concurrentlySchedulableTaskCount" : 1,
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "3967d6fa-30e4-3659-a586-f03537b40d57",
                    "name" : "No Retry",
                    "position" : {
                      "x" : 1456.0,
                      "y" : 288.0
                    },
                    "type" : "OUTPUT_PORT"
                  }, {
                    "allowRemoteAccess" : false,
                    "comments" : "",
                    "componentType" : "OUTPUT_PORT",
                    "concurrentlySchedulableTaskCount" : 1,
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "4d7ab488-02b9-3385-9694-7c38f676af94",
                    "name" : "Response",
                    "position" : {
                      "x" : 1456.0,
                      "y" : 152.0
                    },
                    "type" : "OUTPUT_PORT"
                  }, {
                    "allowRemoteAccess" : false,
                    "comments" : "",
                    "componentType" : "OUTPUT_PORT",
                    "concurrentlySchedulableTaskCount" : 1,
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "904e5f00-7d21-3d21-9714-a9a77d41dada",
                    "name" : "Failure",
                    "position" : {
                      "x" : 1456.0,
                      "y" : 416.0
                    },
                    "type" : "OUTPUT_PORT"
                  }, {
                    "allowRemoteAccess" : false,
                    "comments" : "",
                    "componentType" : "OUTPUT_PORT",
                    "concurrentlySchedulableTaskCount" : 1,
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "fee76d5e-3a29-3847-85f5-319bbd4b3c9d",
                    "name" : "Retry",
                    "position" : {
                      "x" : 1456.0,
                      "y" : 536.0
                    },
                    "type" : "OUTPUT_PORT"
                  } ],
                  "parameterContextName" : "cms_adapter_parameters",
                  "position" : {
                    "x" : 504.0,
                    "y" : 272.0
                  },
                  "processGroups" : [ ],
                  "processors" : [ {
                    "autoTerminatedRelationships" : [ "Original" ],
                    "bulletinLevel" : "WARN",
                    "bundle" : {
                      "artifact" : "nifi-standard-nar",
                      "group" : "org.apache.nifi",
                      "version" : "1.12.1"
                    },
                    "comments" : "",
                    "componentType" : "PROCESSOR",
                    "concurrentlySchedulableTaskCount" : 24,
                    "executionNode" : "ALL",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "dd0d3b94-e11d-36eb-aae1-5d36639acde7",
                    "name" : "Post Resource to FHIR Patient Access",
                    "penaltyDuration" : "30 sec",
                    "position" : {
                      "x" : 736.0,
                      "y" : 240.0
                    },
                    "properties" : {
                      "use-etag" : "false",
                      "Prefer" : "return=${FHIRPreferSetting}",
                      "Proxy Type" : "http",
                      "Basic Authentication Password" : "#{FHIR_UserPwd_PatientAccess}",
                      "Connection Timeout" : "5 secs",
                      "send-message-body" : "true",
                      "set-form-filename" : "true",
                      "Always Output Response" : "false",
                      "etag-max-cache-size" : "10MB",
                      "disable-http2" : "False",
                      "idle-timeout" : "5 mins",
                      "Use Chunked Encoding" : "false",
                      "Follow Redirects" : "True",
                      "Remote URL" : "#{FHIR_URL_PatientAccess}${fhirUrlSuffix}",
                      "Content-Type" : "application/json",
                      "max-idle-connections" : "5",
                      "Read Timeout" : "130 secs",
                      "Max Length To Put In Attribute" : "2048",
                      "ignore-response-content" : "false",
                      "Digest Authentication" : "false",
                      "HTTP Method" : "POST",
                      "Add Response Headers to Request" : "false",
                      "Basic Authentication Username" : "#{FHIR_User_PatientAccess}",
                      "Include Date Header" : "True",
                      "Penalize on \"No Retry\"" : "false",
                      "X-FHIR-TENANT-ID" : "${tenant}"
                    },
                    "propertyDescriptors" : {
                      "Proxy Host" : {
                        "displayName" : "Proxy Host",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Host",
                        "sensitive" : false
                      },
                      "Attributes to Send" : {
                        "displayName" : "Attributes to Send",
                        "identifiesControllerService" : false,
                        "name" : "Attributes to Send",
                        "sensitive" : false
                      },
                      "use-etag" : {
                        "displayName" : "Use HTTP ETag",
                        "identifiesControllerService" : false,
                        "name" : "use-etag",
                        "sensitive" : false
                      },
                      "proxy-configuration-service" : {
                        "displayName" : "Proxy Configuration Service",
                        "identifiesControllerService" : true,
                        "name" : "proxy-configuration-service",
                        "sensitive" : false
                      },
                      "Prefer" : {
                        "displayName" : "Prefer",
                        "identifiesControllerService" : false,
                        "name" : "Prefer",
                        "sensitive" : false
                      },
                      "Proxy Type" : {
                        "displayName" : "Proxy Type",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Type",
                        "sensitive" : false
                      },
                      "Basic Authentication Password" : {
                        "displayName" : "Basic Authentication Password",
                        "identifiesControllerService" : false,
                        "name" : "Basic Authentication Password",
                        "sensitive" : true
                      },
                      "Connection Timeout" : {
                        "displayName" : "Connection Timeout",
                        "identifiesControllerService" : false,
                        "name" : "Connection Timeout",
                        "sensitive" : false
                      },
                      "send-message-body" : {
                        "displayName" : "Send Message Body",
                        "identifiesControllerService" : false,
                        "name" : "send-message-body",
                        "sensitive" : false
                      },
                      "set-form-filename" : {
                        "displayName" : "Set Flowfile Form Data File Name",
                        "identifiesControllerService" : false,
                        "name" : "set-form-filename",
                        "sensitive" : false
                      },
                      "Always Output Response" : {
                        "displayName" : "Always Output Response",
                        "identifiesControllerService" : false,
                        "name" : "Always Output Response",
                        "sensitive" : false
                      },
                      "etag-max-cache-size" : {
                        "displayName" : "Maximum ETag Cache Size",
                        "identifiesControllerService" : false,
                        "name" : "etag-max-cache-size",
                        "sensitive" : false
                      },
                      "disable-http2" : {
                        "displayName" : "disable-http2",
                        "identifiesControllerService" : false,
                        "name" : "disable-http2",
                        "sensitive" : false
                      },
                      "idle-timeout" : {
                        "displayName" : "Idle Timeout",
                        "identifiesControllerService" : false,
                        "name" : "idle-timeout",
                        "sensitive" : false
                      },
                      "Put Response Body In Attribute" : {
                        "displayName" : "Put Response Body In Attribute",
                        "identifiesControllerService" : false,
                        "name" : "Put Response Body In Attribute",
                        "sensitive" : false
                      },
                      "Use Chunked Encoding" : {
                        "displayName" : "Use Chunked Encoding",
                        "identifiesControllerService" : false,
                        "name" : "Use Chunked Encoding",
                        "sensitive" : false
                      },
                      "Follow Redirects" : {
                        "displayName" : "Follow Redirects",
                        "identifiesControllerService" : false,
                        "name" : "Follow Redirects",
                        "sensitive" : false
                      },
                      "Remote URL" : {
                        "displayName" : "Remote URL",
                        "identifiesControllerService" : false,
                        "name" : "Remote URL",
                        "sensitive" : false
                      },
                      "Content-Type" : {
                        "displayName" : "Content-Type",
                        "identifiesControllerService" : false,
                        "name" : "Content-Type",
                        "sensitive" : false
                      },
                      "form-body-form-name" : {
                        "displayName" : "Flowfile Form Data Name",
                        "identifiesControllerService" : false,
                        "name" : "form-body-form-name",
                        "sensitive" : false
                      },
                      "max-idle-connections" : {
                        "displayName" : "Max Idle Connections",
                        "identifiesControllerService" : false,
                        "name" : "max-idle-connections",
                        "sensitive" : false
                      },
                      "invokehttp-proxy-user" : {
                        "displayName" : "Proxy Username",
                        "identifiesControllerService" : false,
                        "name" : "invokehttp-proxy-user",
                        "sensitive" : false
                      },
                      "Read Timeout" : {
                        "displayName" : "Read Timeout",
                        "identifiesControllerService" : false,
                        "name" : "Read Timeout",
                        "sensitive" : false
                      },
                      "Max Length To Put In Attribute" : {
                        "displayName" : "Max Length To Put In Attribute",
                        "identifiesControllerService" : false,
                        "name" : "Max Length To Put In Attribute",
                        "sensitive" : false
                      },
                      "invokehttp-proxy-password" : {
                        "displayName" : "Proxy Password",
                        "identifiesControllerService" : false,
                        "name" : "invokehttp-proxy-password",
                        "sensitive" : true
                      },
                      "ignore-response-content" : {
                        "displayName" : "Ignore response's content",
                        "identifiesControllerService" : false,
                        "name" : "ignore-response-content",
                        "sensitive" : false
                      },
                      "Proxy Port" : {
                        "displayName" : "Proxy Port",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Port",
                        "sensitive" : false
                      },
                      "SSL Context Service" : {
                        "displayName" : "SSL Context Service",
                        "identifiesControllerService" : true,
                        "name" : "SSL Context Service",
                        "sensitive" : false
                      },
                      "Digest Authentication" : {
                        "displayName" : "Use Digest Authentication",
                        "identifiesControllerService" : false,
                        "name" : "Digest Authentication",
                        "sensitive" : false
                      },
                      "HTTP Method" : {
                        "displayName" : "HTTP Method",
                        "identifiesControllerService" : false,
                        "name" : "HTTP Method",
                        "sensitive" : false
                      },
                      "Add Response Headers to Request" : {
                        "displayName" : "Add Response Headers to Request",
                        "identifiesControllerService" : false,
                        "name" : "Add Response Headers to Request",
                        "sensitive" : false
                      },
                      "Basic Authentication Username" : {
                        "displayName" : "Basic Authentication Username",
                        "identifiesControllerService" : false,
                        "name" : "Basic Authentication Username",
                        "sensitive" : false
                      },
                      "Include Date Header" : {
                        "displayName" : "Include Date Header",
                        "identifiesControllerService" : false,
                        "name" : "Include Date Header",
                        "sensitive" : false
                      },
                      "Penalize on \"No Retry\"" : {
                        "displayName" : "Penalize on \"No Retry\"",
                        "identifiesControllerService" : false,
                        "name" : "Penalize on \"No Retry\"",
                        "sensitive" : false
                      },
                      "X-FHIR-TENANT-ID" : {
                        "displayName" : "X-FHIR-TENANT-ID",
                        "identifiesControllerService" : false,
                        "name" : "X-FHIR-TENANT-ID",
                        "sensitive" : false
                      },
                      "Useragent" : {
                        "displayName" : "Useragent",
                        "identifiesControllerService" : false,
                        "name" : "Useragent",
                        "sensitive" : false
                      }
                    },
                    "runDurationMillis" : 0,
                    "scheduledState" : "ENABLED",
                    "schedulingPeriod" : "0 sec",
                    "schedulingStrategy" : "TIMER_DRIVEN",
                    "style" : { },
                    "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                    "yieldDuration" : "1 sec"
                  }, {
                    "autoTerminatedRelationships" : [ ],
                    "bulletinLevel" : "WARN",
                    "bundle" : {
                      "artifact" : "nifi-standard-nar",
                      "group" : "org.apache.nifi",
                      "version" : "1.12.1"
                    },
                    "comments" : "",
                    "componentType" : "PROCESSOR",
                    "concurrentlySchedulableTaskCount" : 1,
                    "executionNode" : "ALL",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "9b50fd91-b5c7-3ff1-9cb1-d2cd79821c44",
                    "name" : "Is Provider Directory",
                    "penaltyDuration" : "30 sec",
                    "position" : {
                      "x" : 1392.0,
                      "y" : -152.0
                    },
                    "properties" : {
                      "Routing Strategy" : "Route to Property name",
                      "providerDirectory" : "${kafka.topic:getDelimitedField(4,'.'):toLower():startsWith('provider_directory')}"
                    },
                    "propertyDescriptors" : {
                      "Routing Strategy" : {
                        "displayName" : "Routing Strategy",
                        "identifiesControllerService" : false,
                        "name" : "Routing Strategy",
                        "sensitive" : false
                      },
                      "providerDirectory" : {
                        "displayName" : "providerDirectory",
                        "identifiesControllerService" : false,
                        "name" : "providerDirectory",
                        "sensitive" : false
                      }
                    },
                    "runDurationMillis" : 0,
                    "scheduledState" : "ENABLED",
                    "schedulingPeriod" : "0 sec",
                    "schedulingStrategy" : "TIMER_DRIVEN",
                    "style" : { },
                    "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                    "yieldDuration" : "1 sec"
                  }, {
                    "autoTerminatedRelationships" : [ "Original" ],
                    "bulletinLevel" : "WARN",
                    "bundle" : {
                      "artifact" : "nifi-standard-nar",
                      "group" : "org.apache.nifi",
                      "version" : "1.12.1"
                    },
                    "comments" : "",
                    "componentType" : "PROCESSOR",
                    "concurrentlySchedulableTaskCount" : 24,
                    "executionNode" : "ALL",
                    "groupIdentifier" : "1b0ca529-896b-3d62-b5c0-bbac2a29fe2f",
                    "identifier" : "36159631-49fa-3201-af94-7c1eb1ba7aad",
                    "name" : "Post Resource to FHIR Provider Directory",
                    "penaltyDuration" : "30 sec",
                    "position" : {
                      "x" : 2112.0,
                      "y" : 248.0
                    },
                    "properties" : {
                      "use-etag" : "false",
                      "Prefer" : "return=${FHIRPreferSetting}",
                      "Proxy Type" : "http",
                      "Basic Authentication Password" : "#{FHIR_UserPwd_ProviderDirectory}",
                      "Connection Timeout" : "5 secs",
                      "send-message-body" : "true",
                      "set-form-filename" : "true",
                      "Always Output Response" : "false",
                      "etag-max-cache-size" : "10MB",
                      "disable-http2" : "False",
                      "idle-timeout" : "5 mins",
                      "Use Chunked Encoding" : "false",
                      "Follow Redirects" : "True",
                      "Remote URL" : "#{FHIR_URL_ProviderDirectory}${fhirUrlSuffix}",
                      "Content-Type" : "application/json",
                      "max-idle-connections" : "5",
                      "Read Timeout" : "130 secs",
                      "Max Length To Put In Attribute" : "2048",
                      "ignore-response-content" : "false",
                      "Digest Authentication" : "false",
                      "HTTP Method" : "POST",
                      "Add Response Headers to Request" : "false",
                      "Basic Authentication Username" : "#{FHIR_User_ProviderDirectory}",
                      "Include Date Header" : "True",
                      "Penalize on \"No Retry\"" : "false",
                      "X-FHIR-TENANT-ID" : "${tenant}"
                    },
                    "propertyDescriptors" : {
                      "Proxy Host" : {
                        "displayName" : "Proxy Host",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Host",
                        "sensitive" : false
                      },
                      "Attributes to Send" : {
                        "displayName" : "Attributes to Send",
                        "identifiesControllerService" : false,
                        "name" : "Attributes to Send",
                        "sensitive" : false
                      },
                      "use-etag" : {
                        "displayName" : "Use HTTP ETag",
                        "identifiesControllerService" : false,
                        "name" : "use-etag",
                        "sensitive" : false
                      },
                      "proxy-configuration-service" : {
                        "displayName" : "Proxy Configuration Service",
                        "identifiesControllerService" : true,
                        "name" : "proxy-configuration-service",
                        "sensitive" : false
                      },
                      "Prefer" : {
                        "displayName" : "Prefer",
                        "identifiesControllerService" : false,
                        "name" : "Prefer",
                        "sensitive" : false
                      },
                      "Proxy Type" : {
                        "displayName" : "Proxy Type",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Type",
                        "sensitive" : false
                      },
                      "Basic Authentication Password" : {
                        "displayName" : "Basic Authentication Password",
                        "identifiesControllerService" : false,
                        "name" : "Basic Authentication Password",
                        "sensitive" : true
                      },
                      "Connection Timeout" : {
                        "displayName" : "Connection Timeout",
                        "identifiesControllerService" : false,
                        "name" : "Connection Timeout",
                        "sensitive" : false
                      },
                      "send-message-body" : {
                        "displayName" : "Send Message Body",
                        "identifiesControllerService" : false,
                        "name" : "send-message-body",
                        "sensitive" : false
                      },
                      "set-form-filename" : {
                        "displayName" : "Set Flowfile Form Data File Name",
                        "identifiesControllerService" : false,
                        "name" : "set-form-filename",
                        "sensitive" : false
                      },
                      "Always Output Response" : {
                        "displayName" : "Always Output Response",
                        "identifiesControllerService" : false,
                        "name" : "Always Output Response",
                        "sensitive" : false
                      },
                      "etag-max-cache-size" : {
                        "displayName" : "Maximum ETag Cache Size",
                        "identifiesControllerService" : false,
                        "name" : "etag-max-cache-size",
                        "sensitive" : false
                      },
                      "disable-http2" : {
                        "displayName" : "disable-http2",
                        "identifiesControllerService" : false,
                        "name" : "disable-http2",
                        "sensitive" : false
                      },
                      "idle-timeout" : {
                        "displayName" : "Idle Timeout",
                        "identifiesControllerService" : false,
                        "name" : "idle-timeout",
                        "sensitive" : false
                      },
                      "Put Response Body In Attribute" : {
                        "displayName" : "Put Response Body In Attribute",
                        "identifiesControllerService" : false,
                        "name" : "Put Response Body In Attribute",
                        "sensitive" : false
                      },
                      "Use Chunked Encoding" : {
                        "displayName" : "Use Chunked Encoding",
                        "identifiesControllerService" : false,
                        "name" : "Use Chunked Encoding",
                        "sensitive" : false
                      },
                      "Follow Redirects" : {
                        "displayName" : "Follow Redirects",
                        "identifiesControllerService" : false,
                        "name" : "Follow Redirects",
                        "sensitive" : false
                      },
                      "Remote URL" : {
                        "displayName" : "Remote URL",
                        "identifiesControllerService" : false,
                        "name" : "Remote URL",
                        "sensitive" : false
                      },
                      "Content-Type" : {
                        "displayName" : "Content-Type",
                        "identifiesControllerService" : false,
                        "name" : "Content-Type",
                        "sensitive" : false
                      },
                      "form-body-form-name" : {
                        "displayName" : "Flowfile Form Data Name",
                        "identifiesControllerService" : false,
                        "name" : "form-body-form-name",
                        "sensitive" : false
                      },
                      "max-idle-connections" : {
                        "displayName" : "Max Idle Connections",
                        "identifiesControllerService" : false,
                        "name" : "max-idle-connections",
                        "sensitive" : false
                      },
                      "invokehttp-proxy-user" : {
                        "displayName" : "Proxy Username",
                        "identifiesControllerService" : false,
                        "name" : "invokehttp-proxy-user",
                        "sensitive" : false
                      },
                      "Read Timeout" : {
                        "displayName" : "Read Timeout",
                        "identifiesControllerService" : false,
                        "name" : "Read Timeout",
                        "sensitive" : false
                      },
                      "Max Length To Put In Attribute" : {
                        "displayName" : "Max Length To Put In Attribute",
                        "identifiesControllerService" : false,
                        "name" : "Max Length To Put In Attribute",
                        "sensitive" : false
                      },
                      "invokehttp-proxy-password" : {
                        "displayName" : "Proxy Password",
                        "identifiesControllerService" : false,
                        "name" : "invokehttp-proxy-password",
                        "sensitive" : true
                      },
                      "ignore-response-content" : {
                        "displayName" : "Ignore response's content",
                        "identifiesControllerService" : false,
                        "name" : "ignore-response-content",
                        "sensitive" : false
                      },
                      "Proxy Port" : {
                        "displayName" : "Proxy Port",
                        "identifiesControllerService" : false,
                        "name" : "Proxy Port",
                        "sensitive" : false
                      },
                      "SSL Context Service" : {
                        "displayName" : "SSL Context Service",
                        "identifiesControllerService" : true,
                        "name" : "SSL Context Service",
                        "sensitive" : false
                      },
                      "Digest Authentication" : {
                        "displayName" : "Use Digest Authentication",
                        "identifiesControllerService" : false,
                        "name" : "Digest Authentication",
                        "sensitive" : false
                      },
                      "HTTP Method" : {
                        "displayName" : "HTTP Method",
                        "identifiesControllerService" : false,
                        "name" : "HTTP Method",
                        "sensitive" : false
                      },
                      "Add Response Headers to Request" : {
                        "displayName" : "Add Response Headers to Request",
                        "identifiesControllerService" : false,
                        "name" : "Add Response Headers to Request",
                        "sensitive" : false
                      },
                      "Basic Authentication Username" : {
                        "displayName" : "Basic Authentication Username",
                        "identifiesControllerService" : false,
                        "name" : "Basic Authentication Username",
                        "sensitive" : false
                      },
                      "Include Date Header" : {
                        "displayName" : "Include Date Header",
                        "identifiesControllerService" : false,
                        "name" : "Include Date Header",
                        "sensitive" : false
                      },
                      "Penalize on \"No Retry\"" : {
                        "displayName" : "Penalize on \"No Retry\"",
                        "identifiesControllerService" : false,
                        "name" : "Penalize on \"No Retry\"",
                        "sensitive" : false
                      },
                      "X-FHIR-TENANT-ID" : {
                        "displayName" : "X-FHIR-TENANT-ID",
                        "identifiesControllerService" : false,
                        "name" : "X-FHIR-TENANT-ID",
                        "sensitive" : false
                      },
                      "Useragent" : {
                        "displayName" : "Useragent",
                        "identifiesControllerService" : false,
                        "name" : "Useragent",
                        "sensitive" : false
                      }
                    },
                    "runDurationMillis" : 0,
                    "scheduledState" : "ENABLED",
                    "schedulingPeriod" : "0 sec",
                    "schedulingStrategy" : "TIMER_DRIVEN",
                    "style" : { },
                    "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
                    "yieldDuration" : "1 sec"
                  } ],
                  "remoteProcessGroups" : [ ],
                  "variables" : { }
                } ],
                "processors" : [ {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "c586d455-376c-3963-807b-b6258830b7e3",
                  "name" : "Check 404 error",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 520.0,
                    "y" : 768.0
                  },
                  "properties" : {
                    "Routing Strategy" : "Route to Property name",
                    "404Error" : "${invokehttp.status.code:equals('404')}"
                  },
                  "propertyDescriptors" : {
                    "Routing Strategy" : {
                      "displayName" : "Routing Strategy",
                      "identifiesControllerService" : false,
                      "name" : "Routing Strategy",
                      "sensitive" : false
                    },
                    "404Error" : {
                      "displayName" : "404Error",
                      "identifiesControllerService" : false,
                      "name" : "404Error",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-scripting-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "d3fa013f-91a1-3c47-9b09-b11233ea5619",
                  "name" : "Remove Warnings from Bundle Response",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : 1152.0,
                    "y" : 296.0
                  },
                  "properties" : {
                    "Script Engine" : "Groovy",
                    "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n/**\n * For \"Remove Warnings from Bundle Response\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Handle Resource Bundle\" and \n *                                                         \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Auto Build Bundle\" >> \"Handle Auto Built Resource Bundle\"\n *     \n * 1. Sets the mime and content type attributes to json if it is set to fhir+json\n * 2. If the resource is a bundle, the attribute FHIRPreferSetting is set to minimal, and the code is 2xx:  Removes the outcome field in each of the entry's response.      \n */\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles == null)\n    return\n\nString [] contentTypeAttrs = ['Content-Type', 'content-type', 'Mime.Type', 'mime.type']\n\nfor (FlowFile aFlowFile : flowFiles) {\n    \n    // Convert fhir+json to json\n    for (String attrName : contentTypeAttrs) {\n        String attr = aFlowFile.getAttribute(attrName)\n        if ( attr != null) {\n            aFlowFile = session.putAttribute(aFlowFile, attrName, attr.replace(\"fhir+json\",\"json\"))\n        }\n    }\n\n    // Get the code and prefer setting\n    String preferSetting = aFlowFile.getAttribute(\"FHIRPreferSetting\")\n    String httpStatusCode = aFlowFile.getAttribute(\"invokehttp.status.code\")\n\n    try {\n        if (httpStatusCode && httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3 &&\n            preferSetting && preferSetting.equals(\"minimal\")) {    \n    \n            aFlowFile = session.write(aFlowFile, new StreamCallback() {\n                @Override\n                void process(InputStream instream,  OutputStream outstream) throws IOException {\n                    String inputText = instream.getText()\n                    \n                    if (inputText != null && !inputText.isEmpty()) {\n                        def jsonSlurper = new JsonSlurper()\n                        Map inputJson = jsonSlurper.parseText(inputText)\n\n                        String resourceType = inputJson.getAt(\"resourceType\")\n\n                        if (resourceType != null) {\n                            if (resourceType.equals(\"Bundle\")) {\n                                // Bundle handling\n                                ArrayList entries = inputJson.getAt(\"entry\")\n\n                                if (entries != null) {\n                                    for (Map anEntry : entries) {\n                                        // Remove the output from the response\n                                        Map response = anEntry.getAt(\"response\")\n                                        if (response != null) {\n                                            Map outcome = response.remove(\"outcome\")\n                                        }\n                                    } // end loop of entries\n                                    \n                                } // End of entries != null\n                            } // end if bundle\n                        } // end if resource type != null\n                        \n                        // Write out the flowfile contents.\n                        outstream.write( JsonOutput.toJson(inputJson).getBytes(StandardCharsets.UTF_8))\n                    }\n                }\n            })\n        }\n        aFlowFile = session.putAttribute(aFlowFile, \"Content-Length\", \"\" + aFlowFile.getSize())\n        session.transfer(aFlowFile, REL_SUCCESS)\n    } catch (Exception e) {\n        log.error('Exception removing bundle response output in flowfile with UUID {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n        session.transfer(aFlowFile, REL_FAILURE)\n    }\n}\n"
                  },
                  "propertyDescriptors" : {
                    "Script File" : {
                      "displayName" : "Script File",
                      "identifiesControllerService" : false,
                      "name" : "Script File",
                      "sensitive" : false
                    },
                    "Script Engine" : {
                      "displayName" : "Script Engine",
                      "identifiesControllerService" : false,
                      "name" : "Script Engine",
                      "sensitive" : false
                    },
                    "Script Body" : {
                      "displayName" : "Script Body",
                      "identifiesControllerService" : false,
                      "name" : "Script Body",
                      "sensitive" : false
                    },
                    "Module Directory" : {
                      "displayName" : "Module Directory",
                      "identifiesControllerService" : false,
                      "name" : "Module Directory",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.script.ExecuteScript",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "a5095696-e63e-306f-b55f-ade6ff1459c6",
                  "name" : "Check For Abort",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : -936.0,
                    "y" : 328.0
                  },
                  "properties" : {
                    "Cache Entry Identifier" : "abort-${sourceBatchId}",
                    "Put Cache Value In Attribute" : "abortedReason",
                    "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
                    "Max Length To Put In Attribute" : "256",
                    "Character Set" : "UTF-8"
                  },
                  "propertyDescriptors" : {
                    "Cache Entry Identifier" : {
                      "displayName" : "Cache Entry Identifier",
                      "identifiesControllerService" : false,
                      "name" : "Cache Entry Identifier",
                      "sensitive" : false
                    },
                    "Put Cache Value In Attribute" : {
                      "displayName" : "Put Cache Value In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Put Cache Value In Attribute",
                      "sensitive" : false
                    },
                    "Distributed Cache Service" : {
                      "displayName" : "Distributed Cache Service",
                      "identifiesControllerService" : true,
                      "name" : "Distributed Cache Service",
                      "sensitive" : false
                    },
                    "Max Length To Put In Attribute" : {
                      "displayName" : "Max Length To Put In Attribute",
                      "identifiesControllerService" : false,
                      "name" : "Max Length To Put In Attribute",
                      "sensitive" : false
                    },
                    "Character Set" : {
                      "displayName" : "Character Set",
                      "identifiesControllerService" : false,
                      "name" : "Character Set",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.FetchDistributedMapCache",
                  "yieldDuration" : "1 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-standard-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "0a18f11a-0de7-326c-8fa2-0bc78ed84912",
                  "name" : "RetryFlowFile",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : -568.0,
                    "y" : 552.0
                  },
                  "properties" : {
                    "penalize-retries" : "true",
                    "maximum-retries" : "3",
                    "Fail on Non-numerical Overwrite" : "false",
                    "reuse-mode" : "fail",
                    "retry-attribute" : "postAutoBundleResource.retries"
                  },
                  "propertyDescriptors" : {
                    "penalize-retries" : {
                      "displayName" : "Penalize Retries",
                      "identifiesControllerService" : false,
                      "name" : "penalize-retries",
                      "sensitive" : false
                    },
                    "maximum-retries" : {
                      "displayName" : "Maximum Retries",
                      "identifiesControllerService" : false,
                      "name" : "maximum-retries",
                      "sensitive" : false
                    },
                    "Fail on Non-numerical Overwrite" : {
                      "displayName" : "Fail on Non-numerical Overwrite",
                      "identifiesControllerService" : false,
                      "name" : "Fail on Non-numerical Overwrite",
                      "sensitive" : false
                    },
                    "reuse-mode" : {
                      "displayName" : "Reuse Mode",
                      "identifiesControllerService" : false,
                      "name" : "reuse-mode",
                      "sensitive" : false
                    },
                    "retry-attribute" : {
                      "displayName" : "Retry Attribute",
                      "identifiesControllerService" : false,
                      "name" : "retry-attribute",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.standard.RetryFlowFile",
                  "yieldDuration" : "30 sec"
                }, {
                  "autoTerminatedRelationships" : [ ],
                  "bulletinLevel" : "WARN",
                  "bundle" : {
                    "artifact" : "nifi-update-attribute-nar",
                    "group" : "org.apache.nifi",
                    "version" : "1.12.1"
                  },
                  "comments" : "",
                  "componentType" : "PROCESSOR",
                  "concurrentlySchedulableTaskCount" : 1,
                  "executionNode" : "ALL",
                  "groupIdentifier" : "2fae2a31-8544-3a80-b6db-3435486a44b0",
                  "identifier" : "72ab2849-7ea3-372d-957d-850c46a9f31c",
                  "name" : "Set Flag to No Retry",
                  "penaltyDuration" : "30 sec",
                  "position" : {
                    "x" : -568.0,
                    "y" : 968.0
                  },
                  "properties" : {
                    "Store State" : "Do not store state",
                    "canonical-value-lookup-cache-size" : "100",
                    "noRetry" : "true"
                  },
                  "propertyDescriptors" : {
                    "Delete Attributes Expression" : {
                      "displayName" : "Delete Attributes Expression",
                      "identifiesControllerService" : false,
                      "name" : "Delete Attributes Expression",
                      "sensitive" : false
                    },
                    "Store State" : {
                      "displayName" : "Store State",
                      "identifiesControllerService" : false,
                      "name" : "Store State",
                      "sensitive" : false
                    },
                    "canonical-value-lookup-cache-size" : {
                      "displayName" : "Cache Value Lookup Cache Size",
                      "identifiesControllerService" : false,
                      "name" : "canonical-value-lookup-cache-size",
                      "sensitive" : false
                    },
                    "Stateful Variables Initial Value" : {
                      "displayName" : "Stateful Variables Initial Value",
                      "identifiesControllerService" : false,
                      "name" : "Stateful Variables Initial Value",
                      "sensitive" : false
                    },
                    "noRetry" : {
                      "displayName" : "noRetry",
                      "identifiesControllerService" : false,
                      "name" : "noRetry",
                      "sensitive" : false
                    }
                  },
                  "runDurationMillis" : 0,
                  "scheduledState" : "ENABLED",
                  "schedulingPeriod" : "0 sec",
                  "schedulingStrategy" : "TIMER_DRIVEN",
                  "style" : { },
                  "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                  "yieldDuration" : "1 sec"
                } ],
                "remoteProcessGroups" : [ ],
                "variables" : { }
              } ],
              "processors" : [ {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "ca4cbc40-0151-3517-8a1f-32190d0f1bb8",
                "name" : "Flag Merge Failure",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 2480.0,
                  "y" : 2624.0
                },
                "properties" : {
                  "Cache Entry Identifier" : "FailedMerge_${tenant}_${messageBatchId}_${copyId}",
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.distributed.cache.client.DistributedMapCacheClient\nimport org.apache.nifi.distributed.cache.client.Serializer\nimport org.apache.nifi.distributed.cache.client.exception.SerializationException\nimport org.apache.nifi.expression.AttributeExpression\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.logging.ComponentLog\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.util.StandardValidators\n\n/**\n * For \"Flag Merge Failure\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Auto Build Bundle\"\n *\n * If flowfile is original (i.e. copy.index == 0) , adds FailedMerge_<tenantId>_<messageBatchId>_<copyId> entry to the DistributedCacheMap\n */\nclass FlagAutoBundleMergeFailed extends AbstractProcessor {\n\n    public static final PropertyDescriptor PROP_DISTRIBUTED_CACHE_SERVICE = new PropertyDescriptor.Builder()\n    .name(\"Distributed Cache Service\")\n    .description(\"The Controller Service that is used to set the cached value.\")\n    .required(true)\n    .identifiesControllerService(DistributedMapCacheClient.class)\n    .build()\n\n    public static final PropertyDescriptor PROP_CACHE_ENTRY_IDENTIFIER = new PropertyDescriptor.Builder()\n    .name(\"Cache Entry Identifier\")\n    .description(\"A FlowFile attribute, or the results of an Attribute Expression Language statement, which will be evaluated \" +\n    \"against a FlowFile in order to determine the value used to identify duplicates; it is this value that is cached\")\n    .required(true)\n    .addValidator(StandardValidators.createAttributeExpressionLanguageValidator(AttributeExpression.ResultType.STRING, true))\n    .defaultValue('FailedMerge_${tenant}_${messageBatchId}_${copyId}')\n    .expressionLanguageSupported(ExpressionLanguageScope.FLOWFILE_ATTRIBUTES)\n    .build()\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n    .name(\"success\")\n    .description(\"If successful flowfiles will be routed to this relationship\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"There was an error, the FlowFile will be routed to this relationship\")\n    .build()\n\n    private final Set<Relationship> relationships\n\n    private final Serializer<String> stringSerializer = new Serializer<String>() {\n        @Override\n        void serialize(String value, OutputStream output) throws SerializationException, IOException {\n            output.write(value.getBytes(StandardCharsets.UTF_8))\n        }\n    }\n\n    FlagAutoBundleMergeFailed() {\n        final Set<Relationship> rels = new HashSet<>()\n        rels.add(REL_SUCCESS)\n        rels.add(REL_FAILURE)\n        relationships = Collections.unmodifiableSet(rels)\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_CACHE_ENTRY_IDENTIFIER)\n        descriptors.add(PROP_DISTRIBUTED_CACHE_SERVICE)\n        return descriptors\n    }\n\n    @Override\n    Set<Relationship> getRelationships() {\n        return relationships\n    }\n\n    @Override\n    void onTrigger(final ProcessContext context, final ProcessSession session) throws ProcessException {\n        ComponentLog logger = getLogger()\n        DistributedMapCacheClient cache = context.getProperty(PROP_DISTRIBUTED_CACHE_SERVICE).asControllerService(DistributedMapCacheClient.class)\n\n        List<FlowFile> flowFiles = session.get(100)\n        if (flowFiles != null) {\n            for (FlowFile flowFile : flowFiles) {\n\n                String cacheKey = context.getProperty(PROP_CACHE_ENTRY_IDENTIFIER).evaluateAttributeExpressions(flowFile).getValue()\n                if (StringUtils.isBlank(cacheKey)) {\n                    logger.error(\"FlowFile with UUID {} has no attribute for given Cache Entry Identifier\", [flowFile.getAttribute(\"uuid\")])\n                    session.transfer(flowFile, REL_FAILURE)\n                    continue\n                }\n\n                String copyIndex = flowFile.getAttribute( \"copy.index\")\n                \n                if (copyIndex) {\n                    if (copyIndex.equals(\"0\")) {\n                        try {\n                            // Add the flag to the cache\n                            cache.put(cacheKey, \"true\", stringSerializer, stringSerializer)\n                            String copyId = flowFile.getAttribute( \"copyId\")\n                            logger.info(\"Interop FHIR Adapter - Set flag for autobundle merge failure for flowfile with copyId of {}\", copyId)\n                            session.transfer(flowFile, REL_SUCCESS)\n                        } catch (IOException e) {\n                            logger.error(\"Interop FHIR Adapter - Execption adding autobundle merge failure flag to DistributedCacheMap\", e)\n                            session.transfer(flowFile, REL_FAILURE)\n                        }\n                    } else if (copyIndex.equals(\"1\")) {\n                        session.transfer(flowFile, REL_SUCCESS)\n                        // Remove the cache if this is the FHIR flowfile in case it exists\n                        cache.remove(cacheKey, stringSerializer)\n                    } else {\n                        logger.error(\"Interop FHIR Adapter - Copy index set to unexpected number {} while attempting to set autobundle merge failure flag.  UUID: {}\", [copyIndex, flowFile.getAttribute(\"uuid\")] as Object[])\n                        session.transfer(flowFile, REL_FAILURE)\n                    }\n                } else {\n                    logger.error(\"Interop FHIR Adapter - Copy index not found while attempting to set autobundle merge failure flag.  UUID: {}\", [flowFile.getAttribute(\"uuid\")] as Object[])\n                    session.transfer(flowFile, REL_FAILURE)\n                }\n            }\n        }\n    }\n}\n\nprocessor = new FlagAutoBundleMergeFailed()\n",
                  "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Cache Entry Identifier" : {
                    "displayName" : "Cache Entry Identifier",
                    "identifiesControllerService" : false,
                    "name" : "Cache Entry Identifier",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Distributed Cache Service" : {
                    "displayName" : "Distributed Cache Service",
                    "identifiesControllerService" : true,
                    "name" : "Distributed Cache Service",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "f590582d-39e1-3fde-82ca-cb618a4eca53",
                "name" : "Setup Original for Merge",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 1992.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "fragment.identifier" : "${copyId}",
                  "fragment.index" : "${copy.index}",
                  "fragment.count" : "2",
                  "priority" : "3"
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "fragment.identifier" : {
                    "displayName" : "fragment.identifier",
                    "identifiesControllerService" : false,
                    "name" : "fragment.identifier",
                    "sensitive" : false
                  },
                  "fragment.index" : {
                    "displayName" : "fragment.index",
                    "identifiesControllerService" : false,
                    "name" : "fragment.index",
                    "sensitive" : false
                  },
                  "fragment.count" : {
                    "displayName" : "fragment.count",
                    "identifiesControllerService" : false,
                    "name" : "fragment.count",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  },
                  "priority" : {
                    "displayName" : "priority",
                    "identifiesControllerService" : false,
                    "name" : "priority",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "4117bc79-c1d6-3722-9ec2-f3d5e2880e26",
                "name" : "Process Results",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 3248.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.InputStreamCallback\nimport org.apache.nifi.processor.io.OutputStreamCallback\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.expression.AttributeExpression\nimport org.apache.nifi.expression.ExpressionLanguageScope\n\n/**\n * For the \"Process Results\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> Auto Build Bundle\"\"\n *\n * Processes the flow file expected after the merging of an auto bundle and the results of the FHIR server call using that auto bundle.\n * This script will create a new flow file for each entry in the auto bundle.\n * If there were errors on the call to FHIR, the output flowfile contents will be set to the bundle entry resource contents and sent to\n * the retry output relationship to retried as a single resource on the FHIR server.\n *\n * If the FHIR call has a 200 or 201 HTTP status code, the bundle was successfully stored on the FHIR server.  New flow files will be\n * created for each of the bundle entries, status code set from the response, and the flow file contents will be set to the entry's resource\n * content if it exists.  If the resource doesn't exist in the entry, then the flow file's content will be blank.\n *\n *\n */\nclass ProcessAutoBundleResults extends AbstractProcessor {\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n    .name(\"success\")\n    .description(\"The contents of the resource bundle were successfully saved in the FHIR server and a flowfile for each bundle entry sent to this relationship with the entry's operation outcome results in the content.\")\n    .build()\n\n    public static final Relationship REL_RETRY = new Relationship.Builder()\n    .name(\"retry\")\n    .description(\"There was an error in the auto generated bundle or building the generated bundle.  A flowfile for each bundle entry is sent to this relationship with the original resource in the content in order to be sent to FHIR individually.\")\n    .build()\n\n     public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n     @Override\n    Set<Relationship> getRelationships() {\n        [REL_SUCCESS, REL_RETRY] as Set\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    /**\n     * Class that handles reading the flowfile after attempting to save an auto bundle to FHIR.\n     */\n    public class DetermineAutoBundleFHIRResults extends InputStreamCallback {\n        private FlowFile inputFlowFile = null\n        private ArrayList entryAttributes = new ArrayList()\n        private ArrayList entries = new ArrayList()\n        private ArrayList entryResults = new ArrayList()\n        private boolean retry = false;\n        private boolean deleteFlowFile = false;\n\n        public DetermineAutoBundleFHIRResults(FlowFile inputFlowFile) {\n            super();\n            this.inputFlowFile = inputFlowFile\n        }\n\n         public ArrayList getEntryAttributes() {\n            return entryAttributes\n        }\n\n        public ArrayList getEntries() {\n            return entries\n        }\n\n        public ArrayList getEntryResults() {\n            return entryResults\n        }\n\n        public boolean isRetry() {\n            return retry\n        }\n\n        public boolean setRetry(boolean retry) {\n            this.retry = retry;\n        }\n\n        public boolean isDeleteFlowFile() {\n            return deleteFlowFile;\n        }\n\n        private void setDeleteFlowFile(boolean deleteFlowFile) {\n            this.deleteFlowFile = deleteFlowFile;\n        }\n\n        /**\n         * Determines if there was a failure posting to FHIR and marks this object to send flowfiles to the retry connection.\n         * The entry collections will be populated from the flowfile contents.\n         * @param instream\n         * @throws IOException\n         */\n        @Override\n        void process(InputStream instream) throws IOException {\n             // Grab the failure flag if it exists\n            def autoBundleFailedFlag = this.inputFlowFile.getAttribute(\"autoBundleFailed\")\n\n            if (autoBundleFailedFlag) {\n                if (autoBundleFailedFlag.equalsIgnoreCase(\"true\"))\n                    setRetry(true)\n            }\n\n            // If no failed flag, check for the HTTP status code\n            if (!isRetry()) {\n                String httpStatusCode = this.inputFlowFile.getAttribute(\"invokehttp.status.code\")\n                if (!httpStatusCode || !httpStatusCode.startsWith(\"2\"))\n                    setRetry(true)\n            }\n\n            // Now get the entries in the flowfile content\n            def jsonSlurper = new JsonSlurper()\n            def inputFileContent = jsonSlurper.parse(instream, \"UTF-8\")\n            processFlowFileContent(inputFileContent)\n\n        }\n\n\n        /**\n         * Sets this object's entry collections using the provided flowfile content expected to be a json array or map.\n         * The method expects \"retry\" to be set before being invoked.\n         *\n         * @param jsonContnet\n         */\n        public void processFlowFileContent(def jsonContent) {\n            Map attributesAndBundle = null\n            Map fhirResults = null;\n\n            // Check if the content is an array or if it is a json object\n            if (jsonContent instanceof List) {\n                ArrayList fileContentArray = (ArrayList) jsonContent\n                attributesAndBundle = fileContentArray.get(0)\n                // If this was a successful save, grab the FHIR server results\n                if (!isRetry()) {\n                    if (fileContentArray.size > 1) {\n                        fhirResults = fileContentArray.get(1)\n                    } else {\n                        setRetry(true)\n                    }\n                }\n            } else {\n                // Must be a map.  Would only happen if there was a failure to merge in the flowfile\n                Map fileContentMap = (Map) jsonContent\n\n                // only process if it has both attributes and bundle\n                if (fileContentMap.containsKey(\"flowfileAttributes\") && fileContentMap.containsKey(\"bundle\")) {\n                    attributesAndBundle = fileContentMap\n\n                } else {\n                    // this is not the original, just discard this extra flowfile\n                    setDeleteFlowFile(true)\n                    return\n                }\n            }\n\n            // Now populate the entry information in this object\n            this.entryAttributes = attributesAndBundle.get(\"flowfileAttributes\")\n            Map resourceBundle = attributesAndBundle.get(\"bundle\")\n            this.entries = resourceBundle.getAt(\"entry\")\n\n            // If this is a successful push to the FHIR server, Grab the Operation Outcomes from each entry if returned.\n            if (!isRetry()) {\n                this.entryResults = fhirResults.getAt(\"entry\")\n            }\n        }\n     }\n\n    /**\n     * Updates the flowfile with the provided content.\n     */\n    public class FlowFileWriter extends OutputStreamCallback {\n        private String content = \"\";\n\n        public FlowFileWriter(String content) {\n            super()\n            this.content = content\n        }\n\n        @Override\n        void process(OutputStream outstream) throws IOException {\n            outstream.write(this.content.getBytes(StandardCharsets.UTF_8))\n        }\n    }\n\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        ArrayList<FlowFile> inputFlowFiles = session.get(numberOfFlowfilesToPull)\n\n        if (!inputFlowFiles)\n            return\n\n        for (FlowFile sourceFlowFile : inputFlowFiles) {\n\t\t\t// Read in the flowfile to determine action and how many flowfiles to create\n\t\t\tDetermineAutoBundleFHIRResults fhirResults = new DetermineAutoBundleFHIRResults(sourceFlowFile)\n\t\t\ttry {\n\t\t\t\tsession.read(sourceFlowFile, fhirResults)\n\t\t\t} catch (Exception e) {\n\t\t\t\tgetLogger().error('Exception during processing auto bundling results in flowfile with UUID: {}', [sourceFlowFile.getAttribute(\"uuid\")] as Object[], e)\n                throw new ProcessException(e)\n\t\t\t}\n\n\t\t\t// Remove the flowfile if marked to delete and no longer continue\n\t\t\tif (fhirResults.deleteFlowFile) {\n\t\t\t\ttry {\n\t\t\t\t\tsession.remove(sourceFlowFile)\n\t\t\t\t} catch (Exception e) {\n\t\t\t\t\tgetLogger().error('Exception removing auto bundle source file from session', e)\n                    throw new ProcessException(e)\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n            try {\n                for (int i = 0; i < fhirResults.getEntryAttributes().size(); i++) {\n                    FlowFile outputFlowFile = session.create(sourceFlowFile);\n                    String content = \"\"\n                    String statusCode = null\n\n                    // if it was a failure, set the content to the original resource.\n                    if (fhirResults.isRetry()) {\n                        Map entryResource = fhirResults.getEntries().get(i)\n                        content = JsonOutput.toJson(entryResource.getAt(\"resource\"))\n                    } else {\n                        // Was successful.  May or may not have an OperationOutcome.  Merge issue array from resource and response\n                        Map bundleEntry = fhirResults.getEntryResults().get(i)\n                        Map newOutput = new LinkedHashMap<>();\n                        if (bundleEntry.containsKey(\"resource\")) {\n                            Map entryResource = bundleEntry.getAt(\"resource\")\n                            newOutput.putAll(entryResource)       \n                        }\n\n                        // Set the status code and pull in any reponse OO entries\n                        if (bundleEntry.containsKey(\"response\")) {\n                            Map entryResponse = bundleEntry.getAt(\"response\")\n                            statusCode = entryResponse.getAt(\"status\")\n                            Map outcome = entryResponse.getAt(\"outcome\")\n                            if (outcome != null) {\n                                if (newOutput.isEmpty()) {\n                                    // just copy the OO\n                                    newOutput.putAll(outcome)\n                                } else {\n                                    // need to merge issues\n                                    ArrayList responseIssues = outcome.getAt(\"issue\")\n                                    if (responseIssues) {\n                                        ArrayList existingIssues = newOutput.getAt(\"issue\")\n                                        ArrayList newIssues = null\n                                        if (existingIssues == null) {\n                                            newIssues = new ArrayList()\n                                        } else {\n                                            newIssues = new ArrayList(existingIssues)\n                                        }\n                                        newOutput.put(\"issue\", newIssues)\n\n                                        newIssues.addAll(responseIssues)\n                                    }\n                                }\n                            }\n                        }\n\n                        if (!newOutput.isEmpty()) {\n                            content = JsonOutput.toJson(newOutput)\n                        }\n                    }\n                    // Write out the flowfile content\n                    outputFlowFile = session.write(outputFlowFile, new FlowFileWriter(content))\n\n                    // Update the attributes for the output flowfile\n                    if (!fhirResults.isRetry()) {\n                        if (statusCode) {\n                            outputFlowFile = session.putAttribute(outputFlowFile, \"invokehttp.status.code\", statusCode)\n                        }\n                    } else {\n                        // remove attributes that may cause conflict for retry\n                        outputFlowFile = session.removeAttribute(outputFlowFile, \"invokehttp.status.code\")\n                        outputFlowFile = session.removeAttribute(outputFlowFile, \"invokehttp.status.message\")\n                    }\n\n                    // Cleanup any unwanted attributes\n                    Set<String> setOfAttributesToRemove = [\"copy.index\", \"copyId\", \"fragment.count\", \"fragment.identifier\", \"fragment.index\", \"segment.original.filename\", \"merge.bin.age\", \"merge.count\"]\n\n                    outputFlowFile = session.removeAllAttributes(outputFlowFile, setOfAttributesToRemove)\n\n                    // add the preserved attributes to the flowfile\n                    Map preservedAttributes = fhirResults.getEntryAttributes().getAt(i)\n                    outputFlowFile = session.putAllAttributes(outputFlowFile, preservedAttributes )\n\n                    // Update the size of the content\n                    outputFlowFile = session.putAttribute(outputFlowFile, \"Content-Length\", \"\" + outputFlowFile.getSize())\n\n                    // Send flowfile to relationship\n                    if (fhirResults.isRetry()) {\n                        session.transfer(outputFlowFile, REL_RETRY)\n                    } else {\n                        session.transfer(outputFlowFile, REL_SUCCESS)\n                    }\n                }\n\n            } catch (Exception e) {\n                getLogger().error('Exception during the generation of the output flowfile from autobundle process results', e)\n                throw new ProcessException(e)\n            }\n\n            // Delete the source flowfile\n            session.remove(sourceFlowFile)\n\t\t}\n    }\n}\n\nprocessor = new ProcessAutoBundleResults()\n",
                  "Number of flowfiles to pull" : "100"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Number of flowfiles to pull" : {
                    "displayName" : "Number of flowfiles to pull",
                    "identifiesControllerService" : false,
                    "name" : "Number of flowfiles to pull",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "original" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "This processor uses the 'fragement' properties that were previously set into the flow files to 'de-fragment' the batch.\nThe merged flow file will contain all FHIR resources for which a publish attempt was made, as a json array.\n\nThe metadata strategy is to only include attributes with the same key and value in the merged file.  This is important for the batch status, because if some files are published and some fail, the batch status attribute will not exist (will be null).",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "340155c4-5709-398a-a6b4-030eceb17fd2",
                "name" : "Merge FHIR Response",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 2624.0
                },
                "properties" : {
                  "Keep Path" : "false",
                  "Merge Strategy" : "Defragment",
                  "Attribute Strategy" : "Keep All Unique Attributes",
                  "Compression Level" : "1",
                  "Maximum Number of Entries" : "2",
                  "Minimum Group Size" : "0 B",
                  "Maximum number of Bins" : "50000",
                  "Tar Modified Time" : "${file.lastModifiedTime}",
                  "Delimiter Strategy" : "Text",
                  "Merge Format" : "Binary Concatenation",
                  "Footer File" : "]",
                  "Max Bin Age" : "10 minutes",
                  "Demarcator File" : ",",
                  "Header File" : "[",
                  "mergecontent-metadata-strategy" : "Keep Only Common Metadata",
                  "Minimum Number of Entries" : "2"
                },
                "propertyDescriptors" : {
                  "Keep Path" : {
                    "displayName" : "Keep Path",
                    "identifiesControllerService" : false,
                    "name" : "Keep Path",
                    "sensitive" : false
                  },
                  "Maximum Group Size" : {
                    "displayName" : "Maximum Group Size",
                    "identifiesControllerService" : false,
                    "name" : "Maximum Group Size",
                    "sensitive" : false
                  },
                  "Merge Strategy" : {
                    "displayName" : "Merge Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Merge Strategy",
                    "sensitive" : false
                  },
                  "Attribute Strategy" : {
                    "displayName" : "Attribute Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Attribute Strategy",
                    "sensitive" : false
                  },
                  "Compression Level" : {
                    "displayName" : "Compression Level",
                    "identifiesControllerService" : false,
                    "name" : "Compression Level",
                    "sensitive" : false
                  },
                  "Maximum Number of Entries" : {
                    "displayName" : "Maximum Number of Entries",
                    "identifiesControllerService" : false,
                    "name" : "Maximum Number of Entries",
                    "sensitive" : false
                  },
                  "Minimum Group Size" : {
                    "displayName" : "Minimum Group Size",
                    "identifiesControllerService" : false,
                    "name" : "Minimum Group Size",
                    "sensitive" : false
                  },
                  "Maximum number of Bins" : {
                    "displayName" : "Maximum number of Bins",
                    "identifiesControllerService" : false,
                    "name" : "Maximum number of Bins",
                    "sensitive" : false
                  },
                  "Tar Modified Time" : {
                    "displayName" : "Tar Modified Time",
                    "identifiesControllerService" : false,
                    "name" : "Tar Modified Time",
                    "sensitive" : false
                  },
                  "Delimiter Strategy" : {
                    "displayName" : "Delimiter Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Delimiter Strategy",
                    "sensitive" : false
                  },
                  "Merge Format" : {
                    "displayName" : "Merge Format",
                    "identifiesControllerService" : false,
                    "name" : "Merge Format",
                    "sensitive" : false
                  },
                  "Footer File" : {
                    "displayName" : "Footer",
                    "identifiesControllerService" : false,
                    "name" : "Footer File",
                    "sensitive" : false
                  },
                  "Max Bin Age" : {
                    "displayName" : "Max Bin Age",
                    "identifiesControllerService" : false,
                    "name" : "Max Bin Age",
                    "sensitive" : false
                  },
                  "Demarcator File" : {
                    "displayName" : "Demarcator",
                    "identifiesControllerService" : false,
                    "name" : "Demarcator File",
                    "sensitive" : false
                  },
                  "Correlation Attribute Name" : {
                    "displayName" : "Correlation Attribute Name",
                    "identifiesControllerService" : false,
                    "name" : "Correlation Attribute Name",
                    "sensitive" : false
                  },
                  "Header File" : {
                    "displayName" : "Header",
                    "identifiesControllerService" : false,
                    "name" : "Header File",
                    "sensitive" : false
                  },
                  "mergecontent-metadata-strategy" : {
                    "displayName" : "Metadata Strategy",
                    "identifiesControllerService" : false,
                    "name" : "mergecontent-metadata-strategy",
                    "sensitive" : false
                  },
                  "Minimum Number of Entries" : {
                    "displayName" : "Minimum Number of Entries",
                    "identifiesControllerService" : false,
                    "name" : "Minimum Number of Entries",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.MergeContent",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "d1e72f4b-1a02-30cd-a870-f9adce1538f8",
                "name" : "Build Resource Bundle",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 944.0
                },
                "properties" : {
                  "Maximum resources in bundle" : "#{maxResourcesInBundle}",
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.io.InputStreamCallback\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.expression.AttributeExpression\nimport org.apache.nifi.expression.ExpressionLanguageScope\n\n/**\n * For the \"Build Resource Bundle\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> Auto Build Bundle\"\"\n *\n * Collects a number of FlowFiles that contains a FHIR resource and builds a resource bundle to be sent to the FHIR server.\n * This script also captures the flowfile attributes needed when the bundle is split up again into individual flowfiles.\n * The resulting flowfile content will have a section that contains the flowfile attributes in an array corresponding to the bundle entry.\n * Another section will contain the resource bundle to be sent to FHIR.\n * The copyId and segment.original.filename attributes are set for the duplicate flowfile processor later on the flow.\n */\nclass BuildNewBundleFromResources extends AbstractProcessor {\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n    .name(\"success\")\n    .description(\"If the resources were successfully added to a resource bundle and a single merged flowfile will be routed to this relationship\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"If there was a failure to generate the resource bundle, the FlowFile will be penalized and routed to this relationship\")\n    .build()\n\n    public static final PropertyDescriptor PROP_MAX_BUNDLE_ENTRIES = new PropertyDescriptor.Builder()\n    .name(\"Maximum resources in bundle\")\n    .description(\"The maximum number of FHIR resources to add to a generated bundle sent to the FHIR Server\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"20\")\n    .expressionLanguageSupported(ExpressionLanguageScope.FLOWFILE_ATTRIBUTES)\n    .build()\n\n    public static final PropertyDescriptor PROP_BUNDLE_GROUP_KEY = new PropertyDescriptor.Builder()\n    .name(\"Bundle Group Key\")\n    .description(\"The key used to determine which collection of flowfiles belong in the same bundle.  Use the NiFi expression language and flowfile attributes to create \" +\n                 \"a key that ensures all flowfiles in a bundle will be stored in the proper FHIR server.  The information in the first flowfile of a bundle is used to connect to the FHIR server. \" +\n                 \"If this is set to a constant value, then flowfiles will not be sorted.  For instance, if the flow is supporting multi-tenancy and the tenant id is not part of the key, then \" +\n                 \"flowfiles for both tenants may end up in the same bundle being sent to one FHIR server.\")\n    .required(true)\n    .addValidator(StandardValidators.NON_EMPTY_VALIDATOR)\n    .defaultValue('${kafka.topic}')\n    .expressionLanguageSupported(ExpressionLanguageScope.FLOWFILE_ATTRIBUTES)\n    .build()\n\n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_SUCCESS, REL_FAILURE] as Set\n    }\n\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_MAX_BUNDLE_ENTRIES)\n        descriptors.add(PROP_BUNDLE_GROUP_KEY)\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    /**\n     * Class that handles capturing the needed attributes and content from a flowfile\n     */\n    public class ProcessInputFlowFile extends InputStreamCallback {\n        private FlowFile inputFlowFile = null\n        private ArrayList entryAttributes = new ArrayList()\n        private ArrayList entries = new ArrayList()\n        private Set<String> attributesToIgnore = null;\n\n        public ProcessInputFlowFile() {\n            super();\n        }\n\n        public ProcessInputFlowFile(Set<String> attributesToIgnore) {\n            super();\n            this.attributesToIgnore = attributesToIgnore\n        }\n\n        public void setFlowFile(FlowFile inputFlowFile) {\n            this.inputFlowFile = inputFlowFile\n        }\n\n         public ArrayList getEntryAttributes() {\n            return entryAttributes;\n        }\n\n        public ArrayList getEntries() {\n            return entries;\n        }\n\n        /**\n         * The set of attributes not preserved in the flowfile.\n         * @return\n         */\n        public Set<String> getAttributesToIgnore() {\n            return attributesToIgnore;\n        }\n\n        /**\n         * Sets the set of flowfile attributes to ignore.  Attributes in this set will not be preserved.\n         * @param attributesToIgnore\n         */\n        public void setAttributesToIgnore(Set<String> attributesToIgnore) {\n            this.attributesToIgnore = attributesToIgnore;\n        }\n\n        @Override\n        void process(InputStream instream) throws IOException {\n            def jsonSlurper = new JsonSlurper()\n            Map inputFHIRResource = jsonSlurper.parse(instream, \"UTF-8\")\n            Map attributes = retrieveAttributesFromFlowFile(this.inputFlowFile, getAttributesToIgnore())\n\n            // Grab the FHIR resource tag to be added to each resource\n            String fhirResourceTag = this.inputFlowFile.getAttribute(\"FHIRResourceTag\")\n\n            processFlowFile(inputFHIRResource, attributes, fhirResourceTag)\n        }\n\n        /*\n         * Pulls the needed attributes out of the flowfile and returns them in JSON format\n         */\n        public Map retrieveAttributesFromFlowFile(FlowFile aFlowFile, Set<String> attributesToIgnore) {\n            Map attributeJson = [:]\n            attributeJson.putAll(aFlowFile.getAttributes())\n\n            // Remove the ignored attributes\n            if (attributesToIgnore)\n                attributeJson.keySet().removeAll(attributesToIgnore)\n\n            return attributeJson\n        }\n\n        /**\n         * Adds the FlowFile attributes and bundle entries to the collection.\n         * @param inputFHIRResource\n         * @param attributes\n         * @param fhirResourceTag\n         * @return\n         */\n        public void processFlowFile(Map inputFHIRResource, Map attributes, String fhirResourceTag) {\n            // Just add the attributes as is\n            entryAttributes.add(attributes)\n\n            // Ensure the input resource has the required tag\n            inputFHIRResource = addTagToResource(inputFHIRResource, fhirResourceTag)\n\n            // Need to wrap the input FHIR resource into an entry json including which command to retrieve.\n            Map entryJson = [\"resource\":inputFHIRResource]\n\n            Map requestEntry = [:]\n            def resourceType = inputFHIRResource.getAt(\"resourceType\")\n\n            if (inputFHIRResource.containsKey(\"id\"))\n                requestEntry = [\"method\": \"PUT\", \"url\": resourceType + '/' + inputFHIRResource.getAt(\"id\")]\n            else\n                requestEntry = [\"method\": \"POST\", \"url\": resourceType]\n\n            entryJson.putAt(\"request\", requestEntry)\n\n            entries.add(entryJson)\n\n\n        }\n\n        /**\n         * Adds the given tag to the FHIR resource.  If the meta or tag fields do not exist, they will be created.\n         * @param fhirResource\n         * @param fhirResourceTag\n         * @return\n         */\n        private Map addTagToResource(Map fhirResource, String fhirResourceTag) {\n            if (fhirResourceTag) {\n                String CODE_SYSTEM=\"http://ibm.com/fhir/cdm/StructureDefinition/ingestion-batch-id\"\n\n                def fhirTag=[system:CODE_SYSTEM,code:fhirResourceTag]\n\n                // create 'meta' element if is doesn't exist\n                // NOTE: this appends property 'meta' to end of list. (least expensive option)\n                fhirResource.putIfAbsent(\"meta\", [:] )\n\n                // Create empty tag array if it doesn't exist.\n                Map metaMap = fhirResource.getAt(\"meta\")\n                metaMap.putIfAbsent(\"tag\", [] )\n\n                ArrayList tagArray = metaMap.get(\"tag\")\n\n                // search for an existing entry with same CODE_SYSTEM\n                def existingEntry = tagArray.find { tagArrayEntry -> tagArrayEntry.getAt(\"system\") == CODE_SYSTEM }\n                if ( ! existingEntry ) {\n                    // NOT FOUND - add a new entry to tagArray\n                    tagArray.add(fhirTag)\n                } else {\n                    // There was an array entry for our code system - set value\n                    existingEntry.putAt(\"code\", fhirResourceTag)\n                }\n\n            }\n\n            return fhirResource\n        }\n    }\n\n    /**\n     * Generates the flowfile contents from the ProcessInputFlowFile object\n     */\n    public class BundleWriterCallback extends StreamCallback {\n        private ProcessInputFlowFile flowfilesData = null;\n\n        public BundleWriterCallback(ProcessInputFlowFile flowfilesData) {\n            super()\n            this.flowfilesData = flowfilesData\n        }\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            def jsonSlurper = new JsonSlurper()\n\n            Map output = generateContent()\n\n            outstream.write(JsonOutput.toJson(output).getBytes(StandardCharsets.UTF_8))\n        }\n\n\n        /**\n         * Generates the flowfile content which has a section for flowfile attributes and FHIR resource bundle\n         * @return Map\n         */\n        public Map generateContent() {\n            Map flowfileContent = [\"flowfileAttributes\" : this.flowfilesData.getEntryAttributes()]\n            Map bundle = [\"resourceType\" : \"Bundle\"]\n            bundle.putAt(\"id\", UUID.randomUUID().toString())\n            bundle.putAt(\"type\", \"transaction\")\n            bundle.putAt(\"entry\", this.flowfilesData.getEntries())\n            flowfileContent.putAt(\"bundle\", bundle)\n            return flowfileContent\n        }\n\n    }\n\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        ArrayList<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n\n        if (!flowFiles)\n            return\n\n        // Need to group out the flowfiles based on the grouping criteria and maximum bundle entries.\n        Map<String, List<List<FlowFile>>> flowFileBundles = new HashMap<>()\n\n        for (FlowFile aFlowFile : flowFiles) {\n            // Get the grouping criteria\n            String criteriaString = context.getProperty(PROP_BUNDLE_GROUP_KEY).evaluateAttributeExpressions(aFlowFile).getValue()\n            if (criteriaString == null)\n                criteriaString = \"\"\n\n            List<List<FlowFile>> criteriaGroup = flowFileBundles.getAt(criteriaString)\n            if (criteriaGroup == null) {\n                criteriaGroup = new ArrayList<>()\n                flowFileBundles.putAt(criteriaString, criteriaGroup)\n            }\n\n            // Populate the first size group if none are there\n            if (criteriaGroup.size() == 0) {\n                criteriaGroup.add(new ArrayList<>())\n            }\n\n            // Get the last size group\n            List<FlowFile> sizeGroup = criteriaGroup.getAt(criteriaGroup.size() - 1)\n\n            // Get the Max number of flowfiles to add to the bundle\n            String maxNumberOfResourcesString = context.getProperty(PROP_MAX_BUNDLE_ENTRIES).evaluateAttributeExpressions(aFlowFile).getValue()\n            Integer maxNumberOfFlowFiles = maxNumberOfResourcesString.toInteger()\n\n            // If the size group is already too big, start a new list\n            if (sizeGroup.size() >= maxNumberOfFlowFiles) {\n                sizeGroup = new ArrayList<>()\n                criteriaGroup.add(sizeGroup)\n            }\n\n            sizeGroup.add(aFlowFile)\n        }\n\n        // Start processing the flowfiles for each bundle\n        Set<String> setOfAttributesToRemove = [\"invokehttp.status.code\", \"invokehttp.status.message\"]\n        Set<String> setOfAttributesToIgnore = [\"uuid\", \"filename\", \"path\"]\n        setOfAttributesToIgnore.addAll(setOfAttributesToRemove)\n        \n\n        for (List<List<FlowFile>> groupedFlowFiles : flowFileBundles.values()) {\n            for (List<FlowFile> aNewFlowFileBundle : groupedFlowFiles) {\n                FlowFile outputFlowFile = null\n                try {\n                    // Create the output flowfile from the input flowfiles\n                    outputFlowFile = session.create(aNewFlowFileBundle)\n                    \n                    outputFlowFile = session.removeAllAttributes(outputFlowFile, setOfAttributesToRemove)\n                    \n                    ProcessInputFlowFile inputProcessor = new ProcessInputFlowFile(setOfAttributesToIgnore)\n\n                    for (FlowFile aFlowFile: aNewFlowFileBundle) {\n                        // process the flowfile\n                        inputProcessor.setFlowFile(aFlowFile)\n                        session.read(aFlowFile, inputProcessor)\n                    }\n\n                    outputFlowFile = session.write(outputFlowFile, new BundleWriterCallback(inputProcessor))\n\n                    // Remove all input flowfiles\n                    session.remove(aNewFlowFileBundle)\n                    \n                    // Add attributes needed for copy later in flow\n                    outputFlowFile = session.putAllAttributes(outputFlowFile, [\"copyId\": UUID.randomUUID().toString(), \n                                                                               \"segment.original.filename\": outputFlowFile.getAttribute(\"filename\")])\n                    \n                    session.transfer(outputFlowFile, REL_SUCCESS)\n\n                } catch (Exception e) {\n                    getLogger().error('Exception during auto building bundle', e)\n                    for (FlowFile aFlowFile: aNewFlowFileBundle)\n                        session.transfer(aFlowFile, REL_FAILURE)\n                    \n                    // If the output flowfile was created, remove it.    \n                    if (outputFlowFile != null)\n                        session.remove(outputFlowFile)\n                }\n            }\n        }\n    }\n\n}\n\nprocessor = new BuildNewBundleFromResources()\n",
                  "Number of flowfiles to pull" : "100",
                  "Bundle Group Key" : "${kafka.topic}"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Maximum resources in bundle" : {
                    "displayName" : "Maximum resources in bundle",
                    "identifiesControllerService" : false,
                    "name" : "Maximum resources in bundle",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Number of flowfiles to pull" : {
                    "displayName" : "Number of flowfiles to pull",
                    "identifiesControllerService" : false,
                    "name" : "Number of flowfiles to pull",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  },
                  "Bundle Group Key" : {
                    "displayName" : "Bundle Group Key",
                    "identifiesControllerService" : false,
                    "name" : "Bundle Group Key",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "d3a7b004-bceb-363f-8105-60dc4319f4dc",
                "name" : "Log Error Creating Bundle Payload",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 3392.0,
                  "y" : 1520.0
                },
                "properties" : {
                  "log-message" : "Error setting Resource Bundle in FHIR Payload",
                  "log-level" : "error",
                  "log-prefix" : "Interop FHIR Adapter - "
                },
                "propertyDescriptors" : {
                  "log-message" : {
                    "displayName" : "Log message",
                    "identifiesControllerService" : false,
                    "name" : "log-message",
                    "sensitive" : false
                  },
                  "log-level" : {
                    "displayName" : "Log Level",
                    "identifiesControllerService" : false,
                    "name" : "log-level",
                    "sensitive" : false
                  },
                  "log-prefix" : {
                    "displayName" : "Log prefix",
                    "identifiesControllerService" : false,
                    "name" : "log-prefix",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.LogMessage",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "ef45cc66-3683-37c2-83e4-244580d7887f",
                "name" : "Set content to FHIR payload",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 2736.0,
                  "y" : 1520.0
                },
                "properties" : {
                  "Destination" : "flowfile-content",
                  "Return Type" : "auto-detect",
                  "Null Value Representation" : "empty string",
                  "completedNotification" : "$.bundle",
                  "Path Not Found Behavior" : "warn"
                },
                "propertyDescriptors" : {
                  "Destination" : {
                    "displayName" : "Destination",
                    "identifiesControllerService" : false,
                    "name" : "Destination",
                    "sensitive" : false
                  },
                  "Return Type" : {
                    "displayName" : "Return Type",
                    "identifiesControllerService" : false,
                    "name" : "Return Type",
                    "sensitive" : false
                  },
                  "Null Value Representation" : {
                    "displayName" : "Null Value Representation",
                    "identifiesControllerService" : false,
                    "name" : "Null Value Representation",
                    "sensitive" : false
                  },
                  "completedNotification" : {
                    "displayName" : "completedNotification",
                    "identifiesControllerService" : false,
                    "name" : "completedNotification",
                    "sensitive" : false
                  },
                  "Path Not Found Behavior" : {
                    "displayName" : "Path Not Found Behavior",
                    "identifiesControllerService" : false,
                    "name" : "Path Not Found Behavior",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "Duplicates the flow file so that each duplicate (and the original) can become a flow file for a generated and unique FHIR resource.",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "176be395-1553-3964-8329-0edf4fa000c2",
                "name" : "split flow file for FHIR Server",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 1216.0
                },
                "properties" : {
                  "Number of Copies" : "1"
                },
                "propertyDescriptors" : {
                  "Number of Copies" : {
                    "displayName" : "Number of Copies",
                    "identifiesControllerService" : false,
                    "name" : "Number of Copies",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.DuplicateFlowFile",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "NONE",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "a055dffe-ed1d-3ee3-8e0e-cf044100eb54",
                "name" : "Handle Merge Failure",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 2480.0,
                  "y" : 2976.0
                },
                "properties" : {
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.io.IOUtils\n\n/**\n * For \"Handle Merge Failure\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Auto Build Bundle\"\n *\n * Logs an error that Merging failed for autobudling.\n * Removes the copy flowfile from the flow.  \n * Logs an error if copy.index is not set\n * Sets the autoBundleFailed attribute to true.\n */\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles != null) {\n    for (FlowFile flowFile : flowFiles) {\n        log.error(\"Interop FHIR Adapter - Error merging FHIR response with autobuilt bundle.  UUID: {}\", [flowFile.getAttribute(\"uuid\")] as Object[])\n        String copyIndex = flowFile.getAttribute( \"copy.index\")\n        flowFile = session.putAttribute(flowFile, \"autoBundleFailed\", \"true\" )\n        \n        if (copyIndex) {\n            if (copyIndex.equals(\"0\")) {\n                session.transfer(flowFile, REL_SUCCESS)\n                \n            } else if (copyIndex.equals(\"1\")) {\n                session.remove(flowFile)\n            } else {\n                log.error(\"Interop FHIR Adapter - Copy index set to unexpected number {} while attempting to filter out FHIR generated bundle package.  UUID: {}\", [copyIndex, flowFile.getAttribute(\"uuid\")] as Object[])\n                session.transfer(flowFile, REL_FAILURE)\n            }\n        } else {\n            log.error(\"Interop FHIR Adapter - Copy index not found while attempting to filter out FHIR generated bundle package.  UUID: {}\", [flowFile.getAttribute(\"uuid\")] as Object[])\n            session.transfer(flowFile, REL_FAILURE)\n\n        }\n    }\n}\n\n"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.ExecuteScript",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "63082db0-65d8-311c-806e-b901739f6494",
                "name" : "Set failed flag",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 3392.0,
                  "y" : 1824.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "autoBundleFailed" : "true"
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "autoBundleFailed" : {
                    "displayName" : "autoBundleFailed",
                    "identifiesControllerService" : false,
                    "name" : "autoBundleFailed",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ "unmatched" ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-standard-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "Determines the type of FHIR resource to create.\n\nThe logic here looks at the modulus of 'copy.index', which was set by the preceding duplicate flow file processor.  Each type of flow file will be generated in equal amounts.",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "51308e33-232b-32b8-b9d6-07dd0b71bd35",
                "name" : "Route to Send to FHIR",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 1872.0,
                  "y" : 1520.0
                },
                "properties" : {
                  "Routing Strategy" : "Route to Property name",
                  "original" : "${copy.index:equals(0)}",
                  "copy" : "${copy.index:equals(1)}"
                },
                "propertyDescriptors" : {
                  "Routing Strategy" : {
                    "displayName" : "Routing Strategy",
                    "identifiesControllerService" : false,
                    "name" : "Routing Strategy",
                    "sensitive" : false
                  },
                  "original" : {
                    "displayName" : "original",
                    "identifiesControllerService" : false,
                    "name" : "original",
                    "sensitive" : false
                  },
                  "copy" : {
                    "displayName" : "copy",
                    "identifiesControllerService" : false,
                    "name" : "copy",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-update-attribute-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "MergeContent expected a 'fragement.count' property to determine the order that files are merged. The value for this is already in a 'copy.index' property. This update does a copy to the new name.",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "b2b32995-f797-339f-9232-59061d627f94",
                "name" : "Setup FHIR flowfile for Merge",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 2736.0,
                  "y" : 2080.0
                },
                "properties" : {
                  "Store State" : "Do not store state",
                  "canonical-value-lookup-cache-size" : "100",
                  "fragment.identifier" : "${copyId}",
                  "fragment.index" : "${copy.index}",
                  "fragment.count" : "2",
                  "priority" : "1"
                },
                "propertyDescriptors" : {
                  "Delete Attributes Expression" : {
                    "displayName" : "Delete Attributes Expression",
                    "identifiesControllerService" : false,
                    "name" : "Delete Attributes Expression",
                    "sensitive" : false
                  },
                  "Store State" : {
                    "displayName" : "Store State",
                    "identifiesControllerService" : false,
                    "name" : "Store State",
                    "sensitive" : false
                  },
                  "canonical-value-lookup-cache-size" : {
                    "displayName" : "Cache Value Lookup Cache Size",
                    "identifiesControllerService" : false,
                    "name" : "canonical-value-lookup-cache-size",
                    "sensitive" : false
                  },
                  "fragment.identifier" : {
                    "displayName" : "fragment.identifier",
                    "identifiesControllerService" : false,
                    "name" : "fragment.identifier",
                    "sensitive" : false
                  },
                  "fragment.index" : {
                    "displayName" : "fragment.index",
                    "identifiesControllerService" : false,
                    "name" : "fragment.index",
                    "sensitive" : false
                  },
                  "fragment.count" : {
                    "displayName" : "fragment.count",
                    "identifiesControllerService" : false,
                    "name" : "fragment.count",
                    "sensitive" : false
                  },
                  "Stateful Variables Initial Value" : {
                    "displayName" : "Stateful Variables Initial Value",
                    "identifiesControllerService" : false,
                    "name" : "Stateful Variables Initial Value",
                    "sensitive" : false
                  },
                  "priority" : {
                    "displayName" : "priority",
                    "identifiesControllerService" : false,
                    "name" : "priority",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
                "yieldDuration" : "1 sec"
              }, {
                "autoTerminatedRelationships" : [ ],
                "bulletinLevel" : "WARN",
                "bundle" : {
                  "artifact" : "nifi-scripting-nar",
                  "group" : "org.apache.nifi",
                  "version" : "1.12.1"
                },
                "comments" : "",
                "componentType" : "PROCESSOR",
                "concurrentlySchedulableTaskCount" : 1,
                "executionNode" : "ALL",
                "groupIdentifier" : "9c8dfea1-f1bc-308e-af25-6f6be2d8f33c",
                "identifier" : "65a13bb4-f514-3863-ac24-a934c56b16d7",
                "name" : "Check Merge Failure Flag",
                "penaltyDuration" : "30 sec",
                "position" : {
                  "x" : 2736.0,
                  "y" : 2336.0
                },
                "properties" : {
                  "Cache Entry Identifier" : "FailedMerge_${tenant}_${messageBatchId}_${copyId}",
                  "Script Engine" : "Groovy",
                  "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport java.nio.charset.StandardCharsets\nimport org.apache.commons.lang3.StringUtils\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.distributed.cache.client.DistributedMapCacheClient\nimport org.apache.nifi.distributed.cache.client.Serializer\nimport org.apache.nifi.distributed.cache.client.exception.SerializationException\nimport org.apache.nifi.expression.AttributeExpression\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.logging.ComponentLog\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.util.StandardValidators\n\n/**\n * For \"Check Merge Failure Flag\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" >> \"Auto Build Bundle\"\n *\n * If the FailedMerge_<tenantId>_<messageBatchId>_<copyId> entry is in the DistributedCacheMap, remove the flag and flowfile. \n * Otherwise, send to success\n */\nclass CheckFailedMergeFlag extends AbstractProcessor {\n\n    public static final PropertyDescriptor PROP_DISTRIBUTED_CACHE_SERVICE = new PropertyDescriptor.Builder()\n        .name(\"Distributed Cache Service\")\n        .description(\"The Controller Service that is used to get the cached value.\")\n        .required(true)\n        .identifiesControllerService(DistributedMapCacheClient.class)\n        .build()\n\n    public static final PropertyDescriptor PROP_CACHE_ENTRY_IDENTIFIER = new PropertyDescriptor.Builder()\n        .name(\"Cache Entry Identifier\")\n        .description(\"A FlowFile attribute, or the results of an Attribute Expression Language statement, which will be evaluated \" +\n        \"against a FlowFile in order to determine the value used to identify duplicates; it is this value that is cached\")\n        .required(true)\n        .addValidator(StandardValidators.createAttributeExpressionLanguageValidator(AttributeExpression.ResultType.STRING, true))\n        .defaultValue('FailedMerge_${tenant}_${messageBatchId}_${copyId}')\n        .expressionLanguageSupported(ExpressionLanguageScope.FLOWFILE_ATTRIBUTES)\n        .build()\n\n    public static final Relationship REL_SUCCESS = new Relationship.Builder()\n        .name(\"success\")\n        .description(\"If the cache was successfully communicated with it will be routed to this relationship\")\n        .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n        .name(\"failure\")\n        .description(\"If unable to communicate with the cache or if the cache entry is evaluated to be blank, the FlowFile will be penalized and routed to this relationship\")\n        .build()\n\n    private final Set<Relationship> relationships\n\n    private final Serializer<String> keySerializer = new Serializer<String>() {\n        @Override\n        void serialize(String value, OutputStream output) throws SerializationException, IOException {\n            output.write(value.getBytes(StandardCharsets.UTF_8))\n        }\n    }\n\n    CheckFailedMergeFlag() {\n        final Set<Relationship> rels = new HashSet<>()\n        rels.add(REL_SUCCESS)\n        rels.add(REL_FAILURE)\n        relationships = Collections.unmodifiableSet(rels)\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_CACHE_ENTRY_IDENTIFIER)\n        descriptors.add(PROP_DISTRIBUTED_CACHE_SERVICE)\n        return descriptors\n    }\n\n    @Override\n    Set<Relationship> getRelationships() {\n        return relationships\n    }\n\n    @Override\n    void onTrigger(final ProcessContext context, final ProcessSession session) throws ProcessException {\n        ComponentLog logger = getLogger()\n        DistributedMapCacheClient cache = context.getProperty(PROP_DISTRIBUTED_CACHE_SERVICE).asControllerService(DistributedMapCacheClient.class)\n\n        List<FlowFile> flowFiles = session.get(100)\n        if (flowFiles != null) {\n            for (FlowFile flowFile : flowFiles) {\n\n                String cacheKey = context.getProperty(PROP_CACHE_ENTRY_IDENTIFIER).evaluateAttributeExpressions(flowFile).getValue()\n                if (StringUtils.isBlank(cacheKey)) {\n                    logger.error(\"FlowFile with UUID {} has no attribute for given Cache Entry Identifier\", [flowFile.getAttribute(\"uuid\")])\n                    session.transfer(flowFile, REL_FAILURE)\n                    continue\n                }\n                \n                try {\n                    if(cache.remove(cacheKey, keySerializer)) {\n                        // Key is found, remove the flowfile\n                        String copyId = flowFile.getAttribute( \"copyId\")\n                        logger.info(\"Interop FHIR Adapter - Removing autobundle FHIR flowfile with copyID of {} since flag for failed autobundle merge was set\", copyId)\n                        session.remove(flowFile)\n                    } else {\n                        // Key is not found, send to to success\n                        session.transfer(flowFile, REL_SUCCESS)\n                    }\n                } catch (IOException e) {\n                    session.transfer(flowFile, REL_FAILURE)\n                    logger.error(\"Interop FHIR Adapter - Execption checking autobundle merge failure flag in DistributedCacheMap\", e)\n                }\n            }\n        }\n    }\n}\n\nprocessor = new CheckFailedMergeFlag()\n",
                  "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473"
                },
                "propertyDescriptors" : {
                  "Script File" : {
                    "displayName" : "Script File",
                    "identifiesControllerService" : false,
                    "name" : "Script File",
                    "sensitive" : false
                  },
                  "Cache Entry Identifier" : {
                    "displayName" : "Cache Entry Identifier",
                    "identifiesControllerService" : false,
                    "name" : "Cache Entry Identifier",
                    "sensitive" : false
                  },
                  "Script Engine" : {
                    "displayName" : "Script Engine",
                    "identifiesControllerService" : false,
                    "name" : "Script Engine",
                    "sensitive" : false
                  },
                  "Script Body" : {
                    "displayName" : "Script Body",
                    "identifiesControllerService" : false,
                    "name" : "Script Body",
                    "sensitive" : false
                  },
                  "Distributed Cache Service" : {
                    "displayName" : "Distributed Cache Service",
                    "identifiesControllerService" : true,
                    "name" : "Distributed Cache Service",
                    "sensitive" : false
                  },
                  "Module Directory" : {
                    "displayName" : "Module Directory",
                    "identifiesControllerService" : false,
                    "name" : "Module Directory",
                    "sensitive" : false
                  }
                },
                "runDurationMillis" : 0,
                "scheduledState" : "ENABLED",
                "schedulingPeriod" : "0 sec",
                "schedulingStrategy" : "TIMER_DRIVEN",
                "style" : { },
                "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
                "yieldDuration" : "1 sec"
              } ],
              "remoteProcessGroups" : [ ],
              "variables" : { }
            } ],
            "processors" : [ {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "WARN",
              "bundle" : {
                "artifact" : "nifi-update-attribute-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "83d6b644-6f5a-3f4e-beff-5abba4943797",
              "name" : "Turn Off AutoBundle",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 1352.0,
                "y" : -256.0
              },
              "properties" : {
                "autoBuildBundles" : "False",
                "Store State" : "Do not store state",
                "canonical-value-lookup-cache-size" : "100"
              },
              "propertyDescriptors" : {
                "Delete Attributes Expression" : {
                  "displayName" : "Delete Attributes Expression",
                  "identifiesControllerService" : false,
                  "name" : "Delete Attributes Expression",
                  "sensitive" : false
                },
                "autoBuildBundles" : {
                  "displayName" : "autoBuildBundles",
                  "identifiesControllerService" : false,
                  "name" : "autoBuildBundles",
                  "sensitive" : false
                },
                "Store State" : {
                  "displayName" : "Store State",
                  "identifiesControllerService" : false,
                  "name" : "Store State",
                  "sensitive" : false
                },
                "canonical-value-lookup-cache-size" : {
                  "displayName" : "Cache Value Lookup Cache Size",
                  "identifiesControllerService" : false,
                  "name" : "canonical-value-lookup-cache-size",
                  "sensitive" : false
                },
                "Stateful Variables Initial Value" : {
                  "displayName" : "Stateful Variables Initial Value",
                  "identifiesControllerService" : false,
                  "name" : "Stateful Variables Initial Value",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ ],
              "bulletinLevel" : "NONE",
              "bundle" : {
                "artifact" : "nifi-scripting-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 1,
              "executionNode" : "ALL",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "f163d4e9-3724-341a-9613-7cc565a21b25",
              "name" : "Pre-Process FHIR Resource",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 2064.0,
                "y" : -264.0
              },
              "properties" : {
                "Script Engine" : "Groovy",
                "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.lang3.StringUtils\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.components.PropertyDescriptor\nimport org.apache.nifi.expression.ExpressionLanguageScope\nimport org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.AbstractProcessor\nimport org.apache.nifi.processor.exception.ProcessException\nimport org.apache.nifi.processor.ProcessContext\nimport org.apache.nifi.processor.ProcessSession\nimport org.apache.nifi.processor.Relationship\nimport org.apache.nifi.processor.util.StandardValidators\nimport org.apache.nifi.processor.io.InputStreamCallback\nimport org.apache.nifi.processor.io.StreamCallback\nimport groovy.json.JsonSlurper\n\n\n/**\n * For  \"Pre-Process FHIR Resource\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\" \n *  1. Retrieves the resource id and type from the json in the content\n *  2. Ensures ResourceType and Resource ID attributes are set. If bundle id is not set, will generate a new id.\n *  3. Will send to bundle relationship if it is a bundle resource type\n *  4. Will send to FHIR resource relationship if it is not a bundle and autobundle is disabled. ${autoBuildBundles:notNull():and(${autoBuildBundles:toLower():equals(\"yes\"):or(${autoBuildBundles:toLower():equals(\"true\")})})}\n *  5. Will send to Auto Bundle relationship if it is not a bundle and autobundle is enabled.\n *  6. Will send to failure relationship if content has invalid json with:\n *      invokehttp.status.code = 400\n *      invokehttp.status.message = \"Invalid JSON\"\n *      hri.ingest.record.progress = ERROR\n *      resourceSavedStatus = failure\n *      Log error: Interop FHIR Adapter - Invalid JSON: UUID: {} \n *      Content is cleared\n *  7. Will send to failure relationship if resource id or resource type id is not set.  Similar updates as #8 except the log error message will be:\n *      Log error: Interop FHIR Adapter - resourceId or resourceType is not set: ResourceType: {}, ResourceId: {}, UUID: {} \n *  \n * \n */\nclass PreprocessFHIRResource extends AbstractProcessor {\n    \n    public static final PropertyDescriptor PROP_NUMBER_FLOWFILES_TO_PULL = new PropertyDescriptor.Builder()\n    .name(\"Number of flowfiles to pull\")\n    .description(\"The number of flowfiles this process will pull from the queue at one time\")\n    .required(true)\n    .addValidator(StandardValidators.POSITIVE_INTEGER_VALIDATOR)\n    .defaultValue(\"100\")\n    .expressionLanguageSupported(ExpressionLanguageScope.NONE)\n    .build()\n\n    public static final Relationship REL_BUNDLE = new Relationship.Builder()\n    .name(\"bundle\")\n    .description(\"Flowfile should be processed as a FHIR bundle\")\n    .build()\n\n    public static final Relationship REL_FHIR = new Relationship.Builder()\n    .name(\"FHIR resource\")\n    .description(\"Flowfile should be processed as a single FHIR resource, non-bundle\")\n    .build()\n\n    public static final Relationship REL_AUTO_BUNDLE = new Relationship.Builder()\n    .name(\"auto bundle\")\n    .description(\"Flowfile should be processed with auto-bundling\")\n    .build()\n\n    public static final Relationship REL_FAILURE = new Relationship.Builder()\n    .name(\"failure\")\n    .description(\"If the resource was not able to be updated, the FlowFile will be penalized and routed to this relationship\")\n    .build()\n\n    @Override\n    Set<Relationship> getRelationships() {\n        [REL_BUNDLE, REL_FHIR, REL_AUTO_BUNDLE, REL_FAILURE] as Set\n    }\n\n    @Override\n    List<PropertyDescriptor> getSupportedPropertyDescriptors() {\n        final List<PropertyDescriptor> descriptors = new ArrayList<>()\n        descriptors.add(PROP_NUMBER_FLOWFILES_TO_PULL)\n        return descriptors\n    }\n\n    /**\n     * Reads the content expecting JSON\n     */\n    class ContentJsonReader extends InputStreamCallback {\n        def contentJson = null;\n        \n        public ContentJsonReader() {\n            super()\n        }\n        \n        public def getContentJson() {\n            return this.contentJson\n        }\n        \n        @Override\n        void process(InputStream instream) throws IOException {\n            def jsonSlurper = new JsonSlurper()\n            this.contentJson = jsonSlurper.parse(instream, \"UTF-8\")\n        }\n    \n    }\n    \n    \n    /**\n     * Clears the flowfile content\n     */\n    public class ClearFlowFileContents extends StreamCallback {\n\n        public ClearFlowFileContents() {\n            super();\n        }\n\n\n        @Override\n        void process(InputStream instream, OutputStream outstream) throws IOException {\n            outstream.write(\"\".getBytes(StandardCharsets.UTF_8))\n        }\n\n    }\n\n    @Override\n    public void onTrigger(ProcessContext context, ProcessSession session) throws ProcessException {\n        String numberOfFlowFilesToPull = context.getProperty(PROP_NUMBER_FLOWFILES_TO_PULL)\n        if (StringUtils.isBlank(numberOfFlowFilesToPull)) {\n            getLogger().error(\"Was unable to determine number of flowfiles to pull in processor configuration\")\n            return\n        }\n\n        int numberOfFlowfilesToPull = numberOfFlowFilesToPull.toInteger()\n\n        List<FlowFile> flowFiles = session.get(numberOfFlowfilesToPull)\n        if (flowFiles == null) {\n            return\n        }\n\n        for (FlowFile aFlowFile : flowFiles) {\n            boolean error = false;\n\n            // Clear out any stale resourceId or types from the flowfile\n            aFlowFile = session.removeAttribute(aFlowFile, \"resourceId\")\n            aFlowFile = session.removeAttribute(aFlowFile, \"resourceType\")\n            \n            String resourceId = null\n            String resourceType = null\n            \n            try {\n                // Get the resource id and type from \n                ContentJsonReader reader = new ContentJsonReader()\n                session.read(aFlowFile, reader)\n                if (!reader.getContentJson() instanceof Map) {\n                    error = true\n                } else {\n                    Map resource = reader.getContentJson()\n                    resourceId = resource.getAt(\"id\")\n                    resourceType = resource.getAt(\"resourceType\")\n                }\n                 \n            } catch (Exception e) {\n                error = true\n            }\n\n            // Check if there was a problem with the json processing, otherwise set the attributes\n            if (error) {\n                getLogger().warn('Interop FHIR Adapter - Invalid JSON: UUID: {}', [aFlowFile.getAttribute(\"uuid\")] as Object[])\n                aFlowFile = session.putAllAttributes(aFlowFile, [\"invokehttp.status.code\": \"400\", \"invokehttp.status.message\": \"Invalid JSON\"])\n            } else {\n                // Error if resourceType or Id is not set\n                if (!resourceType || !resourceId) {\n                    // If it is an incoming bundle without an id, generate a new one.  Hotfix\n                    if (resourceType && resourceType.equals(\"Bundle\") && !resourceId) {\n                        resourceId = UUID.randomUUID().toString()\n                        getLogger().info('Interop FHIR Adapter - Incoming bundle resource did not have id set.  Set to {}. UUID: {}', [resourceId, aFlowFile.getAttribute(\"uuid\")] as Object[])\n                    } else {\n                        error = true\n                        getLogger().warn('Interop FHIR Adapter - resourceId or resourceType is not set: ResourceType: {}, ResourceId: {}, UUID: {}', [resourceType, resourceId, aFlowFile.getAttribute(\"uuid\")] as Object[])\n                        aFlowFile = session.putAllAttributes(aFlowFile, [\"invokehttp.status.code\": \"400\", \"invokehttp.status.message\": \"Resource id or type not set\"])\n                    }\n               } \n               \n               // Set the resourceType and id attributes\n               if (resourceId)\n                    aFlowFile = session.putAttribute(aFlowFile, \"resourceId\", resourceId)\n                    \n               if (resourceType)\n                    aFlowFile = session.putAttribute(aFlowFile, \"resourceType\", resourceType)\n            }\n\n            // If error, clear the flowfile contents and send flowfile to failure relationship\n            if (error) {\n                try {\n                    ClearFlowFileContents writer = new ClearFlowFileContents();\n                    aFlowFile = session.write(aFlowFile, writer)\n                    aFlowFile = session.putAllAttributes(aFlowFile, [\"Content-Type\": \"text/plain\", \"mime.type\": \"text/plain\", \"hri.ingest.record.progress\": \"ERROR\", \"resourceSavedStatus\": \"failure\"])\n                } catch (Exception e) {\n                    getLogger().error('Failed to clear flowfile with UUID: {}', [aFlowFile.getAttribute(\"uuid\")] as Object[], e)\n                }\n                \n                session.transfer(aFlowFile, REL_FAILURE)\n            } else {\n                // No problems with the input flowfile, now set to appropriate relationship\n                if (resourceType.equals(\"Bundle\")) {\n                    session.transfer(aFlowFile, REL_BUNDLE)\n                } else {\n                    String autoBuildBundles = aFlowFile.getAttribute(\"autoBuildBundles\")\n                    \n                    if (autoBuildBundles && (autoBuildBundles.equalsIgnoreCase(\"yes\") || autoBuildBundles.equalsIgnoreCase(\"true\"))) \n                        session.transfer(aFlowFile, REL_AUTO_BUNDLE)\n                    else\n                        session.transfer(aFlowFile, REL_FHIR)\n                }\n            }\n        }\n    }\n}\n\nprocessor = new PreprocessFHIRResource()\n\n",
                "Number of flowfiles to pull" : "100"
              },
              "propertyDescriptors" : {
                "Script File" : {
                  "displayName" : "Script File",
                  "identifiesControllerService" : false,
                  "name" : "Script File",
                  "sensitive" : false
                },
                "Script Engine" : {
                  "displayName" : "Script Engine",
                  "identifiesControllerService" : false,
                  "name" : "Script Engine",
                  "sensitive" : false
                },
                "Script Body" : {
                  "displayName" : "Script Body",
                  "identifiesControllerService" : false,
                  "name" : "Script Body",
                  "sensitive" : false
                },
                "Number of flowfiles to pull" : {
                  "displayName" : "Number of flowfiles to pull",
                  "identifiesControllerService" : false,
                  "name" : "Number of flowfiles to pull",
                  "sensitive" : false
                },
                "Module Directory" : {
                  "displayName" : "Module Directory",
                  "identifiesControllerService" : false,
                  "name" : "Module Directory",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.script.InvokeScriptedProcessor",
              "yieldDuration" : "1 sec"
            }, {
              "autoTerminatedRelationships" : [ "failure" ],
              "bulletinLevel" : "NONE",
              "bundle" : {
                "artifact" : "nifi-scripting-nar",
                "group" : "org.apache.nifi",
                "version" : "1.12.1"
              },
              "comments" : "Failure relationship not used in script",
              "componentType" : "PROCESSOR",
              "concurrentlySchedulableTaskCount" : 2,
              "executionNode" : "ALL",
              "groupIdentifier" : "1ac96b20-cb2a-330b-9fa5-d48182b6fc95",
              "identifier" : "36e3cec3-aaf2-3d50-968e-7e3204b62a26",
              "name" : "Handle Post FHIR Results",
              "penaltyDuration" : "30 sec",
              "position" : {
                "x" : 2064.0,
                "y" : 760.0
              },
              "properties" : {
                "Script Engine" : "Groovy",
                "Script Body" : "/*\n * IBM Confidential\n * OCO Source Materials\n *\n * (c) Copyright IBM Corp. 2021, 2021\n *\n * The source code for this program is not published or otherwise divested\n * of its trade secrets, irrespective of what has been deposited with the\n * U.S. Copyright Office.\n *\n */\n\nimport org.apache.commons.io.IOUtils\n\n/**\n * For \"HandlePostFHIRResults\" processor in \"Send to FHIR and Post Errors\" >> \"Save To FHIR\"\n *\n * Sets the invokehttp.status.message attribute to a default message for a code if the message is not set.\n * Sets the hri.ingest.record.progress attribute to SUCCESS, WARNING, or ERROR\n * Sets the resourceSavedStatus attribute to success, warning, or failure\n */\n\nstatusMessageAttributeName = \"invokehttp.status.message\"\nhriFileStatusAttrName = \"hri.ingest.record.progress\"\nsavedStatusAttrName = \"resourceSavedStatus\"\n\ncodeMap = [\n  '200': \"OK\",\n  '201': \"Created\",\n  '400': \"Bad Request\",\n  '401': \"Not Authorized\",\n  '404': \"Not Found\",\n  '409': \"Conflict\",\n  '422': \"Unprocessable Entity\"\n]\n\nclass ContentReader implements InputStreamCallback {\n    String content = null;\n    \n    public ContentReader() {\n        super()\n    }\n    \n    public String getContent() {\n        return this.content\n    }\n    \n    @Override\n    void process(InputStream instream) throws IOException {\n         this.content = IOUtils.toString(instream, \"UTF-8\")\n    }\n\n}\n\nList<FlowFile> flowFiles = session.get(100)\nif (flowFiles != null) {\n    for (FlowFile flowFile : flowFiles) {\n        // Set the HTTP message if it isn't set\n        String originalStatusMessage = flowFile.getAttribute( statusMessageAttributeName)\n        String httpStatusCode = flowFile.getAttribute(\"invokehttp.status.code\")\n        \n        if (!originalStatusMessage) {\n            String codeMessage = codeMap.get(httpStatusCode)\n            if ( codeMessage != null ) {\n                flowFile = session.putAttribute(flowFile, statusMessageAttributeName, codeMessage )\n            }\n        }\n\n        // Set the status to success or warning if code is 2xx\n        if (httpStatusCode && httpStatusCode.startsWith(\"2\") && httpStatusCode.length() == 3) {\n            // Check if content contains a warning\n            ContentReader reader = new ContentReader()\n            session.read(flowFile, reader)\n            if (reader.getContent() && reader.getContent().find(\"\\\"severity\\\"\\\\s*:\\\\s*\\\"warning\\\"\") != null) {\n                flowFile = session.putAttribute(flowFile, savedStatusAttrName, \"warning\")\n                flowFile = session.putAttribute(flowFile, hriFileStatusAttrName, \"WARNING\")\n            } else {\n                flowFile = session.putAttribute(flowFile, savedStatusAttrName, \"success\")\n                flowFile = session.putAttribute(flowFile, hriFileStatusAttrName, \"SUCCESS\")\n            }\n            \n        } else {\n            // Failure case\n            String resourceType = flowFile.getAttribute(\"resourceType\")\n            String resourceId = flowFile.getAttribute(\"resourceId\")\n            String uuid = flowFile.getAttribute(\"uuid\")\n            String statusMessage = flowFile.getAttribute( statusMessageAttributeName)\n            boolean hasOO = false\n            \n            // Log as a warning if 400, 422, or 404 and OO is in the content\n            if (httpStatusCode && httpStatusCode.equals(\"404\")) {\n                ContentReader reader = new ContentReader()\n                session.read(flowFile, reader)\n                if (reader.getContent() && reader.getContent().find(\"\\\"resourceType\\\"\\\\s*:\\\\s*\\\"OperationOutcome\\\"\") != null) {\n                    hasOO = true\n                }\n            }\n            \n            if (httpStatusCode && (httpStatusCode.equals(\"400\") ||  httpStatusCode.equals(\"422\") || hasOO)) {\n                log.warn('Interop FHIR Adapter - FHIR Storage Failed: ResourceType: \"{}\", ResourceId: \"{}\", UUID: \"{}\", \"{}\": \"{}\"', [resourceType,resourceId,uuid,httpStatusCode,statusMessage] as Object[])\n            } else {\n                log.error('Interop FHIR Adapter - FHIR Storage Failed: ResourceType: \"{}\", ResourceId: \"{}\", UUID: \"{}\", \"{}\": \"{}\"', [resourceType,resourceId,uuid,httpStatusCode,statusMessage] as Object[])\n            }\n            \n            flowFile = session.putAttribute(flowFile, savedStatusAttrName, \"failure\")\n            flowFile = session.putAttribute(flowFile, hriFileStatusAttrName, \"ERROR\")\n        }\n        session.transfer(flowFile, REL_SUCCESS)\n    }\n}\n\n"
              },
              "propertyDescriptors" : {
                "Script File" : {
                  "displayName" : "Script File",
                  "identifiesControllerService" : false,
                  "name" : "Script File",
                  "sensitive" : false
                },
                "Script Engine" : {
                  "displayName" : "Script Engine",
                  "identifiesControllerService" : false,
                  "name" : "Script Engine",
                  "sensitive" : false
                },
                "Script Body" : {
                  "displayName" : "Script Body",
                  "identifiesControllerService" : false,
                  "name" : "Script Body",
                  "sensitive" : false
                },
                "Module Directory" : {
                  "displayName" : "Module Directory",
                  "identifiesControllerService" : false,
                  "name" : "Module Directory",
                  "sensitive" : false
                }
              },
              "runDurationMillis" : 0,
              "scheduledState" : "ENABLED",
              "schedulingPeriod" : "0 sec",
              "schedulingStrategy" : "TIMER_DRIVEN",
              "style" : { },
              "type" : "org.apache.nifi.processors.script.ExecuteScript",
              "yieldDuration" : "1 sec"
            } ],
            "remoteProcessGroups" : [ ],
            "variables" : { }
          } ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "c53afa98-a466-3a72-acb0-73c9ea773a3f",
            "name" : "Set To Failed",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1880.0,
              "y" : 2248.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "hri.ingest.record.progress" : "ERROR",
              "resourceSavedStatus" : "failure"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "hri.ingest.record.progress" : {
                "displayName" : "hri.ingest.record.progress",
                "identifiesControllerService" : false,
                "name" : "hri.ingest.record.progress",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "resourceSavedStatus" : {
                "displayName" : "resourceSavedStatus",
                "identifiesControllerService" : false,
                "name" : "resourceSavedStatus",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "a1c483f2-3a06-3f5a-9049-4d23e9afd539",
            "name" : "Set To Aborted",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 416.0,
              "y" : 2256.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "hri.ingest.record.progress" : "ABORT",
              "resourceSavedStatus" : "aborted"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "hri.ingest.record.progress" : {
                "displayName" : "hri.ingest.record.progress",
                "identifiesControllerService" : false,
                "name" : "hri.ingest.record.progress",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "resourceSavedStatus" : {
                "displayName" : "resourceSavedStatus",
                "identifiesControllerService" : false,
                "name" : "resourceSavedStatus",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "a540cf51-0e1b-386a-b1c6-1a5a765b66fa",
            "name" : "Set To Aborted",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 688.0,
              "y" : 1520.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "hri.ingest.record.progress" : "ABORT",
              "resourceSavedStatus" : "aborted"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "hri.ingest.record.progress" : {
                "displayName" : "hri.ingest.record.progress",
                "identifiesControllerService" : false,
                "name" : "hri.ingest.record.progress",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "resourceSavedStatus" : {
                "displayName" : "resourceSavedStatus",
                "identifiesControllerService" : false,
                "name" : "resourceSavedStatus",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 4,
            "executionNode" : "ALL",
            "groupIdentifier" : "7146e8e0-a942-337f-9251-2b0c00e548bd",
            "identifier" : "1a436a0f-0515-3701-944b-18a90ba44180",
            "name" : "Check For Abort",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1264.0,
              "y" : 968.0
            },
            "properties" : {
              "Cache Entry Identifier" : "abort-${sourceBatchId}",
              "Put Cache Value In Attribute" : "abortedReason",
              "Distributed Cache Service" : "c9ce338e-9976-376b-a24d-4bb8acad6473",
              "Max Length To Put In Attribute" : "256",
              "Character Set" : "UTF-8"
            },
            "propertyDescriptors" : {
              "Cache Entry Identifier" : {
                "displayName" : "Cache Entry Identifier",
                "identifiesControllerService" : false,
                "name" : "Cache Entry Identifier",
                "sensitive" : false
              },
              "Put Cache Value In Attribute" : {
                "displayName" : "Put Cache Value In Attribute",
                "identifiesControllerService" : false,
                "name" : "Put Cache Value In Attribute",
                "sensitive" : false
              },
              "Distributed Cache Service" : {
                "displayName" : "Distributed Cache Service",
                "identifiesControllerService" : true,
                "name" : "Distributed Cache Service",
                "sensitive" : false
              },
              "Max Length To Put In Attribute" : {
                "displayName" : "Max Length To Put In Attribute",
                "identifiesControllerService" : false,
                "name" : "Max Length To Put In Attribute",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.FetchDistributedMapCache",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "40232414-9e39-3ff3-96ac-b88d567ddca4",
              "name" : "Post to Kafka",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "5d60c98c-8694-3643-81ea-322fe00a15ab",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success", "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "0b8deabf-021b-3136-835e-7679462b0ba5",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "0b8deabf-021b-3136-835e-7679462b0ba5",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "e9eb43f0-314f-3aea-bb8d-1c816d5acde2",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "21aaa78b-95f5-3797-92be-c581087cfe72",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "62c3438b-4756-3ea6-a3b6-6d69619fb513",
              "name" : "AttributesToJSON",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "283eea3b-d8a3-38ed-974d-dfd043020ad2",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
              "name" : "Log and Post",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "21aaa78b-95f5-3797-92be-c581087cfe72",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "cdd54001-3d37-3460-8eff-27dd51016c2c",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success", "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "62c3438b-4756-3ea6-a3b6-6d69619fb513",
              "name" : "AttributesToJSON",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "759a2102-9d8f-3e34-b408-833a28a14e9c",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "149c5c38-a7b6-3355-86c7-5c37efcf6002",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success", "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "29d24ce1-1c00-3817-995c-450ddff3567b",
              "id" : "40232414-9e39-3ff3-96ac-b88d567ddca4",
              "name" : "Post to Kafka",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "45e0de23-88aa-3bea-8a39-7f6946a7b729",
            "name" : "Log and Post",
            "position" : {
              "x" : 1432.0,
              "y" : 1832.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "name" : "Log and Post Failure",
          "outputPorts" : [ ],
          "parameterContextName" : "cms_adapter_parameters",
          "position" : {
            "x" : 3048.0,
            "y" : 2792.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "0b8deabf-021b-3136-835e-7679462b0ba5",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1376.0,
              "y" : 2464.0
            },
            "properties" : {
              "Regular Expression" : "(?s)(^.*$)",
              "Replacement Value" : "\n\nFailure details via attributes: ${JSONAttributes}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Append"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success", "failure" ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "759a2102-9d8f-3e34-b408-833a28a14e9c",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1376.0,
              "y" : 2984.0
            },
            "properties" : {
              "Regular Expression" : "(?s)Failure details via attributes:(.*$)",
              "Replacement Value" : "",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "62c3438b-4756-3ea6-a3b6-6d69619fb513",
            "name" : "AttributesToJSON",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1375.1956507673563,
              "y" : 1972.860155574584
            },
            "properties" : {
              "Destination" : "flowfile-attribute",
              "Null Value" : "false",
              "Include Core Attributes" : "false"
            },
            "propertyDescriptors" : {
              "attributes-to-json-regex" : {
                "displayName" : "Attributes Regular Expression",
                "identifiesControllerService" : false,
                "name" : "attributes-to-json-regex",
                "sensitive" : false
              },
              "Destination" : {
                "displayName" : "Destination",
                "identifiesControllerService" : false,
                "name" : "Destination",
                "sensitive" : false
              },
              "Null Value" : {
                "displayName" : "Null Value",
                "identifiesControllerService" : false,
                "name" : "Null Value",
                "sensitive" : false
              },
              "Attributes List" : {
                "displayName" : "Attributes List",
                "identifiesControllerService" : false,
                "name" : "Attributes List",
                "sensitive" : false
              },
              "Include Core Attributes" : {
                "displayName" : "Include Core Attributes",
                "identifiesControllerService" : false,
                "name" : "Include Core Attributes",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.AttributesToJSON",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "ERROR",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "21aaa78b-95f5-3797-92be-c581087cfe72",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1376.0,
              "y" : 2240.0
            },
            "properties" : {
              "log-message" : "${JSONAttributes}",
              "log-level" : "error",
              "log-prefix" : "Clinical Ingestion Flow Failure\nCurrent Attributes:\n"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-kafka-2-6-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "29d24ce1-1c00-3817-995c-450ddff3567b",
            "identifier" : "40232414-9e39-3ff3-96ac-b88d567ddca4",
            "name" : "Post to Kafka",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1376.0,
              "y" : 2720.0
            },
            "properties" : {
              "compression.type" : "none",
              "attribute-name-regex" : "batchId",
              "bootstrap.servers" : "#{kafka.brokers}",
              "kafka-key" : "CONTENT",
              "sasl.mechanism" : "PLAIN",
              "max.block.ms" : "5 sec",
              "message-header-encoding" : "UTF-8",
              "ack.wait.time" : "5 secs",
              "sasl.username" : "token",
              "use-transactions" : "true",
              "acks" : "all",
              "security.protocol" : "PLAINTEXT",
              "max.request.size" : "1 MB",
              "sasl.token.auth" : "false",
              "partitioner.class" : "org.apache.kafka.clients.producer.internals.DefaultPartitioner",
              "topic" : "failure.topic.in",
              "sasl.password" : "#{kafka.auth.password}",
              "key-attribute-encoding" : "utf-8"
            },
            "propertyDescriptors" : {
              "compression.type" : {
                "displayName" : "Compression Type",
                "identifiesControllerService" : false,
                "name" : "compression.type",
                "sensitive" : false
              },
              "attribute-name-regex" : {
                "displayName" : "Attributes to Send as Headers (Regex)",
                "identifiesControllerService" : false,
                "name" : "attribute-name-regex",
                "sensitive" : false
              },
              "bootstrap.servers" : {
                "displayName" : "Kafka Brokers",
                "identifiesControllerService" : false,
                "name" : "bootstrap.servers",
                "sensitive" : false
              },
              "sasl.kerberos.principal" : {
                "displayName" : "Kerberos Principal",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.principal",
                "sensitive" : false
              },
              "sasl.kerberos.service.name" : {
                "displayName" : "Kerberos Service Name",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.service.name",
                "sensitive" : false
              },
              "kerberos-credentials-service" : {
                "displayName" : "Kerberos Credentials Service",
                "identifiesControllerService" : true,
                "name" : "kerberos-credentials-service",
                "sensitive" : false
              },
              "kafka-key" : {
                "displayName" : "Kafka Key",
                "identifiesControllerService" : false,
                "name" : "kafka-key",
                "sensitive" : false
              },
              "partition" : {
                "displayName" : "Partition",
                "identifiesControllerService" : false,
                "name" : "partition",
                "sensitive" : false
              },
              "sasl.mechanism" : {
                "displayName" : "SASL Mechanism",
                "identifiesControllerService" : false,
                "name" : "sasl.mechanism",
                "sensitive" : false
              },
              "max.block.ms" : {
                "displayName" : "Max Metadata Wait Time",
                "identifiesControllerService" : false,
                "name" : "max.block.ms",
                "sensitive" : false
              },
              "message-header-encoding" : {
                "displayName" : "Message Header Encoding",
                "identifiesControllerService" : false,
                "name" : "message-header-encoding",
                "sensitive" : false
              },
              "message-demarcator" : {
                "displayName" : "Message Demarcator",
                "identifiesControllerService" : false,
                "name" : "message-demarcator",
                "sensitive" : false
              },
              "transactional-id-prefix" : {
                "displayName" : "Transactional Id Prefix",
                "identifiesControllerService" : false,
                "name" : "transactional-id-prefix",
                "sensitive" : false
              },
              "ack.wait.time" : {
                "displayName" : "Acknowledgment Wait Time",
                "identifiesControllerService" : false,
                "name" : "ack.wait.time",
                "sensitive" : false
              },
              "sasl.username" : {
                "displayName" : "Username",
                "identifiesControllerService" : false,
                "name" : "sasl.username",
                "sensitive" : false
              },
              "use-transactions" : {
                "displayName" : "Use Transactions",
                "identifiesControllerService" : false,
                "name" : "use-transactions",
                "sensitive" : false
              },
              "acks" : {
                "displayName" : "Delivery Guarantee",
                "identifiesControllerService" : false,
                "name" : "acks",
                "sensitive" : false
              },
              "security.protocol" : {
                "displayName" : "Security Protocol",
                "identifiesControllerService" : false,
                "name" : "security.protocol",
                "sensitive" : false
              },
              "ssl.context.service" : {
                "displayName" : "SSL Context Service",
                "identifiesControllerService" : true,
                "name" : "ssl.context.service",
                "sensitive" : false
              },
              "max.request.size" : {
                "displayName" : "Max Request Size",
                "identifiesControllerService" : false,
                "name" : "max.request.size",
                "sensitive" : false
              },
              "sasl.token.auth" : {
                "displayName" : "Token Auth",
                "identifiesControllerService" : false,
                "name" : "sasl.token.auth",
                "sensitive" : false
              },
              "partitioner.class" : {
                "displayName" : "Partitioner class",
                "identifiesControllerService" : false,
                "name" : "partitioner.class",
                "sensitive" : false
              },
              "sasl.kerberos.keytab" : {
                "displayName" : "Kerberos Keytab",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.keytab",
                "sensitive" : false
              },
              "topic" : {
                "displayName" : "Topic Name",
                "identifiesControllerService" : false,
                "name" : "topic",
                "sensitive" : false
              },
              "sasl.password" : {
                "displayName" : "Password",
                "identifiesControllerService" : false,
                "name" : "sasl.password",
                "sensitive" : true
              },
              "key-attribute-encoding" : {
                "displayName" : "Key Attribute Encoding",
                "identifiesControllerService" : false,
                "name" : "key-attribute-encoding",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.kafka.pubsub.PublishKafka_2_6",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3736.0,
              "y" : 3192.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "01009f7a-2dad-3f71-a8a6-2d9218adc485",
              "name" : "RetryFlowFile",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "20ee2d61-3aaa-379e-9018-87dfa0cde0e5",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Retry" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "c1c4a729-88da-3ba8-bbaf-05a07c78c462",
              "name" : "Route On Timeout",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "83279e98-ed71-3d96-a386-b1e55cc2b788",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "8e29beb3-a70b-3338-a695-f1f313e7c6d1",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "8e799afc-f30f-37c2-8d60-b2a3b347e410",
              "name" : "FHIR Resource",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3616.0,
              "y" : 3696.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
              "name" : "Invalid FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "9f3496c4-bb41-3b2a-ab3c-79503a7c3eaa",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "377980b6-c3d5-3d38-b2db-ea1a68344674",
              "name" : "Route On Validity",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3752.0,
              "y" : 3096.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "2199c341-775b-31aa-bd08-c607b3d94e28",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "retry" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "01009f7a-2dad-3f71-a8a6-2d9218adc485",
              "name" : "RetryFlowFile",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "c653b104-41af-36c2-a583-56bdacb80c47",
              "name" : "Valid FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "74447c8c-5f03-3001-9599-8e9e31fbb88b",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "16bdb6d4-609b-39c1-abe8-ae10cd568554",
              "name" : "Remove validationResponse attribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "01009f7a-2dad-3f71-a8a6-2d9218adc485",
              "name" : "RetryFlowFile",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "02d1dd3e-dce7-3b1e-a872-d8f98e525478",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Timeout" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "c1c4a729-88da-3ba8-bbaf-05a07c78c462",
              "name" : "Route On Timeout",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "377980b6-c3d5-3d38-b2db-ea1a68344674",
              "name" : "Route On Validity",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "60b0f927-8e96-3e93-b4c2-bdfebce0a8f9",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response", "Original" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 4128.0,
              "y" : 3608.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
              "name" : "Invalid FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "f50c1ee0-def7-3726-a303-98c05bff6ad6",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "retries_exceeded", "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "01009f7a-2dad-3f71-a8a6-2d9218adc485",
              "name" : "RetryFlowFile",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "16bdb6d4-609b-39c1-abe8-ae10cd568554",
              "name" : "Remove validationResponse attribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "b5aa1561-9fc8-38ee-8d49-f6421b669ca6",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Valid FHIR Data" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "377980b6-c3d5-3d38-b2db-ea1a68344674",
              "name" : "Route On Validity",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
              "name" : "Invalid FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "1a4a4888-45c6-3771-872f-20107455b5bd",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "c1c4a729-88da-3ba8-bbaf-05a07c78c462",
              "name" : "Route On Timeout",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ {
              "x" : 3696.0,
              "y" : 3608.0
            } ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
              "name" : "Invalid FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "2c413d85-fa00-3c31-a280-356a2c1ad7c2",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "No Retry" ],
            "source" : {
              "comments" : "",
              "groupId" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
              "id" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
              "name" : "Validate FHIR resource using REST API",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "8e799afc-f30f-37c2-8d60-b2a3b347e410",
            "name" : "FHIR Resource",
            "position" : {
              "x" : 3288.0,
              "y" : 3032.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "name" : "Validate FHIR Data",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "c653b104-41af-36c2-a583-56bdacb80c47",
            "name" : "Valid FHIR Data",
            "position" : {
              "x" : 3144.0,
              "y" : 3776.0
            },
            "type" : "OUTPUT_PORT"
          }, {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "004bd802-a7d1-3df4-9123-8ee3038a4fb9",
            "name" : "Invalid FHIR Data",
            "position" : {
              "x" : 3800.0,
              "y" : 3888.0
            },
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "cms_adapter_parameters",
          "position" : {
            "x" : 2384.0,
            "y" : 2792.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "01009f7a-2dad-3f71-a8a6-2d9218adc485",
            "name" : "RetryFlowFile",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 3952.0,
              "y" : 3080.0
            },
            "properties" : {
              "penalize-retries" : "true",
              "maximum-retries" : "3",
              "Fail on Non-numerical Overwrite" : "false",
              "reuse-mode" : "fail",
              "retry-attribute" : "flowfile.retries"
            },
            "propertyDescriptors" : {
              "penalize-retries" : {
                "displayName" : "Penalize Retries",
                "identifiesControllerService" : false,
                "name" : "penalize-retries",
                "sensitive" : false
              },
              "maximum-retries" : {
                "displayName" : "Maximum Retries",
                "identifiesControllerService" : false,
                "name" : "maximum-retries",
                "sensitive" : false
              },
              "Fail on Non-numerical Overwrite" : {
                "displayName" : "Fail on Non-numerical Overwrite",
                "identifiesControllerService" : false,
                "name" : "Fail on Non-numerical Overwrite",
                "sensitive" : false
              },
              "reuse-mode" : {
                "displayName" : "Reuse Mode",
                "identifiesControllerService" : false,
                "name" : "reuse-mode",
                "sensitive" : false
              },
              "retry-attribute" : {
                "displayName" : "Retry Attribute",
                "identifiesControllerService" : false,
                "name" : "retry-attribute",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RetryFlowFile",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 5,
            "executionNode" : "ALL",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "23fb7e04-3259-381d-804b-5bd0c1a4e41a",
            "name" : "Validate FHIR resource using REST API",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 3232.0,
              "y" : 3152.0
            },
            "properties" : {
              "use-etag" : "false",
              "Proxy Type" : "http",
              "Basic Authentication Password" : "#{FHIR_UserPwd_PatientAccess}",
              "Connection Timeout" : "15 mins",
              "send-message-body" : "true",
              "set-form-filename" : "true",
              "Always Output Response" : "false",
              "etag-max-cache-size" : "10MB",
              "idle-timeout" : "5 mins",
              "Put Response Body In Attribute" : "validationResponse",
              "Use Chunked Encoding" : "false",
              "Follow Redirects" : "True",
              "Remote URL" : "#{FHIR_URL_PatientAccess}/Bundle/$validate",
              "Content-Type" : "application/json",
              "max-idle-connections" : "5",
              "Read Timeout" : "15 mins",
              "Max Length To Put In Attribute" : "256",
              "ignore-response-content" : "false",
              "Digest Authentication" : "false",
              "HTTP Method" : "POST",
              "Add Response Headers to Request" : "false",
              "Basic Authentication Username" : "#{FHIR_User_PatientAccess}",
              "Include Date Header" : "True",
              "Penalize on \"No Retry\"" : "false"
            },
            "propertyDescriptors" : {
              "Proxy Host" : {
                "displayName" : "Proxy Host",
                "identifiesControllerService" : false,
                "name" : "Proxy Host",
                "sensitive" : false
              },
              "Attributes to Send" : {
                "displayName" : "Attributes to Send",
                "identifiesControllerService" : false,
                "name" : "Attributes to Send",
                "sensitive" : false
              },
              "use-etag" : {
                "displayName" : "Use HTTP ETag",
                "identifiesControllerService" : false,
                "name" : "use-etag",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Proxy Type" : {
                "displayName" : "Proxy Type",
                "identifiesControllerService" : false,
                "name" : "Proxy Type",
                "sensitive" : false
              },
              "Basic Authentication Password" : {
                "displayName" : "Basic Authentication Password",
                "identifiesControllerService" : false,
                "name" : "Basic Authentication Password",
                "sensitive" : true
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "send-message-body" : {
                "displayName" : "Send Message Body",
                "identifiesControllerService" : false,
                "name" : "send-message-body",
                "sensitive" : false
              },
              "set-form-filename" : {
                "displayName" : "Set Flowfile Form Data File Name",
                "identifiesControllerService" : false,
                "name" : "set-form-filename",
                "sensitive" : false
              },
              "Always Output Response" : {
                "displayName" : "Always Output Response",
                "identifiesControllerService" : false,
                "name" : "Always Output Response",
                "sensitive" : false
              },
              "etag-max-cache-size" : {
                "displayName" : "Maximum ETag Cache Size",
                "identifiesControllerService" : false,
                "name" : "etag-max-cache-size",
                "sensitive" : false
              },
              "idle-timeout" : {
                "displayName" : "Idle Timeout",
                "identifiesControllerService" : false,
                "name" : "idle-timeout",
                "sensitive" : false
              },
              "Put Response Body In Attribute" : {
                "displayName" : "Put Response Body In Attribute",
                "identifiesControllerService" : false,
                "name" : "Put Response Body In Attribute",
                "sensitive" : false
              },
              "Use Chunked Encoding" : {
                "displayName" : "Use Chunked Encoding",
                "identifiesControllerService" : false,
                "name" : "Use Chunked Encoding",
                "sensitive" : false
              },
              "Follow Redirects" : {
                "displayName" : "Follow Redirects",
                "identifiesControllerService" : false,
                "name" : "Follow Redirects",
                "sensitive" : false
              },
              "Remote URL" : {
                "displayName" : "Remote URL",
                "identifiesControllerService" : false,
                "name" : "Remote URL",
                "sensitive" : false
              },
              "Content-Type" : {
                "displayName" : "Content-Type",
                "identifiesControllerService" : false,
                "name" : "Content-Type",
                "sensitive" : false
              },
              "form-body-form-name" : {
                "displayName" : "Flowfile Form Data Name",
                "identifiesControllerService" : false,
                "name" : "form-body-form-name",
                "sensitive" : false
              },
              "max-idle-connections" : {
                "displayName" : "Max Idle Connections",
                "identifiesControllerService" : false,
                "name" : "max-idle-connections",
                "sensitive" : false
              },
              "invokehttp-proxy-user" : {
                "displayName" : "Proxy Username",
                "identifiesControllerService" : false,
                "name" : "invokehttp-proxy-user",
                "sensitive" : false
              },
              "Read Timeout" : {
                "displayName" : "Read Timeout",
                "identifiesControllerService" : false,
                "name" : "Read Timeout",
                "sensitive" : false
              },
              "Max Length To Put In Attribute" : {
                "displayName" : "Max Length To Put In Attribute",
                "identifiesControllerService" : false,
                "name" : "Max Length To Put In Attribute",
                "sensitive" : false
              },
              "invokehttp-proxy-password" : {
                "displayName" : "Proxy Password",
                "identifiesControllerService" : false,
                "name" : "invokehttp-proxy-password",
                "sensitive" : true
              },
              "ignore-response-content" : {
                "displayName" : "Ignore response's content",
                "identifiesControllerService" : false,
                "name" : "ignore-response-content",
                "sensitive" : false
              },
              "Proxy Port" : {
                "displayName" : "Proxy Port",
                "identifiesControllerService" : false,
                "name" : "Proxy Port",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Digest Authentication" : {
                "displayName" : "Use Digest Authentication",
                "identifiesControllerService" : false,
                "name" : "Digest Authentication",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Add Response Headers to Request" : {
                "displayName" : "Add Response Headers to Request",
                "identifiesControllerService" : false,
                "name" : "Add Response Headers to Request",
                "sensitive" : false
              },
              "Basic Authentication Username" : {
                "displayName" : "Basic Authentication Username",
                "identifiesControllerService" : false,
                "name" : "Basic Authentication Username",
                "sensitive" : false
              },
              "Include Date Header" : {
                "displayName" : "Include Date Header",
                "identifiesControllerService" : false,
                "name" : "Include Date Header",
                "sensitive" : false
              },
              "Penalize on \"No Retry\"" : {
                "displayName" : "Penalize on \"No Retry\"",
                "identifiesControllerService" : false,
                "name" : "Penalize on \"No Retry\"",
                "sensitive" : false
              },
              "Useragent" : {
                "displayName" : "Useragent",
                "identifiesControllerService" : false,
                "name" : "Useragent",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "16bdb6d4-609b-39c1-abe8-ae10cd568554",
            "name" : "Remove validationResponse attribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 3088.0,
              "y" : 3568.0
            },
            "properties" : {
              "Delete Attributes Expression" : "validationResponse",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "c1c4a729-88da-3ba8-bbaf-05a07c78c462",
            "name" : "Route On Timeout",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 3696.0,
              "y" : 3344.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "Timeout" : "${invokehttp.status.exception.message:toLower():contains('timeout'):or(${invokehttp.java.exception.message:toLower():contains('timeout')})}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "Timeout" : {
                "displayName" : "Timeout",
                "identifiesControllerService" : false,
                "name" : "Timeout",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "9bfb47b7-06d8-36ec-80c0-42c967c5c158",
            "identifier" : "377980b6-c3d5-3d38-b2db-ea1a68344674",
            "name" : "Route On Validity",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 3088.0,
              "y" : 3368.0
            },
            "properties" : {
              "Valid FHIR Data" : "${invokehttp.status.code:equals('200')}",
              "Routing Strategy" : "Route to Property name"
            },
            "propertyDescriptors" : {
              "Valid FHIR Data" : {
                "displayName" : "Valid FHIR Data",
                "identifiesControllerService" : false,
                "name" : "Valid FHIR Data",
                "sensitive" : false
              },
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "9ef8d8e2-a038-35f7-b19c-3c61171c5438",
              "name" : "Call HL7 Resource Generator Service",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "72f979f7-e0ce-32c4-825f-a003a68c135a",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "8d3b2d53-ef57-34ff-bacf-011c864cb6b6",
              "name" : "Input Data",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "e9e15aa5-51ac-3fd8-9150-b40e7b7e944f",
              "name" : "FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "1d4ab2f8-5607-3b10-b85b-72ba44153f69",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "No Retry", "Retry", "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "9ef8d8e2-a038-35f7-b19c-3c61171c5438",
              "name" : "Call HL7 Resource Generator Service",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "c6c5fc9e-30a7-38a8-9bd2-158db9048a9d",
              "name" : "Route on HTTP StatusCode",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "2499ef44-96ec-3bf4-b4e3-279bf00232ba",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "9ef8d8e2-a038-35f7-b19c-3c61171c5438",
              "name" : "Call HL7 Resource Generator Service",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "7caf4375-541a-36a3-94de-de5b965b4141",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "3017bf18-f958-3022-b09e-4e07d9d0dbbe",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "00de9b90-54b7-3341-83ff-cb57ad257879",
              "name" : "Update Bundle Type to Transaction",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "7caf4375-541a-36a3-94de-de5b965b4141",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "cff13684-47f0-3117-8d33-84886ae14a36",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "c6c5fc9e-30a7-38a8-9bd2-158db9048a9d",
              "name" : "Route on HTTP StatusCode",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "e9e15aa5-51ac-3fd8-9150-b40e7b7e944f",
              "name" : "FHIR Data",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "14fcb1a8-e907-3db2-9b75-0eead632032d",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "00de9b90-54b7-3341-83ff-cb57ad257879",
              "name" : "Update Bundle Type to Transaction",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "00de9b90-54b7-3341-83ff-cb57ad257879",
              "name" : "Update Bundle Type to Transaction",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "90c1ba09-47e6-3d81-8aa2-69743650058f",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Success" ],
            "source" : {
              "comments" : "",
              "groupId" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
              "id" : "c6c5fc9e-30a7-38a8-9bd2-158db9048a9d",
              "name" : "Route on HTTP StatusCode",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "8d3b2d53-ef57-34ff-bacf-011c864cb6b6",
            "name" : "Input Data",
            "position" : {
              "x" : 984.0,
              "y" : 128.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "name" : "Convert HL7 To FHIR",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "7caf4375-541a-36a3-94de-de5b965b4141",
            "name" : "Failure",
            "position" : {
              "x" : 1400.0,
              "y" : 984.0
            },
            "type" : "OUTPUT_PORT"
          }, {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "e9e15aa5-51ac-3fd8-9150-b40e7b7e944f",
            "name" : "FHIR Data",
            "position" : {
              "x" : 696.0,
              "y" : 984.0
            },
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "cms_adapter_parameters",
          "position" : {
            "x" : 2384.0,
            "y" : 2232.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "c6c5fc9e-30a7-38a8-9bd2-158db9048a9d",
            "name" : "Route on HTTP StatusCode",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1224.0,
              "y" : 472.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "Success" : "${invokehttp.status.code:equals('200')}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "Success" : {
                "displayName" : "Success",
                "identifiesControllerService" : false,
                "name" : "Success",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "00de9b90-54b7-3341-83ff-cb57ad257879",
            "name" : "Update Bundle Type to Transaction",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : 704.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.*\n\ndef ff = session.get()\nif(!ff) return\nff = session.write(ff, {rawIn, rawOut->\n    //parse flowfile content to maps & arrays\n    def json = new JsonSlurper().parse(rawIn, \"UTF-8\")\n    //change json \n    json.type =  \"transaction\"\n    //write to output changed content\n    rawOut.withWriter(\"UTF-8\"){ it.write( JsonOutput.toJson(json) )}\n} as StreamCallback)\nsession.transfer(ff, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "identifiesControllerService" : false,
                "name" : "Script File",
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "Original" ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "6bcd14cb-81bd-3418-baf1-3950ebf45d4a",
            "identifier" : "9ef8d8e2-a038-35f7-b19c-3c61171c5438",
            "name" : "Call HL7 Resource Generator Service",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 928.0,
              "y" : 240.0
            },
            "properties" : {
              "use-etag" : "false",
              "Proxy Type" : "http",
              "Connection Timeout" : "5 secs",
              "send-message-body" : "true",
              "set-form-filename" : "true",
              "Always Output Response" : "false",
              "etag-max-cache-size" : "10MB",
              "idle-timeout" : "5 mins",
              "Use Chunked Encoding" : "false",
              "Follow Redirects" : "True",
              "Remote URL" : "#{HL7_RESOURCE_GENERATOR_URL}",
              "Content-Type" : "text/plain",
              "max-idle-connections" : "5",
              "Read Timeout" : "15 secs",
              "Max Length To Put In Attribute" : "256",
              "ignore-response-content" : "false",
              "Digest Authentication" : "false",
              "HTTP Method" : "POST",
              "Add Response Headers to Request" : "false",
              "Include Date Header" : "True",
              "Penalize on \"No Retry\"" : "false"
            },
            "propertyDescriptors" : {
              "Proxy Host" : {
                "displayName" : "Proxy Host",
                "identifiesControllerService" : false,
                "name" : "Proxy Host",
                "sensitive" : false
              },
              "Attributes to Send" : {
                "displayName" : "Attributes to Send",
                "identifiesControllerService" : false,
                "name" : "Attributes to Send",
                "sensitive" : false
              },
              "use-etag" : {
                "displayName" : "Use HTTP ETag",
                "identifiesControllerService" : false,
                "name" : "use-etag",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Proxy Type" : {
                "displayName" : "Proxy Type",
                "identifiesControllerService" : false,
                "name" : "Proxy Type",
                "sensitive" : false
              },
              "Basic Authentication Password" : {
                "displayName" : "Basic Authentication Password",
                "identifiesControllerService" : false,
                "name" : "Basic Authentication Password",
                "sensitive" : true
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "send-message-body" : {
                "displayName" : "Send Message Body",
                "identifiesControllerService" : false,
                "name" : "send-message-body",
                "sensitive" : false
              },
              "set-form-filename" : {
                "displayName" : "Set Flowfile Form Data File Name",
                "identifiesControllerService" : false,
                "name" : "set-form-filename",
                "sensitive" : false
              },
              "Always Output Response" : {
                "displayName" : "Always Output Response",
                "identifiesControllerService" : false,
                "name" : "Always Output Response",
                "sensitive" : false
              },
              "etag-max-cache-size" : {
                "displayName" : "Maximum ETag Cache Size",
                "identifiesControllerService" : false,
                "name" : "etag-max-cache-size",
                "sensitive" : false
              },
              "idle-timeout" : {
                "displayName" : "Idle Timeout",
                "identifiesControllerService" : false,
                "name" : "idle-timeout",
                "sensitive" : false
              },
              "Put Response Body In Attribute" : {
                "displayName" : "Put Response Body In Attribute",
                "identifiesControllerService" : false,
                "name" : "Put Response Body In Attribute",
                "sensitive" : false
              },
              "Use Chunked Encoding" : {
                "displayName" : "Use Chunked Encoding",
                "identifiesControllerService" : false,
                "name" : "Use Chunked Encoding",
                "sensitive" : false
              },
              "Follow Redirects" : {
                "displayName" : "Follow Redirects",
                "identifiesControllerService" : false,
                "name" : "Follow Redirects",
                "sensitive" : false
              },
              "Remote URL" : {
                "displayName" : "Remote URL",
                "identifiesControllerService" : false,
                "name" : "Remote URL",
                "sensitive" : false
              },
              "Content-Type" : {
                "displayName" : "Content-Type",
                "identifiesControllerService" : false,
                "name" : "Content-Type",
                "sensitive" : false
              },
              "form-body-form-name" : {
                "displayName" : "Flowfile Form Data Name",
                "identifiesControllerService" : false,
                "name" : "form-body-form-name",
                "sensitive" : false
              },
              "max-idle-connections" : {
                "displayName" : "Max Idle Connections",
                "identifiesControllerService" : false,
                "name" : "max-idle-connections",
                "sensitive" : false
              },
              "invokehttp-proxy-user" : {
                "displayName" : "Proxy Username",
                "identifiesControllerService" : false,
                "name" : "invokehttp-proxy-user",
                "sensitive" : false
              },
              "Read Timeout" : {
                "displayName" : "Read Timeout",
                "identifiesControllerService" : false,
                "name" : "Read Timeout",
                "sensitive" : false
              },
              "Max Length To Put In Attribute" : {
                "displayName" : "Max Length To Put In Attribute",
                "identifiesControllerService" : false,
                "name" : "Max Length To Put In Attribute",
                "sensitive" : false
              },
              "invokehttp-proxy-password" : {
                "displayName" : "Proxy Password",
                "identifiesControllerService" : false,
                "name" : "invokehttp-proxy-password",
                "sensitive" : true
              },
              "ignore-response-content" : {
                "displayName" : "Ignore response's content",
                "identifiesControllerService" : false,
                "name" : "ignore-response-content",
                "sensitive" : false
              },
              "Proxy Port" : {
                "displayName" : "Proxy Port",
                "identifiesControllerService" : false,
                "name" : "Proxy Port",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Digest Authentication" : {
                "displayName" : "Use Digest Authentication",
                "identifiesControllerService" : false,
                "name" : "Digest Authentication",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Add Response Headers to Request" : {
                "displayName" : "Add Response Headers to Request",
                "identifiesControllerService" : false,
                "name" : "Add Response Headers to Request",
                "sensitive" : false
              },
              "Basic Authentication Username" : {
                "displayName" : "Basic Authentication Username",
                "identifiesControllerService" : false,
                "name" : "Basic Authentication Username",
                "sensitive" : false
              },
              "Include Date Header" : {
                "displayName" : "Include Date Header",
                "identifiesControllerService" : false,
                "name" : "Include Date Header",
                "sensitive" : false
              },
              "Penalize on \"No Retry\"" : {
                "displayName" : "Penalize on \"No Retry\"",
                "identifiesControllerService" : false,
                "name" : "Penalize on \"No Retry\"",
                "sensitive" : false
              },
              "Useragent" : {
                "displayName" : "Useragent",
                "identifiesControllerService" : false,
                "name" : "Useragent",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "59f220e8-5232-3976-b5df-2816ea6da8a2",
              "name" : "Failure",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "1f687d5a-50cd-3fc7-85cc-850735f8d4be",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "05e45850-de95-3eaf-88eb-32c9d3a57c89",
              "name" : "PublishKafka_2_6",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "c9cb8abf-b552-3031-9e88-8956e555541e",
              "name" : "Enriched FHIR resource",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "288e452e-4b4c-33c3-a7ea-c8687980eadb",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "6200439d-190e-3dda-b639-807dee60209f",
              "name" : "ConsumeKafka_2_6",
              "type" : "PROCESSOR"
            },
            "zIndex" : 0
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "05e45850-de95-3eaf-88eb-32c9d3a57c89",
              "name" : "PublishKafka_2_6",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "acb63f6d-f962-3b90-ae0d-b14282fdefd1",
            "labelIndex" : 1,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "comments" : "",
              "groupId" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
              "id" : "fef3ad4b-53db-3879-b4e8-c32a75c336c3",
              "name" : "FHIR resource",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 0
          } ],
          "controllerServices" : [ ],
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "comments" : "",
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "fef3ad4b-53db-3879-b4e8-c32a75c336c3",
            "name" : "FHIR resource",
            "position" : {
              "x" : 832.0,
              "y" : 344.0
            },
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "name" : "Enrich FHIR Data",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "comments" : "",
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "c9cb8abf-b552-3031-9e88-8956e555541e",
            "name" : "Enriched FHIR resource",
            "position" : {
              "x" : 832.0,
              "y" : 992.0
            },
            "type" : "OUTPUT_PORT"
          }, {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "59f220e8-5232-3976-b5df-2816ea6da8a2",
            "name" : "Failure",
            "position" : {
              "x" : 1480.0,
              "y" : 512.0
            },
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "Enrichment Parameter Context",
          "position" : {
            "x" : 2384.0,
            "y" : 3072.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "success" ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-kafka-2-6-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "05e45850-de95-3eaf-88eb-32c9d3a57c89",
            "name" : "PublishKafka_2_6",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 776.0,
              "y" : 472.0
            },
            "properties" : {
              "compression.type" : "none",
              "attribute-name-regex" : ".*",
              "bootstrap.servers" : "#{kafka.brokers}",
              "kafka-key" : "${resourceId}",
              "sasl.mechanism" : "PLAIN",
              "max.block.ms" : "5 sec",
              "message-header-encoding" : "UTF-8",
              "ack.wait.time" : "5 secs",
              "sasl.username" : "#{kafka.auth.user}",
              "use-transactions" : "true",
              "acks" : "all",
              "security.protocol" : "PLAINTEXT",
              "max.request.size" : "10 MB",
              "sasl.token.auth" : "false",
              "partitioner.class" : "org.apache.kafka.clients.producer.internals.DefaultPartitioner",
              "topic" : "#{enrich.in}",
              "sasl.password" : "#{kafka.auth.password}",
              "key-attribute-encoding" : "utf-8"
            },
            "propertyDescriptors" : {
              "compression.type" : {
                "displayName" : "Compression Type",
                "identifiesControllerService" : false,
                "name" : "compression.type",
                "sensitive" : false
              },
              "attribute-name-regex" : {
                "displayName" : "Attributes to Send as Headers (Regex)",
                "identifiesControllerService" : false,
                "name" : "attribute-name-regex",
                "sensitive" : false
              },
              "bootstrap.servers" : {
                "displayName" : "Kafka Brokers",
                "identifiesControllerService" : false,
                "name" : "bootstrap.servers",
                "sensitive" : false
              },
              "sasl.kerberos.principal" : {
                "displayName" : "Kerberos Principal",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.principal",
                "sensitive" : false
              },
              "sasl.kerberos.service.name" : {
                "displayName" : "Kerberos Service Name",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.service.name",
                "sensitive" : false
              },
              "kerberos-credentials-service" : {
                "displayName" : "Kerberos Credentials Service",
                "identifiesControllerService" : true,
                "name" : "kerberos-credentials-service",
                "sensitive" : false
              },
              "kafka-key" : {
                "displayName" : "Kafka Key",
                "identifiesControllerService" : false,
                "name" : "kafka-key",
                "sensitive" : false
              },
              "partition" : {
                "displayName" : "Partition",
                "identifiesControllerService" : false,
                "name" : "partition",
                "sensitive" : false
              },
              "sasl.mechanism" : {
                "displayName" : "SASL Mechanism",
                "identifiesControllerService" : false,
                "name" : "sasl.mechanism",
                "sensitive" : false
              },
              "max.block.ms" : {
                "displayName" : "Max Metadata Wait Time",
                "identifiesControllerService" : false,
                "name" : "max.block.ms",
                "sensitive" : false
              },
              "message-header-encoding" : {
                "displayName" : "Message Header Encoding",
                "identifiesControllerService" : false,
                "name" : "message-header-encoding",
                "sensitive" : false
              },
              "message-demarcator" : {
                "displayName" : "Message Demarcator",
                "identifiesControllerService" : false,
                "name" : "message-demarcator",
                "sensitive" : false
              },
              "transactional-id-prefix" : {
                "displayName" : "Transactional Id Prefix",
                "identifiesControllerService" : false,
                "name" : "transactional-id-prefix",
                "sensitive" : false
              },
              "ack.wait.time" : {
                "displayName" : "Acknowledgment Wait Time",
                "identifiesControllerService" : false,
                "name" : "ack.wait.time",
                "sensitive" : false
              },
              "sasl.username" : {
                "displayName" : "Username",
                "identifiesControllerService" : false,
                "name" : "sasl.username",
                "sensitive" : false
              },
              "use-transactions" : {
                "displayName" : "Use Transactions",
                "identifiesControllerService" : false,
                "name" : "use-transactions",
                "sensitive" : false
              },
              "acks" : {
                "displayName" : "Delivery Guarantee",
                "identifiesControllerService" : false,
                "name" : "acks",
                "sensitive" : false
              },
              "security.protocol" : {
                "displayName" : "Security Protocol",
                "identifiesControllerService" : false,
                "name" : "security.protocol",
                "sensitive" : false
              },
              "ssl.context.service" : {
                "displayName" : "SSL Context Service",
                "identifiesControllerService" : true,
                "name" : "ssl.context.service",
                "sensitive" : false
              },
              "max.request.size" : {
                "displayName" : "Max Request Size",
                "identifiesControllerService" : false,
                "name" : "max.request.size",
                "sensitive" : false
              },
              "sasl.token.auth" : {
                "displayName" : "Token Auth",
                "identifiesControllerService" : false,
                "name" : "sasl.token.auth",
                "sensitive" : false
              },
              "partitioner.class" : {
                "displayName" : "Partitioner class",
                "identifiesControllerService" : false,
                "name" : "partitioner.class",
                "sensitive" : false
              },
              "sasl.kerberos.keytab" : {
                "displayName" : "Kerberos Keytab",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.keytab",
                "sensitive" : false
              },
              "topic" : {
                "displayName" : "Topic Name",
                "identifiesControllerService" : false,
                "name" : "topic",
                "sensitive" : false
              },
              "sasl.password" : {
                "displayName" : "Password",
                "identifiesControllerService" : false,
                "name" : "sasl.password",
                "sensitive" : true
              },
              "key-attribute-encoding" : {
                "displayName" : "Key Attribute Encoding",
                "identifiesControllerService" : false,
                "name" : "key-attribute-encoding",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.kafka.pubsub.PublishKafka_2_6",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-kafka-2-6-nar",
              "group" : "org.apache.nifi",
              "version" : "1.12.1"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "3fc9336e-e43c-3797-844a-7c3cc60bfc32",
            "identifier" : "6200439d-190e-3dda-b639-807dee60209f",
            "name" : "ConsumeKafka_2_6",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 776.0,
              "y" : 752.0
            },
            "properties" : {
              "header-name-regex" : ".*",
              "sasl.username" : "#{kafka.auth.user}",
              "max.poll.records" : "10000",
              "group.id" : "#{kafka.consumer.group}",
              "bootstrap.servers" : "#{kafka.brokers}",
              "topic_type" : "names",
              "security.protocol" : "PLAINTEXT",
              "max-uncommit-offset-wait" : "1 secs",
              "sasl.mechanism" : "PLAIN",
              "sasl.token.auth" : "false",
              "honor-transactions" : "true",
              "Communications Timeout" : "60 secs",
              "topic" : "#{enrich.out}",
              "message-header-encoding" : "UTF-8",
              "sasl.password" : "#{kafka.auth.password}",
              "key-attribute-encoding" : "utf-8",
              "auto.offset.reset" : "latest"
            },
            "propertyDescriptors" : {
              "header-name-regex" : {
                "displayName" : "Headers to Add as Attributes (Regex)",
                "identifiesControllerService" : false,
                "name" : "header-name-regex",
                "sensitive" : false
              },
              "sasl.username" : {
                "displayName" : "Username",
                "identifiesControllerService" : false,
                "name" : "sasl.username",
                "sensitive" : false
              },
              "max.poll.records" : {
                "displayName" : "Max Poll Records",
                "identifiesControllerService" : false,
                "name" : "max.poll.records",
                "sensitive" : false
              },
              "group.id" : {
                "displayName" : "Group ID",
                "identifiesControllerService" : false,
                "name" : "group.id",
                "sensitive" : false
              },
              "bootstrap.servers" : {
                "displayName" : "Kafka Brokers",
                "identifiesControllerService" : false,
                "name" : "bootstrap.servers",
                "sensitive" : false
              },
              "topic_type" : {
                "displayName" : "Topic Name Format",
                "identifiesControllerService" : false,
                "name" : "topic_type",
                "sensitive" : false
              },
              "sasl.kerberos.principal" : {
                "displayName" : "Kerberos Principal",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.principal",
                "sensitive" : false
              },
              "sasl.kerberos.service.name" : {
                "displayName" : "Kerberos Service Name",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.service.name",
                "sensitive" : false
              },
              "security.protocol" : {
                "displayName" : "Security Protocol",
                "identifiesControllerService" : false,
                "name" : "security.protocol",
                "sensitive" : false
              },
              "kerberos-credentials-service" : {
                "displayName" : "Kerberos Credentials Service",
                "identifiesControllerService" : true,
                "name" : "kerberos-credentials-service",
                "sensitive" : false
              },
              "ssl.context.service" : {
                "displayName" : "SSL Context Service",
                "identifiesControllerService" : true,
                "name" : "ssl.context.service",
                "sensitive" : false
              },
              "max-uncommit-offset-wait" : {
                "displayName" : "Max Uncommitted Time",
                "identifiesControllerService" : false,
                "name" : "max-uncommit-offset-wait",
                "sensitive" : false
              },
              "sasl.mechanism" : {
                "displayName" : "SASL Mechanism",
                "identifiesControllerService" : false,
                "name" : "sasl.mechanism",
                "sensitive" : false
              },
              "sasl.token.auth" : {
                "displayName" : "Token Auth",
                "identifiesControllerService" : false,
                "name" : "sasl.token.auth",
                "sensitive" : false
              },
              "sasl.kerberos.keytab" : {
                "displayName" : "Kerberos Keytab",
                "identifiesControllerService" : false,
                "name" : "sasl.kerberos.keytab",
                "sensitive" : false
              },
              "honor-transactions" : {
                "displayName" : "Honor Transactions",
                "identifiesControllerService" : false,
                "name" : "honor-transactions",
                "sensitive" : false
              },
              "Communications Timeout" : {
                "displayName" : "Communications Timeout",
                "identifiesControllerService" : false,
                "name" : "Communications Timeout",
                "sensitive" : false
              },
              "topic" : {
                "displayName" : "Topic Name(s)",
                "identifiesControllerService" : false,
                "name" : "topic",
                "sensitive" : false
              },
              "message-header-encoding" : {
                "displayName" : "Message Header Encoding",
                "identifiesControllerService" : false,
                "name" : "message-header-encoding",
                "sensitive" : false
              },
              "sasl.password" : {
                "displayName" : "Password",
                "identifiesControllerService" : false,
                "name" : "sasl.password",
                "sensitive" : true
              },
              "message-demarcator" : {
                "displayName" : "Message Demarcator",
                "identifiesControllerService" : false,
                "name" : "message-demarcator",
                "sensitive" : false
              },
              "key-attribute-encoding" : {
                "displayName" : "Key Attribute Encoding",
                "identifiesControllerService" : false,
                "name" : "key-attribute-encoding",
                "sensitive" : false
              },
              "auto.offset.reset" : {
                "displayName" : "Offset Reset",
                "identifiesControllerService" : false,
                "name" : "auto.offset.reset",
                "sensitive" : false
              }
            },
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.kafka.pubsub.ConsumeKafka_2_6",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "variables" : { }
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-kafka-2-6-nar",
            "group" : "org.apache.nifi",
            "version" : "1.12.1"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "56dd183e-d24d-317a-9075-37d69bb21be4",
          "name" : "Consume From Kafka Topic",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2400.0,
            "y" : 1984.0
          },
          "properties" : {
            "header-name-regex" : ".*",
            "sasl.username" : "#{kafka.auth.user}",
            "max.poll.records" : "10000",
            "group.id" : "#{kafka.consumer.group}",
            "bootstrap.servers" : "#{kafka.brokers}",
            "topic_type" : "pattern",
            "security.protocol" : "PLAINTEXT",
            "max-uncommit-offset-wait" : "1 secs",
            "sasl.mechanism" : "PLAIN",
            "sasl.token.auth" : "false",
            "honor-transactions" : "true",
            "Communications Timeout" : "60 secs",
            "topic" : "#{kafka.topic.in}",
            "message-header-encoding" : "UTF-8",
            "sasl.password" : "#{kafka.auth.password}",
            "key-attribute-encoding" : "utf-8",
            "auto.offset.reset" : "earliest"
          },
          "propertyDescriptors" : {
            "header-name-regex" : {
              "displayName" : "Headers to Add as Attributes (Regex)",
              "identifiesControllerService" : false,
              "name" : "header-name-regex",
              "sensitive" : false
            },
            "sasl.username" : {
              "displayName" : "Username",
              "identifiesControllerService" : false,
              "name" : "sasl.username",
              "sensitive" : false
            },
            "max.poll.records" : {
              "displayName" : "Max Poll Records",
              "identifiesControllerService" : false,
              "name" : "max.poll.records",
              "sensitive" : false
            },
            "group.id" : {
              "displayName" : "Group ID",
              "identifiesControllerService" : false,
              "name" : "group.id",
              "sensitive" : false
            },
            "bootstrap.servers" : {
              "displayName" : "Kafka Brokers",
              "identifiesControllerService" : false,
              "name" : "bootstrap.servers",
              "sensitive" : false
            },
            "topic_type" : {
              "displayName" : "Topic Name Format",
              "identifiesControllerService" : false,
              "name" : "topic_type",
              "sensitive" : false
            },
            "sasl.kerberos.principal" : {
              "displayName" : "Kerberos Principal",
              "identifiesControllerService" : false,
              "name" : "sasl.kerberos.principal",
              "sensitive" : false
            },
            "sasl.kerberos.service.name" : {
              "displayName" : "Kerberos Service Name",
              "identifiesControllerService" : false,
              "name" : "sasl.kerberos.service.name",
              "sensitive" : false
            },
            "security.protocol" : {
              "displayName" : "Security Protocol",
              "identifiesControllerService" : false,
              "name" : "security.protocol",
              "sensitive" : false
            },
            "kerberos-credentials-service" : {
              "displayName" : "Kerberos Credentials Service",
              "identifiesControllerService" : true,
              "name" : "kerberos-credentials-service",
              "sensitive" : false
            },
            "ssl.context.service" : {
              "displayName" : "SSL Context Service",
              "identifiesControllerService" : true,
              "name" : "ssl.context.service",
              "sensitive" : false
            },
            "max-uncommit-offset-wait" : {
              "displayName" : "Max Uncommitted Time",
              "identifiesControllerService" : false,
              "name" : "max-uncommit-offset-wait",
              "sensitive" : false
            },
            "sasl.mechanism" : {
              "displayName" : "SASL Mechanism",
              "identifiesControllerService" : false,
              "name" : "sasl.mechanism",
              "sensitive" : false
            },
            "sasl.token.auth" : {
              "displayName" : "Token Auth",
              "identifiesControllerService" : false,
              "name" : "sasl.token.auth",
              "sensitive" : false
            },
            "sasl.kerberos.keytab" : {
              "displayName" : "Kerberos Keytab",
              "identifiesControllerService" : false,
              "name" : "sasl.kerberos.keytab",
              "sensitive" : false
            },
            "honor-transactions" : {
              "displayName" : "Honor Transactions",
              "identifiesControllerService" : false,
              "name" : "honor-transactions",
              "sensitive" : false
            },
            "Communications Timeout" : {
              "displayName" : "Communications Timeout",
              "identifiesControllerService" : false,
              "name" : "Communications Timeout",
              "sensitive" : false
            },
            "topic" : {
              "displayName" : "Topic Name(s)",
              "identifiesControllerService" : false,
              "name" : "topic",
              "sensitive" : false
            },
            "message-header-encoding" : {
              "displayName" : "Message Header Encoding",
              "identifiesControllerService" : false,
              "name" : "message-header-encoding",
              "sensitive" : false
            },
            "sasl.password" : {
              "displayName" : "Password",
              "identifiesControllerService" : false,
              "name" : "sasl.password",
              "sensitive" : true
            },
            "message-demarcator" : {
              "displayName" : "Message Demarcator",
              "identifiesControllerService" : false,
              "name" : "message-demarcator",
              "sensitive" : false
            },
            "key-attribute-encoding" : {
              "displayName" : "Key Attribute Encoding",
              "identifiesControllerService" : false,
              "name" : "key-attribute-encoding",
              "sensitive" : false
            },
            "auto.offset.reset" : {
              "displayName" : "Offset Reset",
              "identifiesControllerService" : false,
              "name" : "auto.offset.reset",
              "sensitive" : false
            }
          },
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.kafka.pubsub.ConsumeKafka_2_6",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "1.12.1"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "53903135-9fb2-35d0-ba95-1bad50195e04",
          "identifier" : "2df00133-210e-36d5-9dc2-b76cf28b8263",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2400.0,
            "y" : 3624.0
          },
          "properties" : {
            "Abort" : "${resourceSavedStatus:notNull():and(${resourceSavedStatus:equalsIgnoreCase(\"Abort\")})}",
            "Warning" : "${resourceSavedStatus:notNull():and(${resourceSavedStatus:equalsIgnoreCase(\"Warning\")})}",
            "Routing Strategy" : "Route to Property name",
            "Failure" : "${resourceSavedStatus:notNull():and(${resourceSavedStatus:equalsIgnoreCase(\"Failure\")})}",
            "Success" : "${resourceSavedStatus:notNull():and(${resourceSavedStatus:equalsIgnoreCase(\"Success\")})}"
          },
          "propertyDescriptors" : {
            "Abort" : {
              "displayName" : "Abort",
              "identifiesControllerService" : false,
              "name" : "Abort",
              "sensitive" : false
            },
            "Warning" : {
              "displayName" : "Warning",
              "identifiesControllerService" : false,
              "name" : "Warning",
              "sensitive" : false
            },
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "Failure" : {
              "displayName" : "Failure",
              "identifiesControllerService" : false,
              "name" : "Failure",
              "sensitive" : false
            },
            "Success" : {
              "displayName" : "Success",
              "identifiesControllerService" : false,
              "name" : "Success",
              "sensitive" : false
            }
          },
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "variables" : { }
      },
      "flowEncodingVersion" : "1.0",
      "parameterContexts" : {
        "Enrichment Parameter Context" : {
          "name" : "Enrichment Parameter Context",
          "parameters" : [ {
            "description" : "",
            "name" : "ResolveTerminology",
            "sensitive" : false,
            "value" : "True"
          }, {
            "description" : "",
            "name" : "DEID_PREP_URL",
            "sensitive" : false,
            "value" : "http://ingestion-deid-prep:8080"
          }, {
            "description" : "",
            "name" : "kafka.auth.user",
            "sensitive" : false,
            "value" : "token"
          }, {
            "description" : "",
            "name" : "DeidentifyData",
            "sensitive" : false,
            "value" : "True"
          }, {
            "description" : "",
            "name" : "TERM_SERVICES_PREP_URL",
            "sensitive" : false,
            "value" : "http://ingestion-term-services-prep:8080"
          }, {
            "description" : "",
            "name" : "enrich.out",
            "sensitive" : false,
            "value" : "patient.enriched.out"
          }, {
            "description" : "",
            "name" : "kafka.consumer.group",
            "sensitive" : false,
            "value" : "Clinical_Ingestion_Group"
          }, {
            "description" : "",
            "name" : "kafka.brokers",
            "sensitive" : false,
            "value" : "ingestion-kafka:9092"
          }, {
            "description" : "",
            "name" : "enrich.in",
            "sensitive" : false,
            "value" : "patients.updated.out"
          }, {
            "description" : "",
            "name" : "RunASCVD",
            "sensitive" : false,
            "value" : "True"
          }, {
            "description" : "",
            "name" : "kafka.auth.password",
            "sensitive" : true
          }, {
            "description" : "",
            "name" : "DEID_PUSH_TO_FHIR",
            "sensitive" : false,
            "value" : "true"
          }, {
            "description" : "",
            "name" : "DEID_CONFIG_NAME",
            "sensitive" : false,
            "value" : "default"
          } ]
        },
        "cms_adapter_parameters" : {
          "name" : "cms_adapter_parameters",
          "parameters" : [ {
            "description" : "FHIR server user for Patient Access FHIR URL",
            "name" : "FHIR_User_PatientAccess",
            "sensitive" : false,
            "value" : "fhiruser"
          }, {
            "description" : "Filter for notification topic in environment specified",
            "name" : "kafka.topic.notification",
            "sensitive" : false,
            "value" : "ingest.*_dev.notification"
          }, {
            "description" : "FHIR server user for Provider Directory FHIR URL",
            "name" : "FHIR_User_ProviderDirectory",
            "sensitive" : false,
            "value" : "fhiruser"
          }, {
            "description" : "CMSIOP Eventstream user id",
            "name" : "kafka.auth.user",
            "sensitive" : false,
            "value" : "token"
          }, {
            "description" : "Time to wait for batch resources to return from processing before terminating the batch.",
            "name" : "batchProcessingTimeout",
            "sensitive" : false,
            "value" : "20 minutes"
          }, {
            "description" : "Specifies the timeout that will be used when the expected number of records in a batch have yet to appear on the kafka topic.",
            "name" : "expectedRecordsTimeout",
            "sensitive" : false,
            "value" : "5 minutes"
          }, {
            "description" : "Comma-delimited list of brokers for eventstream instance",
            "name" : "kafka.brokers",
            "sensitive" : false,
            "value" : "ingestion-kafka:9092"
          }, {
            "description" : "Must be set to base64 encoding",
            "name" : "hri.oauth.credentials",
            "sensitive" : false,
            "value" : "ODMxOGMzNzYtMDIxMC00ODY3LWI1OGYtZDljMjgzODU5YzRjOk5qbGxOelZqWXpRdE9EWm1OaTAwT1dVNUxUZ3lORE10T1RNM09EbGhOREEzT1RkaQ=="
          }, {
            "description" : "Used for the GetHriIngestRecords processor.  Needs to be unique per environment.",
            "name" : "kafka.ingest.group",
            "sensitive" : false,
            "value" : "Interop_Adapter_Ingest_Group_dev"
          }, {
            "description" : "",
            "name" : "HL7_RESOURCE_GENERATOR_URL",
            "sensitive" : false,
            "value" : "http://ingestion-hl7-resource-generator:8080/hl7/transformation"
          }, {
            "description" : "Unique id used to record ingestion results in this environment.  Used internally in the pipeline.",
            "name" : "applicationIdIngestResponse",
            "sensitive" : false,
            "value" : "Interop_Adapter_Ingest_Response_dev"
          }, {
            "description" : "FHIR api for patient access",
            "name" : "FHIR_URL_PatientAccess",
            "sensitive" : false,
            "value" : "http://ingestion-fhir/fhir-server/api/v4"
          }, {
            "description" : "",
            "name" : "hri.oauth.url",
            "sensitive" : false,
            "value" : "https://us-east.appid.cloud.ibm.com/oauth/v4/1655fea1-6884-46f3-9ea1-399b97e17dc5"
          }, {
            "description" : "FHIR server user credentials for Patient Access FHIR URL",
            "name" : "FHIR_UserPwd_PatientAccess",
            "sensitive" : true
          }, {
            "description" : "FHIR api for provider",
            "name" : "FHIR_URL_ProviderDirectory",
            "sensitive" : false,
            "value" : "http://ingestion-fhir/fhir-server/api/v4"
          }, {
            "description" : "Filter for input topic for the environment specified",
            "name" : "kafka.topic.in",
            "sensitive" : false,
            "value" : "ingest.clinical.in"
          }, {
            "description" : "The maximum number of resources to add to a bundle for when autobundling is enabled.",
            "name" : "maxResourcesInBundle",
            "sensitive" : false,
            "value" : "20"
          }, {
            "description" : "Set to 'True' to send non-bundle FHIR resources as bundles to the FHIR server for improved performance.",
            "name" : "autoBuildBundles",
            "sensitive" : false,
            "value" : "True"
          }, {
            "description" : "Consumer group used by the pipeline adapters in environment specified",
            "name" : "kafka.consumer.group",
            "sensitive" : false,
            "value" : "Clinical_Ingestion_Group"
          }, {
            "description" : "Default setting for the FHIR Prefer header setting to enable warnings to be returned for resources with no errors.\n\nValues are: OperationOutcome or minimal\n\nOperationOutcome - returns warnings for resources without errors.\nminimal - returns errors and warnings for resources with errors.",
            "name" : "defaultFHIRPreferHeaderSetting",
            "sensitive" : false,
            "value" : "OperationOutcome"
          }, {
            "description" : "",
            "name" : "clinical.ingestion.listen.port",
            "sensitive" : false,
            "value" : "7001"
          }, {
            "description" : "Parameter to control orchestration of batches within tenants.  Used internally in the pipeline",
            "name" : "applicationIdCritRegion",
            "sensitive" : false,
            "value" : "Interop_Adapter_FHIR_Adapter_dev"
          }, {
            "description" : "CMSIOP Eventstreams credentials",
            "name" : "kafka.auth.password",
            "sensitive" : true
          }, {
            "description" : "FHIR server user credentials for Provider Directory FHIR URL",
            "name" : "FHIR_UserPwd_ProviderDirectory",
            "sensitive" : true
          }, {
            "description" : "",
            "name" : "hri.mgmtapi.audience",
            "sensitive" : false,
            "value" : "95acb24a-24a7-4483-90e4-ab2dd06cc01c"
          }, {
            "description" : "Endpoint for the HRI instance",
            "name" : "hri.api.endpoint",
            "sensitive" : false,
            "value" : "https://82b74670.us-east.apigw.appdomain.cloud/hri"
          }, {
            "description" : "",
            "name" : "applicationIdIndexBatch",
            "sensitive" : false,
            "value" : "CMS_Interop_Index_Batch_dev"
          }, {
            "description" : "Filter used for error topics",
            "name" : "kafka.topic.failure",
            "sensitive" : false,
            "value" : "ingest.*_dev.error"
          } ]
        }
      }
    }
  }
}